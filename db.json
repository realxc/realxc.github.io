{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/images/pasted-0.png","path":"images/pasted-0.png","modified":1,"renderable":0},{"_id":"source/images/pasted-10.png","path":"images/pasted-10.png","modified":1,"renderable":0},{"_id":"source/images/pasted-11.png","path":"images/pasted-11.png","modified":1,"renderable":0},{"_id":"source/images/pasted-14.png","path":"images/pasted-14.png","modified":1,"renderable":0},{"_id":"source/images/pasted-18.png","path":"images/pasted-18.png","modified":1,"renderable":0},{"_id":"source/images/pasted-19.png","path":"images/pasted-19.png","modified":1,"renderable":0},{"_id":"source/images/pasted-2.png","path":"images/pasted-2.png","modified":1,"renderable":0},{"_id":"source/images/pasted-24.png","path":"images/pasted-24.png","modified":1,"renderable":0},{"_id":"source/images/pasted-25.png","path":"images/pasted-25.png","modified":1,"renderable":0},{"_id":"source/images/pasted-26.png","path":"images/pasted-26.png","modified":1,"renderable":0},{"_id":"source/images/pasted-27.png","path":"images/pasted-27.png","modified":1,"renderable":0},{"_id":"source/images/pasted-28.png","path":"images/pasted-28.png","modified":1,"renderable":0},{"_id":"source/images/pasted-29.png","path":"images/pasted-29.png","modified":1,"renderable":0},{"_id":"source/images/pasted-32.png","path":"images/pasted-32.png","modified":1,"renderable":0},{"_id":"source/images/pasted-33.png","path":"images/pasted-33.png","modified":1,"renderable":0},{"_id":"source/images/pasted-34.png","path":"images/pasted-34.png","modified":1,"renderable":0},{"_id":"source/images/pasted-36.png","path":"images/pasted-36.png","modified":1,"renderable":0},{"_id":"source/images/pasted-37.png","path":"images/pasted-37.png","modified":1,"renderable":0},{"_id":"source/images/pasted-38.png","path":"images/pasted-38.png","modified":1,"renderable":0},{"_id":"source/images/pasted-39.png","path":"images/pasted-39.png","modified":1,"renderable":0},{"_id":"source/images/pasted-40.png","path":"images/pasted-40.png","modified":1,"renderable":0},{"_id":"source/images/pasted-41.png","path":"images/pasted-41.png","modified":1,"renderable":0},{"_id":"source/images/pasted-42.png","path":"images/pasted-42.png","modified":1,"renderable":0},{"_id":"source/images/pasted-43.png","path":"images/pasted-43.png","modified":1,"renderable":0},{"_id":"source/images/pasted-44.png","path":"images/pasted-44.png","modified":1,"renderable":0},{"_id":"source/images/pasted-45.png","path":"images/pasted-45.png","modified":1,"renderable":0},{"_id":"source/images/pasted-47.png","path":"images/pasted-47.png","modified":1,"renderable":0},{"_id":"source/images/pasted-48.png","path":"images/pasted-48.png","modified":1,"renderable":0},{"_id":"source/images/pasted-53.png","path":"images/pasted-53.png","modified":1,"renderable":0},{"_id":"source/images/pasted-54.png","path":"images/pasted-54.png","modified":1,"renderable":0},{"_id":"source/images/pasted-55.png","path":"images/pasted-55.png","modified":1,"renderable":0},{"_id":"source/images/pasted-56.png","path":"images/pasted-56.png","modified":1,"renderable":0},{"_id":"source/images/pasted-7.png","path":"images/pasted-7.png","modified":1,"renderable":0},{"_id":"source/images/pasted-8.png","path":"images/pasted-8.png","modified":1,"renderable":0},{"_id":"source/images/pasted-1.png","path":"images/pasted-1.png","modified":1,"renderable":0},{"_id":"source/images/pasted-15.png","path":"images/pasted-15.png","modified":1,"renderable":0},{"_id":"source/images/pasted-16.png","path":"images/pasted-16.png","modified":1,"renderable":0},{"_id":"source/images/pasted-22.png","path":"images/pasted-22.png","modified":1,"renderable":0},{"_id":"source/images/pasted-3.png","path":"images/pasted-3.png","modified":1,"renderable":0},{"_id":"source/images/pasted-30.png","path":"images/pasted-30.png","modified":1,"renderable":0},{"_id":"source/images/pasted-31.png","path":"images/pasted-31.png","modified":1,"renderable":0},{"_id":"source/images/pasted-35.png","path":"images/pasted-35.png","modified":1,"renderable":0},{"_id":"source/images/pasted-4.png","path":"images/pasted-4.png","modified":1,"renderable":0},{"_id":"source/images/pasted-46.png","path":"images/pasted-46.png","modified":1,"renderable":0},{"_id":"source/images/pasted-49.png","path":"images/pasted-49.png","modified":1,"renderable":0},{"_id":"source/images/pasted-52.png","path":"images/pasted-52.png","modified":1,"renderable":0},{"_id":"source/images/pasted-6.png","path":"images/pasted-6.png","modified":1,"renderable":0},{"_id":"source/images/pasted-12.png","path":"images/pasted-12.png","modified":1,"renderable":0},{"_id":"source/images/pasted-13.png","path":"images/pasted-13.png","modified":1,"renderable":0},{"_id":"source/images/pasted-17.png","path":"images/pasted-17.png","modified":1,"renderable":0},{"_id":"source/images/pasted-9.png","path":"images/pasted-9.png","modified":1,"renderable":0},{"_id":"themes/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/affix.js","path":"js/affix.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/exturl.js","path":"js/exturl.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/js.cookie.js","path":"js/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/post-details.js","path":"js/post-details.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/scroll-cookie.js","path":"js/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/scrollspy.js","path":"js/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"source/images/pasted-5.png","path":"images/pasted-5.png","modified":1,"renderable":0},{"_id":"source/images/pasted-51.png","path":"images/pasted-51.png","modified":1,"renderable":0},{"_id":"source/images/pasted-57.png","path":"images/pasted-57.png","modified":1,"renderable":0},{"_id":"source/images/pasted-59.png","path":"images/pasted-59.png","modified":1,"renderable":0},{"_id":"source/images/pasted-61.png","path":"images/pasted-61.png","modified":1,"renderable":0},{"_id":"themes/hexo-theme-next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"source/images/pasted-50.png","path":"images/pasted-50.png","modified":1,"renderable":0},{"_id":"source/images/pasted-58.png","path":"images/pasted-58.png","modified":1,"renderable":0},{"_id":"source/images/pasted-60.png","path":"images/pasted-60.png","modified":1,"renderable":0},{"_id":"themes/hexo-theme-next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"source/images/pasted-21.png","path":"images/pasted-21.png","modified":1,"renderable":0},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"source/images/pasted-23.png","path":"images/pasted-23.png","modified":1,"renderable":0},{"_id":"source/images/pasted-20.png","path":"images/pasted-20.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/404.html","hash":"e6f6ddf3aea0cef766108965e0461d388820f853","modified":1554878766985},{"_id":"themes/hexo-theme-next/.all-contributorsrc","hash":"43eb0149c78e464c695f0dd758bb8c59353182b3","modified":1554714951676},{"_id":"themes/hexo-theme-next/.bowerrc","hash":"334da94ca6f024d60d012cc26ea655681e724ad8","modified":1554714951685},{"_id":"themes/hexo-theme-next/.editorconfig","hash":"211d2c92bfdddb3e81ea946f4ca7a539f150f4da","modified":1554714951687},{"_id":"themes/hexo-theme-next/.eslintrc.json","hash":"d3c11de434171d55d70daadd3914bc33544b74b8","modified":1554714951689},{"_id":"themes/hexo-theme-next/.gitattributes","hash":"8454b9313cb1a97b63fb87e2d29daee497ce6249","modified":1554714951691},{"_id":"themes/hexo-theme-next/.gitignore","hash":"69e702b833c6aa9646ad24c45dd9cf00ab5ce6b9","modified":1554714951736},{"_id":"themes/hexo-theme-next/.stylintrc","hash":"3b7f9785e9ad0dab764e1c535b40df02f4ff5fd6","modified":1554714951738},{"_id":"themes/hexo-theme-next/.travis.yml","hash":"fb9ac54e875f6ea16d5c83db497f6bd70ae83198","modified":1554714951740},{"_id":"themes/hexo-theme-next/LICENSE.md","hash":"0a9c7399f102b4eb0a6950dd31264be421557c7d","modified":1554714951750},{"_id":"themes/hexo-theme-next/README.md","hash":"3f72e5a5051ca2bdaccdda684c46dc4fdb4413a6","modified":1554714951779},{"_id":"themes/hexo-theme-next/_config.yml","hash":"662667ce917c3c3b845000f54efaf971b35892f7","modified":1554877512069},{"_id":"themes/hexo-theme-next/bower.json","hash":"3c1c82d1644f5690534e71feed8df82e563748e0","modified":1554714951802},{"_id":"themes/hexo-theme-next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1554714951807},{"_id":"themes/hexo-theme-next/gulpfile.coffee","hash":"6407d9063bd88ede299ff7c2a59cf2c82e079476","modified":1554714951893},{"_id":"themes/hexo-theme-next/package.json","hash":"23449a55881f7316766c0fcf3ce4c93adbc6076b","modified":1554714952208},{"_id":"source/_posts/G1-Evacuation-Failure.md","hash":"1d931491834a8681eaeebeb861e7708967321f78","modified":1554877671170},{"_id":"source/_posts/G1-Humongous-Allocation.md","hash":"cb245082c6edbff4aa551e19a0ac7d35f6059b9b","modified":1554877653093},{"_id":"source/_posts/G1垃圾回收器-xx-initiatingheapoccupancypercent变量之问.md","hash":"c91badf32fb65f70935e68ae6af3cd917bb11f63","modified":1554877708023},{"_id":"source/_posts/JVM-类加载.md","hash":"b4927adcac6992a247c2fc606b0bfabb0ad23d18","modified":1554882993132},{"_id":"source/_posts/druid-filter.md","hash":"6b0d6481132c83c0a72fd20a50647e3d48d1c26f","modified":1554880034822},{"_id":"source/_posts/dubbo-反序列化问题.md","hash":"b415d3d7f570acde1b02fbde8e39ba085966b31f","modified":1554881707883},{"_id":"source/_posts/dubbo-基于zookeeper的注册结构.md","hash":"18c802e916c0cd9012d3dcbaccc34d07480b6225","modified":1554882618262},{"_id":"source/_posts/dubbo-（反）序列化.md","hash":"81055647ba94d166e3be5d65b0584108a297f952","modified":1554880128561},{"_id":"source/_posts/elasticsearch-集群.md","hash":"339dfae286a531ac9ce4a7228d6172741b421631","modified":1554882765850},{"_id":"source/_posts/java-对象使用问题案例.md","hash":"d1f4152cbf897cd985300b673480a25d9f2cce11","modified":1554881396740},{"_id":"source/_posts/javaagent-bytebuddy.md","hash":"09bf7b5f1375f2880c402a7cc8d48a8ed1bef313","modified":1554883294007},{"_id":"source/_posts/jdk8-dump异常.md","hash":"9ed28ce948a02ff81805a3d0783d85907c30db00","modified":1554878427923},{"_id":"source/_posts/linux-tail命令不生效.md","hash":"f9957c652ccd62f6982c4078207ae2032e35d669","modified":1554884336458},{"_id":"source/_posts/maven-Failed-to-execute-goal-org-apache-maven-plugins-maven-enforcer-plugin.md","hash":"2d35e3b8be61cc5873e2b4d292dffca7781decaa","modified":1554884336497},{"_id":"source/_posts/maven-No-plugin-found-for-prefix-tomcat7.md","hash":"4c2a20da8aef760e9d435222c51b579b3f763c3a","modified":1554884336384},{"_id":"source/_posts/maven-Plugin-execution-not-covered-by-lifecycle-configuration.md","hash":"e35c49158d22279f17998d40362672cddd41dc3d","modified":1554884336404},{"_id":"source/_posts/maven-默认jdk版本.md","hash":"7827026d45aa1f3e68bcffc4583fd1446a5c4f21","modified":1554884336364},{"_id":"source/_posts/mysql-TIMESTAMP.md","hash":"90714951f99b642e7a8298a8180fd6835931ae17","modified":1554884336340},{"_id":"source/_posts/mongo-查询报no-property-found-on.md","hash":"09976cb4e910628d6bd68c1dd1d747cc98b9937e","modified":1554879596322},{"_id":"source/_posts/rabbitmq-报not-equivalent错.md","hash":"3d5bdece96076b586c41118bbc78e69fa4fba3d7","modified":1554881631156},{"_id":"source/_posts/springboot-spring-boot-starter-actuator.md","hash":"b9e910d86661b0476cbab31fd8705fa7c0ab50f9","modified":1554882279674},{"_id":"source/_posts/struts2-no-action-in-maven.md","hash":"d4a738e0a88577b7e140578a89ea9e0d0f7dc165","modified":1554884336479},{"_id":"source/_posts/zookeeper-反复重连问题.md","hash":"4885a64a3d33827ddb3cf53941a19a8c7f56570a","modified":1554880427514},{"_id":"source/_posts/内存泄漏案例分析.md","hash":"a7329e60d6c1f17a88ffd31d979533f661b4a8c7","modified":1554878799336},{"_id":"source/_posts/应用停机-优雅停机问题.md","hash":"3dddce03050aa48e6185562019a0ac208560345f","modified":1554880697373},{"_id":"source/_posts/数据库-kill服务进程引发的血案.md","hash":"1e4d21d16d30748c62ef2c65a1f05d08defebec0","modified":1554879827166},{"_id":"source/_posts/数据库-重启引发的主键问题.md","hash":"328c01cece8b3f5b21c57222e79275bc5ea69183","modified":1554879924982},{"_id":"source/_posts/浅谈JVM之垃圾回收.md","hash":"97c24e17e572a6fdcb1ab2b0643dd7e309ccb62c","modified":1554819428667},{"_id":"source/_posts/浏览器-资源加载.md","hash":"fcbbad9287afa2a0178e5d37a80ecf314cc721d1","modified":1554884336420},{"_id":"source/_posts/淘宝架构-进化.md","hash":"64562b0edf5938f3675967ff96cc04d9d4b8c938","modified":1554884336439},{"_id":"source/_posts/谈一谈锁.md","hash":"2a3efdcc40f95a1b0702dab94b2002a0196f83d1","modified":1554732678736},{"_id":"source/about/index.md","hash":"c8afd495383970b99566197b729c5ca773c7d16b","modified":1554877413981},{"_id":"source/categories/index.md","hash":"a459d69045449ba9ab3680cd2d1f64fbfbe36eb7","modified":1554876378250},{"_id":"source/schedule/index.md","hash":"b8ee3cfc22a6b456ab1ef31dbbfd60de0ace22a6","modified":1554877455658},{"_id":"source/images/pasted-0.png","hash":"3c5bebef8fcf19a8f2c98a88495866b25e28c288","modified":1554820006296},{"_id":"source/images/pasted-10.png","hash":"7c63f1cc32c191cff49ec5bee0634ffebb4d0f41","modified":1554879158459},{"_id":"source/images/pasted-11.png","hash":"0da5839c58d93b98b577b40374630992516397c9","modified":1554879202804},{"_id":"source/images/pasted-14.png","hash":"7d7fa913eef8c753d25b24cd610297be8e979e79","modified":1554879362321},{"_id":"source/images/pasted-18.png","hash":"895e9a3d62baa7c9da9af873b11cf74377ac99a4","modified":1554880340011},{"_id":"source/images/pasted-19.png","hash":"1f045eed6f9ebad8ee4981bb2ac7e571400fa789","modified":1554880487719},{"_id":"source/images/pasted-2.png","hash":"572b64658cfaa1bf0b752a9408821f4133331a5e","modified":1554878581332},{"_id":"source/images/pasted-24.png","hash":"12d854af02c4101e329dcdecd1a3aba33a030f60","modified":1554880855820},{"_id":"source/images/pasted-25.png","hash":"4b73f1a98581612d407594370e5c5397a5c80d1e","modified":1554880883195},{"_id":"source/images/pasted-26.png","hash":"5b5fe3fba7c5b2691e4aca04216d02dabc66cea5","modified":1554880921592},{"_id":"source/images/pasted-27.png","hash":"76ebe1be5de9bc77ba3bded99b0e421a67554dfc","modified":1554880943089},{"_id":"source/images/pasted-28.png","hash":"a334565cd08774738f05af99cd25449b40afeecd","modified":1554880963158},{"_id":"source/images/pasted-29.png","hash":"a334565cd08774738f05af99cd25449b40afeecd","modified":1554880980848},{"_id":"source/images/pasted-32.png","hash":"5da3568c83cdc7f1665806c152f922bd3a260fb5","modified":1554881082456},{"_id":"source/images/pasted-33.png","hash":"0e1a4784aec0a0d49f2cef37b9ced85eae0f19d1","modified":1554881112665},{"_id":"source/images/pasted-34.png","hash":"b6883d450159369476845b3304599b33d55bc25b","modified":1554881137382},{"_id":"source/images/pasted-36.png","hash":"e1d15b97163e3f49aa6fca964e36bfaec20505d7","modified":1554881181649},{"_id":"source/images/pasted-37.png","hash":"a647f6b5f4af9c97b0345064c2e03bed433fb7e5","modified":1554881204083},{"_id":"source/images/pasted-38.png","hash":"97f34628fd7816d9daa1e799fcc756bbbca82ad9","modified":1554881240613},{"_id":"source/images/pasted-39.png","hash":"8015ae73c4b94397bf2b04bfb833472f89244532","modified":1554881271943},{"_id":"source/images/pasted-40.png","hash":"efc5da95b15c817fd34471f30d13ec7780521514","modified":1554881304660},{"_id":"source/images/pasted-41.png","hash":"8cfaf01339aae2e46dbf5ce7863086caaeb32b3f","modified":1554881325732},{"_id":"source/images/pasted-42.png","hash":"1b63b44b25fe9690c2a4bff85a2b164ddc191e44","modified":1554881361823},{"_id":"source/images/pasted-43.png","hash":"58ede5e6d6feff9b62ae537856c96f87d269aa01","modified":1554881467656},{"_id":"source/images/pasted-44.png","hash":"ac34c1452a07347421b6cbf52c8f768d3084fa75","modified":1554881489648},{"_id":"source/images/pasted-45.png","hash":"540bcd2ecf51702fcf7cfa8aa41eac361e742f2a","modified":1554881508069},{"_id":"source/images/pasted-47.png","hash":"39f267579a50d5fefc1a29ed0383718433ad685a","modified":1554881568307},{"_id":"source/images/pasted-48.png","hash":"0afe35569b77ebb8ad4c198203c3dc6937942ad4","modified":1554881585821},{"_id":"source/images/pasted-53.png","hash":"9af4c8c80a9f1316559b9f7e20879443daaf564f","modified":1554882965706},{"_id":"source/images/pasted-54.png","hash":"3e3fece4e90e123648dafc121d8222d70fead0bf","modified":1554883155220},{"_id":"source/images/pasted-55.png","hash":"fdde17b659e2a2a594638d9b9612ac39d5251f10","modified":1554883689122},{"_id":"source/images/pasted-56.png","hash":"1deba22e9e40e5868dc4477130cd8092968209fb","modified":1554883789965},{"_id":"source/images/pasted-7.png","hash":"18d586673d7d12e0b4cb6b0ec7679b995b8d57ae","modified":1554879047508},{"_id":"source/images/pasted-8.png","hash":"553fb1dd618d381332e5e33b0ddcdb9e65e3e8c8","modified":1554879094772},{"_id":"source/tags/index.md","hash":"495f8f399569d1316511028c892c45e991bb4cd4","modified":1554876360031},{"_id":"themes/hexo-theme-next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1554714951563},{"_id":"themes/hexo-theme-next/.git/config","hash":"7f8b507977a695e25b27d4c2e8aaed71410536bf","modified":1554714951586},{"_id":"themes/hexo-theme-next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1554714940854},{"_id":"themes/hexo-theme-next/.git/index","hash":"6a7387a093a249b2ed3f09f83a37a8cc79ed29a7","modified":1554731067835},{"_id":"themes/hexo-theme-next/.git/packed-refs","hash":"b6cc61d0c19ec779e2ba62f3a8f64fdc1130e67f","modified":1554714951540},{"_id":"themes/hexo-theme-next/.github/CODE_OF_CONDUCT.md","hash":"f7ddb7faed8031a9f40eae4ee7bb48c1bc50fd14","modified":1554714951694},{"_id":"themes/hexo-theme-next/.github/CONTRIBUTING.md","hash":"78756d8a45b22bdaa51f12b06907bff44afee83e","modified":1554714951696},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE.md","hash":"1e212fe229bd659726b4a3bcf4b5b14e0310ba3a","modified":1554714951699},{"_id":"themes/hexo-theme-next/.github/PULL_REQUEST_TEMPLATE.md","hash":"66e529edef048f3fab87d9670fa8999f483292bf","modified":1554714951715},{"_id":"themes/hexo-theme-next/.github/auto_assign.yml","hash":"9fe0dbe3f6edc59bf10ea25b14eba0e92e2c8f42","modified":1554714951717},{"_id":"themes/hexo-theme-next/.github/config.yml","hash":"cbd06d0c40afa9fdf056765120e9085826b00d20","modified":1554714951719},{"_id":"themes/hexo-theme-next/.github/eslint-disable-bot.yml","hash":"e06053d417579ed967a94166deb6bda5ce41d805","modified":1554714951720},{"_id":"themes/hexo-theme-next/.github/lock.yml","hash":"4f1070097b614b24050f238694127e3573ce8472","modified":1554714951722},{"_id":"themes/hexo-theme-next/.github/mergeable.yml","hash":"1105a6eb0d4ee1b1bf1554c5c51a47160abed62a","modified":1554714951724},{"_id":"themes/hexo-theme-next/.github/release-drafter.yml","hash":"0f826b5ea4646008e2e147dca8b4842ecf96d093","modified":1554714951726},{"_id":"themes/hexo-theme-next/.github/stale.yml","hash":"85975c43d606c39b91c0ad32197154be9d482a09","modified":1554714951728},{"_id":"themes/hexo-theme-next/.github/support.yml","hash":"7ce2722d6904c31a086444c422dc49b6aa310651","modified":1554714951730},{"_id":"themes/hexo-theme-next/.github/topissuebot.yml","hash":"5091c3bc6f3df303d16d853ce65a302601c1e875","modified":1554714951732},{"_id":"themes/hexo-theme-next/.github/weekly-digest.yml","hash":"6db3bcad65c3156de298f6a3ffd3ba887af4aa4f","modified":1554714951734},{"_id":"themes/hexo-theme-next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1554714951823},{"_id":"themes/hexo-theme-next/docs/ALGOLIA-SEARCH.md","hash":"1e49c08b446678336b2eacc8bf581faca969f34b","modified":1554714951825},{"_id":"themes/hexo-theme-next/docs/AUTHORS.md","hash":"51a0a13da55ff3d596970b2f9ab4531c6b2211f2","modified":1554714951828},{"_id":"themes/hexo-theme-next/docs/DATA-FILES.md","hash":"9a1895c0a0db705c4c48f512e86917f9af1ec3fb","modified":1554714951830},{"_id":"themes/hexo-theme-next/docs/INSTALLATION.md","hash":"b74ef6fedf76cdb156e2265759ee0a789ddd49cc","modified":1554714951834},{"_id":"themes/hexo-theme-next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"721a1aa9feed1b580ab99af8e69ed22699121e88","modified":1554714951837},{"_id":"themes/hexo-theme-next/docs/LICENSE.txt","hash":"ae5ad07e4f4106bad55535dba042221539e6c7f9","modified":1554714951840},{"_id":"themes/hexo-theme-next/docs/MATH.md","hash":"0540cd9c961b07931af9f38a83bc9a0f90cd5291","modified":1554714951843},{"_id":"themes/hexo-theme-next/docs/UPDATE-FROM-5.1.X.md","hash":"c9f2ed8e15c137b1885d9ca8b7197d9f457971e9","modified":1554714951846},{"_id":"themes/hexo-theme-next/languages/de.yml","hash":"79b3221344da335743b5ef5a82efa9338d64feb0","modified":1554714951896},{"_id":"themes/hexo-theme-next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1554714951902},{"_id":"themes/hexo-theme-next/languages/en.yml","hash":"d66b8b48840443a4f9c72c7696a21e292f685a47","modified":1554714951912},{"_id":"themes/hexo-theme-next/languages/es.yml","hash":"db1a9f2af477212544c830c2dd986400e26ddd6a","modified":1554714951914},{"_id":"themes/hexo-theme-next/languages/fr.yml","hash":"2429c90dad5bb865e3a969be2b373f19b3a77b3b","modified":1554714951919},{"_id":"themes/hexo-theme-next/languages/id.yml","hash":"f3302a4dfdc9be38a52d6e081411574b1ea01671","modified":1554714951932},{"_id":"themes/hexo-theme-next/languages/it.yml","hash":"31eb878b53d60ff47e3e534cdd7a839c8801ac6e","modified":1554714951934},{"_id":"themes/hexo-theme-next/languages/ja.yml","hash":"3f25eca504ee5a519987b4402731f1bb7f5191c9","modified":1554714951936},{"_id":"themes/hexo-theme-next/languages/ko.yml","hash":"75f2fe142f76bf623e34ed3570598226f55f2b8b","modified":1554714951938},{"_id":"themes/hexo-theme-next/languages/nl.yml","hash":"08f16ce395dacc88847fc30dc6b985ce22fb8948","modified":1554714951940},{"_id":"themes/hexo-theme-next/languages/pt-BR.yml","hash":"c7de8b77f44e75be4f04423088a1c891537aa601","modified":1554714951942},{"_id":"themes/hexo-theme-next/languages/pt.yml","hash":"ca5072c967e5eb1178ffed91827459eda6e4e6e2","modified":1554714951944},{"_id":"themes/hexo-theme-next/languages/ru.yml","hash":"720b92a9ec075b68737d296b1f29ad8e01151c85","modified":1554714951946},{"_id":"themes/hexo-theme-next/languages/tr.yml","hash":"6d2f53d3687a7a46c67c78ab47908accd8812add","modified":1554714951948},{"_id":"themes/hexo-theme-next/languages/uk.yml","hash":"6320439c6e9ff81e5b8f8129ca16e9a744b37032","modified":1554714951950},{"_id":"themes/hexo-theme-next/languages/vi.yml","hash":"e2f0dd7f020a36aa6b73ed4d00dcc4259a7e5e9d","modified":1554714951952},{"_id":"themes/hexo-theme-next/languages/zh-HK.yml","hash":"c22113c4a6c748c18093dae56da5a9e8c5b963cd","modified":1554714951956},{"_id":"themes/hexo-theme-next/languages/zh-CN.yml","hash":"069f15da910d6f9756be448167c07ea5aa5dc346","modified":1554714951954},{"_id":"themes/hexo-theme-next/languages/zh-TW.yml","hash":"dbf4dd87716babb2db4f5332fae9ec190a6f636a","modified":1554714951963},{"_id":"themes/hexo-theme-next/layout/_layout.swig","hash":"ba786b1baba49021928e2e508da53f2fd1369b3f","modified":1554714951974},{"_id":"themes/hexo-theme-next/layout/archive.swig","hash":"61bc56e77e653684fc834f63dcbdadf18687c748","modified":1554714952198},{"_id":"themes/hexo-theme-next/layout/category.swig","hash":"ad0ac6a1ff341f8eab9570e7fb443962948c5f9d","modified":1554714952199},{"_id":"themes/hexo-theme-next/layout/index.swig","hash":"bdcc9f57adef49706b16b107791cacecbc23c1dc","modified":1554714952201},{"_id":"themes/hexo-theme-next/layout/page.swig","hash":"5d06ee8f477ffc39932d0251aa792ffcaf8faf14","modified":1554714952203},{"_id":"themes/hexo-theme-next/layout/post.swig","hash":"af74e97d57cf00cde6f8dbd4364f27910915454e","modified":1554714952204},{"_id":"themes/hexo-theme-next/layout/schedule.swig","hash":"e79f43df0e9a6cf48bbf00882de48c5a58080247","modified":1554714952206},{"_id":"themes/hexo-theme-next/layout/tag.swig","hash":"283519d4d5b67814412863a3e0212bac18bcc5a0","modified":1554714952207},{"_id":"themes/hexo-theme-next/scripts/merge-configs.js","hash":"5f96f63e86825fd7028c2522e4111103e261a758","modified":1554714952221},{"_id":"themes/hexo-theme-next/scripts/merge.js","hash":"39b84b937b2a9608b94e5872349a47200e1800ff","modified":1554714952225},{"_id":"themes/hexo-theme-next/test/.jshintrc","hash":"c9fca43ae0d99718e45a6f5ce736a18ba5fc8fb6","modified":1554714952665},{"_id":"themes/hexo-theme-next/test/helpers.js","hash":"f25e7f3265eb5a6e1ccbb5e5012fa9bebf134105","modified":1554714952667},{"_id":"themes/hexo-theme-next/test/intern.js","hash":"db90b1063356727d72be0d77054fdc32fa882a66","modified":1554714952668},{"_id":"source/images/pasted-1.png","hash":"2fa5474ed957c6db8a1706c0dd6f7ebe246fe8ce","modified":1554878317110},{"_id":"source/images/pasted-15.png","hash":"982268d3cc54f70beae137f40c0e829ecc79e267","modified":1554879381269},{"_id":"source/images/pasted-16.png","hash":"4bd7bdf4bb0e335166ca6b73d2519ecde5186c13","modified":1554879734843},{"_id":"source/images/pasted-22.png","hash":"c559fed4f04798d54344a2be9eb426aed2d090cd","modified":1554880591912},{"_id":"source/images/pasted-3.png","hash":"542656a87c61559ba6b9de7d898959ce5b66bf26","modified":1554878622716},{"_id":"source/images/pasted-30.png","hash":"c14c8dc37a7346d34faeec058c2433e2fe6b230d","modified":1554881026628},{"_id":"source/images/pasted-31.png","hash":"34d16af5e5c08ed5d21e4dba6a9f824a38ffdf95","modified":1554881052908},{"_id":"source/images/pasted-35.png","hash":"5cdd93179bbd33c52c5e882e1794c22c2b1ac83e","modified":1554881157383},{"_id":"source/images/pasted-4.png","hash":"f08def5db40d8ced9cdf23d5d0261ecbb0d245c5","modified":1554878659861},{"_id":"source/images/pasted-46.png","hash":"0750ae34c5cd71f65471af8135d2ab204fa189cc","modified":1554881528694},{"_id":"source/images/pasted-49.png","hash":"5fe72327894be154937213278bb11b1518b55a09","modified":1554882583602},{"_id":"source/images/pasted-52.png","hash":"51a45ad8a44ebfab8ca80997109a0fb5b48636b2","modified":1554882927461},{"_id":"source/images/pasted-6.png","hash":"aa86792c3bd66a7ebd57dcf17ab6bdae6fb225f1","modified":1554879022331},{"_id":"themes/hexo-theme-next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952522},{"_id":"source/images/pasted-12.png","hash":"2b99b4381ba748311a8dd92588cf491a4059b9bc","modified":1554879254641},{"_id":"source/images/pasted-13.png","hash":"2b99b4381ba748311a8dd92588cf491a4059b9bc","modified":1554879274159},{"_id":"source/images/pasted-17.png","hash":"bbcd99aad0b7a56282018978f9557c8aa1c7cfc6","modified":1554880227844},{"_id":"source/images/pasted-9.png","hash":"92fb7b9ed14256063d814aeb1c64417999d12529","modified":1554879132134},{"_id":"themes/hexo-theme-next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1554714940858},{"_id":"themes/hexo-theme-next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1554714940857},{"_id":"themes/hexo-theme-next/.git/hooks/fsmonitor-watchman.sample","hash":"a04bcd7925e722826245dd3085ddbc739ccf12ac","modified":1554714940860},{"_id":"themes/hexo-theme-next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1554714940862},{"_id":"themes/hexo-theme-next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1554714940863},{"_id":"themes/hexo-theme-next/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1554714940865},{"_id":"themes/hexo-theme-next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1554714940867},{"_id":"themes/hexo-theme-next/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1554714940869},{"_id":"themes/hexo-theme-next/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1554714940871},{"_id":"themes/hexo-theme-next/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1554714940873},{"_id":"themes/hexo-theme-next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1554714940875},{"_id":"themes/hexo-theme-next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1554714940878},{"_id":"themes/hexo-theme-next/.git/logs/HEAD","hash":"611b9d1174c0a9ebb1e2c85b6b8c0cb64d1251e0","modified":1554714951570},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"795b8ddb251da8e2327299d5f7dbf446fb9867c6","modified":1554714951702},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE/custom-issue-template.md","hash":"245917ffaa296bc2d9a85444acf639077ca25944","modified":1554714951704},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"59b2b45e151972bbe08582cde22f398e58832765","modified":1554714951710},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE/non-english.md","hash":"ae22e700b7c63c60746321719a20d34022ad78d9","modified":1554714951712},{"_id":"themes/hexo-theme-next/docs/ru/DATA-FILES.md","hash":"a51de08657f5946f4028b11373280ddc04639525","modified":1554714951852},{"_id":"themes/hexo-theme-next/docs/ru/INSTALLATION.md","hash":"7b2963daac19b0c14f98ebef375d5fbce8fc3f44","modified":1554714951857},{"_id":"themes/hexo-theme-next/docs/ru/README.md","hash":"aeb95129ab1da9ec41786bfa86dc32c739ee6358","modified":1554714951870},{"_id":"themes/hexo-theme-next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"1a4e41adcf5831057f3f7b3025ed4a5ef7c442b4","modified":1554714951872},{"_id":"themes/hexo-theme-next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"aaf25d304793344e2d026062768c93005723f5c6","modified":1554714951875},{"_id":"themes/hexo-theme-next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"018a259694f4a8c7c384e1f323531442cba5fbf3","modified":1554714951877},{"_id":"themes/hexo-theme-next/docs/zh-CN/CONTRIBUTING.md","hash":"508caa37443407860d03f4d8bd56b007585125ef","modified":1554714951879},{"_id":"themes/hexo-theme-next/docs/zh-CN/DATA-FILES.md","hash":"67f4a987e7db0ab1ce1ea4c311f2961df07b6681","modified":1554714951882},{"_id":"themes/hexo-theme-next/docs/zh-CN/INSTALLATION.md","hash":"baca12cc24be082f1db28c7f283493569666321c","modified":1554714951884},{"_id":"themes/hexo-theme-next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"b17fc344ff61603f83387c0f9b2b2189aae81d50","modified":1554714951886},{"_id":"themes/hexo-theme-next/docs/zh-CN/MATH.md","hash":"734b371a0dd910eb9fe087f50c95ce35340bb832","modified":1554714951887},{"_id":"themes/hexo-theme-next/docs/zh-CN/README.md","hash":"058c4c6f17c144d88d64c0b12cbd4f1c9fc61522","modified":1554714951889},{"_id":"themes/hexo-theme-next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"2095d1214a4e519a1d31b67b41c89080fa3285d3","modified":1554714951891},{"_id":"themes/hexo-theme-next/layout/_custom/head.swig","hash":"a223919d2e1bf17ca4d6abb2c86f2efca9883dc1","modified":1554714951969},{"_id":"themes/hexo-theme-next/layout/_custom/header.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1554714951971},{"_id":"themes/hexo-theme-next/layout/_custom/sidebar.swig","hash":"ba8ab5a0280b953aa97435ff8946cbcbb2755a27","modified":1554714951972},{"_id":"themes/hexo-theme-next/layout/_macro/post-collapse.swig","hash":"891ab67815969dd8736cb22fbbb3f791b8fff4e4","modified":1554714951983},{"_id":"themes/hexo-theme-next/layout/_macro/post.swig","hash":"31ba947998f0c962b04ae7f42f9d3db934209a79","modified":1554714951985},{"_id":"themes/hexo-theme-next/layout/_macro/sidebar.swig","hash":"91017f58f83d9505ce99109fffdc51c032bf017e","modified":1554714951987},{"_id":"themes/hexo-theme-next/layout/_partials/comments.swig","hash":"d0b9e841d55c974d02f43823a06a2627f8e46431","modified":1554714951990},{"_id":"themes/hexo-theme-next/layout/_partials/footer.swig","hash":"6d56acdcdc12ebca9c1d90f8a2b52ad17aafca6e","modified":1554714951993},{"_id":"themes/hexo-theme-next/layout/_partials/github-banner.swig","hash":"1ad13269b43b900356f3bdab7947d6a86f035a2c","modified":1554714951995},{"_id":"themes/hexo-theme-next/layout/_partials/pagination.swig","hash":"914155d5d758306cff405beefd4a07973fd8fc77","modified":1554714952027},{"_id":"themes/hexo-theme-next/layout/_partials/post-edit.swig","hash":"dee345054d564dd56f74bb143942d3edd1cb8150","modified":1554714952029},{"_id":"themes/hexo-theme-next/layout/_scripts/commons.swig","hash":"cccd93d30787675010b1a74ef02eb5b813ec1d96","modified":1554714952064},{"_id":"themes/hexo-theme-next/layout/_scripts/exturl.swig","hash":"c2e8f4b3a2bf991320ecc827dcdc227399ad5b51","modified":1554714952066},{"_id":"themes/hexo-theme-next/layout/_scripts/next-boot.swig","hash":"50c3ae6b50f173ae70f8c3312f7c6da1097eb9b6","modified":1554714952068},{"_id":"themes/hexo-theme-next/layout/_scripts/noscript.swig","hash":"efb3404a3303622f3be60944d9d1926972c5c248","modified":1554714952070},{"_id":"themes/hexo-theme-next/layout/_scripts/scroll-cookie.swig","hash":"8a992b7fe42b9c1a5eb9d937b0827aed91586d94","modified":1554714952097},{"_id":"themes/hexo-theme-next/layout/_scripts/vendors.swig","hash":"4130f995f0c4f81a44266194ecae9df96fad174c","modified":1554714952099},{"_id":"themes/hexo-theme-next/layout/_third-party/baidu-push.swig","hash":"87bcb495f7ddd81cc3fe2c2a886e51c08053019b","modified":1554714952134},{"_id":"themes/hexo-theme-next/layout/_third-party/bookmark.swig","hash":"4b93dc7ac0573c402aabcb5c933bbcb893b07c51","modified":1554714952136},{"_id":"themes/hexo-theme-next/layout/_third-party/chatra.swig","hash":"87182367d7954457cb2498bbfa9445c03c2d619e","modified":1554714952138},{"_id":"themes/hexo-theme-next/layout/_third-party/copy-code.swig","hash":"07fc0ae1a30c5aa9269d6efdaec598164b1d191c","modified":1554714952161},{"_id":"themes/hexo-theme-next/layout/_third-party/mermaid.swig","hash":"80dfc0879866e6512cb67590a3b2d8741a66f980","modified":1554714952168},{"_id":"themes/hexo-theme-next/layout/_third-party/needsharebutton.swig","hash":"7db4ad4a8dd5420dad2f6890f5299945df0af970","modified":1554714952170},{"_id":"themes/hexo-theme-next/layout/_third-party/pangu.swig","hash":"76f5933925670044ec65b454295ba7e0a8439986","modified":1554714952171},{"_id":"themes/hexo-theme-next/layout/_third-party/pdf.swig","hash":"4ae61c7efb16e962385bfe522a38c4d29cdcccbe","modified":1554714952176},{"_id":"themes/hexo-theme-next/layout/_third-party/quicklink.swig","hash":"7cc1294a5fbedf3502688248a433c358339e5ae0","modified":1554714952183},{"_id":"themes/hexo-theme-next/layout/_third-party/rating.swig","hash":"c476dc3693a9dd0be2d136a45b0d7fdef55d4d92","modified":1554714952187},{"_id":"themes/hexo-theme-next/layout/_third-party/schedule.swig","hash":"882cd0b68c493af1b6d945660f9c21085e006ffc","modified":1554714952189},{"_id":"themes/hexo-theme-next/layout/_third-party/tidio.swig","hash":"b44010cd577e4d063c3406772938c4b117ec7b7b","modified":1554714952196},{"_id":"themes/hexo-theme-next/scripts/filters/exturl.js","hash":"b19c7c1021e57367b3b3bbf5678381017ed5667d","modified":1554714952212},{"_id":"themes/hexo-theme-next/scripts/helpers/engine.js","hash":"cdb6152582313268d970ffeef99b4a8a7850f034","modified":1554714952215},{"_id":"themes/hexo-theme-next/scripts/helpers/next-url.js","hash":"a40ce6bc852bb4bff8b9f984fa064741dd151e96","modified":1554714952216},{"_id":"themes/hexo-theme-next/scripts/tags/button.js","hash":"95a520f6529424a03c7ead6dbfd5e626d672febb","modified":1554714952228},{"_id":"themes/hexo-theme-next/scripts/tags/center-quote.js","hash":"4519ab8e6898f2ee90d05cde060375462b937a7d","modified":1554714952235},{"_id":"themes/hexo-theme-next/scripts/tags/exturl.js","hash":"f9f25905adecfb8be49def4ff3b0b8bbc6955d84","modified":1554714952239},{"_id":"themes/hexo-theme-next/scripts/tags/full-image.js","hash":"a6b2264215c555c553b2c5db85fa90678798d0d5","modified":1554714952241},{"_id":"themes/hexo-theme-next/scripts/tags/group-pictures.js","hash":"23d839333422375e85d44e476f554faf49973a3c","modified":1554714952243},{"_id":"themes/hexo-theme-next/scripts/tags/include-raw.js","hash":"ab4a82a7246265717556c7a42f897430340b88cf","modified":1554714952244},{"_id":"themes/hexo-theme-next/scripts/tags/label.js","hash":"fc83f4e1be2c34e81cb79938f4f99973eba1ea60","modified":1554714952246},{"_id":"themes/hexo-theme-next/scripts/tags/mermaid.js","hash":"81134494ff0134c0dae1b3815caf6606fccd4e46","modified":1554714952247},{"_id":"themes/hexo-theme-next/scripts/tags/note.js","hash":"1fdf4f95810fdb983bfd5ad4c4f13fedd4ea2f8d","modified":1554714952248},{"_id":"themes/hexo-theme-next/scripts/tags/pdf.js","hash":"ab995f0fc60d60f637220e2651111b775b8a06de","modified":1554714952250},{"_id":"themes/hexo-theme-next/scripts/tags/tabs.js","hash":"72a5adbd8f300bee1d0c289367598ca06b2bed17","modified":1554714952251},{"_id":"themes/hexo-theme-next/scripts/tags/video.js","hash":"944293fec96e568d9b09bc1280d5dbc9ee1bbd17","modified":1554714952253},{"_id":"themes/hexo-theme-next/source/css/main.styl","hash":"5e7d28bc539e84f8b03e68df82292f7fc0f2d023","modified":1554714952520},{"_id":"themes/hexo-theme-next/source/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1554714952525},{"_id":"themes/hexo-theme-next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1554714952526},{"_id":"themes/hexo-theme-next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1554714952528},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1554714952530},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1554714952531},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1554714952533},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1554714952534},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1554714952536},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1554714952537},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1554714952540},{"_id":"themes/hexo-theme-next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1554714952541},{"_id":"themes/hexo-theme-next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1554714952542},{"_id":"themes/hexo-theme-next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1554714952544},{"_id":"themes/hexo-theme-next/source/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1554714952545},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1554714952547},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1554714952548},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1554714952564},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","hash":"025d64ba0160a3a2257dd2b3032b5f7c9dd9b82b","modified":1554714952566},{"_id":"themes/hexo-theme-next/source/js/affix.js","hash":"ad343aa406fd8181b5f310434817ce98fc2219e3","modified":1554714952568},{"_id":"themes/hexo-theme-next/source/js/algolia-search.js","hash":"84906eeae57bd06744dd20160b93eacf658f97e2","modified":1554714952570},{"_id":"themes/hexo-theme-next/source/js/exturl.js","hash":"c48aa4b3c0e578a807fd3661e6cd4f3890777437","modified":1554714952571},{"_id":"themes/hexo-theme-next/source/js/js.cookie.js","hash":"f11e84def0352b7dd6393f1b83e55a40ab468686","modified":1554714952573},{"_id":"themes/hexo-theme-next/source/js/motion.js","hash":"d0a6d9dbcc57159e54bbb1f683b86632ae0b78f0","modified":1554714952574},{"_id":"themes/hexo-theme-next/source/js/next-boot.js","hash":"696a0c2cf158001576d56b48195ec8e39e835b47","modified":1554714952576},{"_id":"themes/hexo-theme-next/source/js/post-details.js","hash":"7d309b771e86c7e22ce11cc25625481ef7d5985c","modified":1554714952577},{"_id":"themes/hexo-theme-next/source/js/scroll-cookie.js","hash":"c4867626afab749404daf321367f9b6b8e223f69","modified":1554714952583},{"_id":"themes/hexo-theme-next/source/js/scrollspy.js","hash":"68d3690152c89e7adb08bb35ec28dbda2bd93686","modified":1554714952585},{"_id":"themes/hexo-theme-next/source/js/utils.js","hash":"d58033a6a108981c81ac58ee321167047d7a25df","modified":1554714952587},{"_id":"themes/hexo-theme-next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952441},{"_id":"themes/hexo-theme-next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952443},{"_id":"themes/hexo-theme-next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952447},{"_id":"themes/hexo-theme-next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952503},{"_id":"themes/hexo-theme-next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1554714952512},{"_id":"source/images/pasted-5.png","hash":"f3b4cea1946a8308ebd0a158fba6badd50b8e061","modified":1554878692905},{"_id":"source/images/pasted-51.png","hash":"3cfc16acb4552defa33fc0d75fcfc7d6ad8bf991","modified":1554882894035},{"_id":"source/images/pasted-57.png","hash":"4579bebdf9fff7ce70063012a5042d45d657e0c3","modified":1554884092605},{"_id":"source/images/pasted-59.png","hash":"0362818f13459539382e17dbeb4c89a5436aa2c1","modified":1554884169552},{"_id":"source/images/pasted-61.png","hash":"d0c99730ed8a3d141fcb016e5dea7509584497a7","modified":1554884252713},{"_id":"themes/hexo-theme-next/.git/refs/heads/master","hash":"8e7677dd50b443e05420e2f6822605fedafd4cea","modified":1554714951569},{"_id":"themes/hexo-theme-next/layout/_macro/menu/menu-badge.swig","hash":"4eb8e222dc337211efb0d3bbdb5e29af3e6ecdb8","modified":1554714951979},{"_id":"themes/hexo-theme-next/layout/_macro/menu/menu-item.swig","hash":"25aea3d764b952f3f6d28ab86d7212d138e892df","modified":1554714951981},{"_id":"themes/hexo-theme-next/layout/_partials/head/external-fonts.swig","hash":"b57bf9c865bed0f22157176a8085de168a1aef77","modified":1554714951999},{"_id":"themes/hexo-theme-next/layout/_partials/head/head-unique.swig","hash":"fd079a414ca0f42f4cddd00247a9d5a5f58c4d8e","modified":1554714952002},{"_id":"themes/hexo-theme-next/layout/_partials/head/head.swig","hash":"466e69a4b4fbdc57f33e60a16b0d87e494385e21","modified":1554714952003},{"_id":"themes/hexo-theme-next/layout/_partials/header/brand.swig","hash":"03f669356bbaa70144b743f3312178e1981ac3a8","modified":1554714952007},{"_id":"themes/hexo-theme-next/layout/_partials/header/index.swig","hash":"c909f6e96373c151dea325bcddfdd8c9522421b6","modified":1554714952009},{"_id":"themes/hexo-theme-next/layout/_partials/header/menu.swig","hash":"39c4ad0e36b7c1260da98ba345f7bd72a2ac0f2e","modified":1554714952011},{"_id":"themes/hexo-theme-next/layout/_partials/header/sub-menu.swig","hash":"e015c7d9b84062b60b15b36be3ef11929dd10943","modified":1554714952020},{"_id":"themes/hexo-theme-next/layout/_partials/page/breadcrumb.swig","hash":"2b905ddd5dea8558c3fd95aacad241da6b6800f4","modified":1554714952023},{"_id":"themes/hexo-theme-next/layout/_partials/page/page-header.swig","hash":"f46699a9daa5fef599733cbab35cb75cf7a05444","modified":1554714952025},{"_id":"themes/hexo-theme-next/layout/_partials/post/post-copyright.swig","hash":"be6683db6a269d83bb0441d7cf74db63a240fa8a","modified":1554714952032},{"_id":"themes/hexo-theme-next/layout/_partials/post/post-related.swig","hash":"f331ad02beea8990066d32ad6ec9f859672c3615","modified":1554714952034},{"_id":"themes/hexo-theme-next/layout/_partials/post/reward.swig","hash":"f62b801c7999da67b4bdca9c5e373b9b5ed039dc","modified":1554714952036},{"_id":"themes/hexo-theme-next/layout/_partials/post/wechat-subscriber.swig","hash":"fb7727e8ec63a58238a7206bf70eb273c8879993","modified":1554714952045},{"_id":"themes/hexo-theme-next/layout/_partials/search/algolia-search.swig","hash":"2530de0f3125a912756f6c0e9090cd012134a4c5","modified":1554714952048},{"_id":"themes/hexo-theme-next/layout/_partials/search/index.swig","hash":"f14e9e8c27af82f1bfe794e252dec0d7e521f503","modified":1554714952049},{"_id":"themes/hexo-theme-next/layout/_partials/search/localsearch.swig","hash":"b2f0d247b213e4cf8de47af6a304d98070cc7256","modified":1554714952051},{"_id":"themes/hexo-theme-next/layout/_partials/search/swiftype.swig","hash":"31245e09ce0465b994cebd94223a531585c4eab4","modified":1554714952053},{"_id":"themes/hexo-theme-next/layout/_partials/share/add-this.swig","hash":"c609097b95eb6127c2784f47f2230e6e6efc0be2","modified":1554714952057},{"_id":"themes/hexo-theme-next/layout/_partials/share/baidushare.swig","hash":"54b43d406cf37932e7b60f46814e864d31b1842c","modified":1554714952059},{"_id":"themes/hexo-theme-next/layout/_partials/share/likely.swig","hash":"647e8677d1ccfb3f7918dd3ea2ff7078504a845d","modified":1554714952061},{"_id":"themes/hexo-theme-next/layout/_scripts/pages/post-details.swig","hash":"cf87ab778618a32119ec1c4ac2079a51385b1913","modified":1554714952073},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/gemini.swig","hash":"a62c93f19429f159bcf0c2e533ffc619aa399755","modified":1554714952084},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/mist.swig","hash":"3c548934b97cc426544947f7a2ae35c270b5e33f","modified":1554714952086},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/muse.swig","hash":"7ef07edd2a97a3774229990d2f0a6eefa31bd015","modified":1554714952093},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/pisces.swig","hash":"828eb9c47f34090c841a2e9a0b3f31b0e4ccf40a","modified":1554714952095},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"66d562b3778dbc839f7c00103bd0099c5d61602a","modified":1554714952104},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/application-insights.swig","hash":"83dd7df11b100bae38c9faab9a478f92149a0315","modified":1554714952106},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/baidu-analytics.swig","hash":"73576c9683d9ad9b124916dc6c660607fe7cc1fa","modified":1554714952108},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"2e1de38f44af00209129d4051b7ae307cb11ad68","modified":1554714952110},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"335005a9f8b36349f0ad0a7beeba6969c55fc7f7","modified":1554714952112},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/facebook-sdk.swig","hash":"53202062267391353d49f269e7eb74eb87d30921","modified":1554714952114},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/firestore.swig","hash":"8ab040fccba41675bc835973515530af8a51f8bd","modified":1554714952116},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/google-analytics.swig","hash":"54d7993ae773573ee103c22802b7e98b193e1a3a","modified":1554714952118},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/growingio.swig","hash":"623e73bedef067ac24a398ef27c8197295da872d","modified":1554714952119},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/index.swig","hash":"39928f358dd13d9fc1a4641800e57be157ecd815","modified":1554714952122},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/lean-analytics.swig","hash":"71fb01bcad43bc9410ab19190373b9f7e59215b5","modified":1554714952126},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/tencent-analytics.swig","hash":"d18c87d7839e7407e39acd2998bcc9e0b34611b0","modified":1554714952128},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/tencent-mta.swig","hash":"a22d1ea29a5ffe46199ab7d108a291a05af8d5b6","modified":1554714952131},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/vkontakte-api.swig","hash":"4cff8bf5c42c62f7f0ac1f0d70f839dae39ba77a","modified":1554714952133},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/changyan.swig","hash":"bc3fc9d053b3d1fc0cd3918bf9a629a6f38f6414","modified":1554714952140},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/disqus.swig","hash":"d685df1516cb138d7a83bac5d7878a1e0fa8bc04","modified":1554714952142},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/disqusjs.swig","hash":"8b4a94dd80b3bac7c5390c8a7fd377b88c2cb78e","modified":1554714952144},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/gitalk.swig","hash":"4e86e1ace90a70bb8862f5e6de9dbe7bfc046bee","modified":1554714952145},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/gitment.swig","hash":"9a4923d2aa5182531ea7a7fb9abe824450026208","modified":1554714952150},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/index.swig","hash":"b3818fd0b3028dadf341b6d0b180e1243683de6a","modified":1554714952157},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/livere.swig","hash":"1a5d94f5779a2ce13abc886dd78e0617f89c34b9","modified":1554714952158},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/valine.swig","hash":"1b72c755101c9dfb85da13df9a0abccf37cd1dd2","modified":1554714952160},{"_id":"themes/hexo-theme-next/layout/_third-party/math/index.swig","hash":"43a20fa0e9ae2f4254f04813f9c619dd36b49ae5","modified":1554714952164},{"_id":"themes/hexo-theme-next/layout/_third-party/math/katex.swig","hash":"ea1c136f960667a0a13b334db497b9b19c41f629","modified":1554714952165},{"_id":"themes/hexo-theme-next/layout/_third-party/math/mathjax.swig","hash":"767ba29f258db5d2e5baf875a6f36ac1d44df6a3","modified":1554714952167},{"_id":"themes/hexo-theme-next/layout/_third-party/search/algolia-search.swig","hash":"143ef265c96a8ea2fb93c36c5ffb9c5e940f7693","modified":1554714952191},{"_id":"themes/hexo-theme-next/layout/_third-party/search/index.swig","hash":"078bd2d5815eb23e8c5f74467dc0042babea00ae","modified":1554714952193},{"_id":"themes/hexo-theme-next/layout/_third-party/search/localsearch.swig","hash":"d45ca53af17d1d83fd27f8ed0917a72f0060e1a9","modified":1554714952195},{"_id":"themes/hexo-theme-next/source/css/_custom/custom.styl","hash":"3403fdd8efde1a0afd11ae8a5a97673f5903087f","modified":1554714952438},{"_id":"themes/hexo-theme-next/source/css/_mixins/Gemini.styl","hash":"07f7da320689f828f6e36a6123807964a45157a0","modified":1554714952440},{"_id":"themes/hexo-theme-next/source/css/_mixins/Pisces.styl","hash":"1aabac9e37a8f4451c86d09037b3a1f8b30eaf5e","modified":1554714952444},{"_id":"themes/hexo-theme-next/source/css/_mixins/base.styl","hash":"21a14a19149f1cb8e011c477f29dd1352675605b","modified":1554714952446},{"_id":"themes/hexo-theme-next/source/css/_variables/Gemini.styl","hash":"e9b0752f08398709e787546a246baca12b4c557f","modified":1554714952501},{"_id":"themes/hexo-theme-next/source/css/_variables/Mist.styl","hash":"a25408534f8fe6e321db4bbf9dd03335d648fe17","modified":1554714952502},{"_id":"themes/hexo-theme-next/source/css/_variables/Pisces.styl","hash":"da7049f3d9a157abe0ecc62611edcf43605ba84d","modified":1554714952505},{"_id":"themes/hexo-theme-next/source/js/schemes/muse.js","hash":"ccc0c5cd4ec6f8159c98990ad83f11a5c0b0234c","modified":1554714952580},{"_id":"themes/hexo-theme-next/source/js/schemes/pisces.js","hash":"3eea56cc9ce47bb4760930c4c69cebf847a7fbb2","modified":1554714952582},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.bower.json","hash":"b4aefc910578d76b267e86dfffdd5121c8db9aec","modified":1554714952591},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.gitignore","hash":"03ddbf76c1dd1afb93eed0b670d2eee747472ef1","modified":1554714952592},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.npmignore","hash":"c31ff06a740955e44edd4403902e653ccabfd4db","modified":1554714952594},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1554714952596},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/bower.json","hash":"71e7183634dc1b9449f590f15ebd7201add22ca7","modified":1554714952606},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.min.js","hash":"bf172816a9c57f9040e3d19c24e181a142daf92b","modified":1554714952641},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.js","hash":"dbbfb50f6502f6b81dcc9fee7b31f1e812da3464","modified":1554714952660},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.min.js","hash":"dde584994ac13dc601836e86f4cf490e418d9723","modified":1554714952662},{"_id":"source/images/pasted-50.png","hash":"69eedb93a41e66286f300eb3e330b7ad54c7be63","modified":1554882868582},{"_id":"source/images/pasted-58.png","hash":"e83295ea073c15b6e07d66f853bbea4a0d679222","modified":1554884122484},{"_id":"source/images/pasted-60.png","hash":"df2d739232ca94f0aadb66dcb0ee00c1354bdbdd","modified":1554884210487},{"_id":"themes/hexo-theme-next/source/css/_variables/base.styl","hash":"ebc95eeb8966d17cdc7dd0de009deaef1fe65064","modified":1554714952511},{"_id":"themes/hexo-theme-next/source/lib/jquery/index.js","hash":"17a740d68a1c330876c198b6a4d9319f379f3af2","modified":1554714952633},{"_id":"themes/hexo-theme-next/.git/logs/refs/heads/master","hash":"611b9d1174c0a9ebb1e2c85b6b8c0cb64d1251e0","modified":1554714951573},{"_id":"themes/hexo-theme-next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1554714951556},{"_id":"themes/hexo-theme-next/source/css/_common/components/back-to-top-sidebar.styl","hash":"5c0ca7f801859cff254d2f5b7d1a70d66ff61a8d","modified":1554714952259},{"_id":"themes/hexo-theme-next/source/css/_common/components/back-to-top.styl","hash":"463817cbbd804ce134cb3e7e721431cb0e1616f2","modified":1554714952261},{"_id":"themes/hexo-theme-next/source/css/_common/components/buttons.styl","hash":"9fd526db0527c71243f05e18086f937dc67b1c3e","modified":1554714952264},{"_id":"themes/hexo-theme-next/source/css/_common/components/comments.styl","hash":"ff4489cd582f518bba6909a301ac1292a38b4e96","modified":1554714952265},{"_id":"themes/hexo-theme-next/source/css/_common/components/components.styl","hash":"997058180065d986e05df72992cc2cbfd7febd7e","modified":1554714952267},{"_id":"themes/hexo-theme-next/source/css/_common/components/pagination.styl","hash":"a4c6ee546a94fd69e5b7a1e4c054ab8cacb73d2a","modified":1554714952307},{"_id":"themes/hexo-theme-next/source/css/_common/components/rainbow.styl","hash":"cfa64bd8ee2ff9f943673e339d69341e76fbf031","modified":1554714952339},{"_id":"themes/hexo-theme-next/source/css/_common/components/scrollbar.styl","hash":"afdd21533db18d846e1a2663b1199761b1bd2c1e","modified":1554714952352},{"_id":"themes/hexo-theme-next/source/css/_common/outline/outline.styl","hash":"1a4ac0d119f2126ef8951897338706edce112235","modified":1554714952421},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/base.styl","hash":"40144394fdfe05d400f39f6763f66f75479a2e34","modified":1554714952424},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/helpers.styl","hash":"35c6fd7eab3779bd9e38b7ba8825ab0c67a1be7a","modified":1554714952425},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/mobile.styl","hash":"b85177a142ab537612506dcfe4507ec845bd94cb","modified":1554714952427},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/normalize.styl","hash":"fec36a14080104b5862e9f021eab117d87c5f7c5","modified":1554714952429},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/scaffolding.styl","hash":"a17e2b871a335f290afb392a08f94fd35f59c715","modified":1554714952430},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/tables.styl","hash":"107f42aa590ec4ba0765a0bc5d735f0f09edc0ff","modified":1554714952432},{"_id":"themes/hexo-theme-next/source/css/_schemes/Gemini/index.styl","hash":"a609ff811f2b2764f5470236fe2fb1f3aa6ccba5","modified":1554714952452},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_base.styl","hash":"d0e9065b0dbbc01811259f0597d1790268b4881b","modified":1554714952454},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_header.styl","hash":"8da8416213127595dfc4d2b358639194647e7bd3","modified":1554714952456},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_logo.styl","hash":"b1025c421406d2c24cc92a02ae28c1915b01e240","modified":1554714952457},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","hash":"40f266e24af4dedc9497056ab18ebcfda38dd47d","modified":1554714952459},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"06d9d00257abd28414ec0b746f866bf9911cf5ec","modified":1554714952461},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_search.styl","hash":"6aee54cd5a20181e18596565356bd54c66e33823","modified":1554714952462},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/index.styl","hash":"25f05ed8da68d034dce7f06e0f20f6cd55841070","modified":1554714952464},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_layout.styl","hash":"04706657af638f2746ae59520e6fc78577c7682c","modified":1554714952479},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_logo.styl","hash":"157e6915dcf5990566e463acffa71043b2651c07","modified":1554714952480},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_menu.styl","hash":"234b44cfd03f9c9e3e179ff5fd698ac876341913","modified":1554714952482},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_search.styl","hash":"6aee54cd5a20181e18596565356bd54c66e33823","modified":1554714952484},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/index.styl","hash":"5dbc0d0c897e46760e5dbee416530d485c747bba","modified":1554714952486},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_brand.styl","hash":"b9619c9827f969ca2e2f5878552362a7b858918f","modified":1554714952491},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_layout.styl","hash":"e73d6da74c5755442e831d8fd7d922c5b32bd892","modified":1554714952493},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_menu.styl","hash":"0b3001909f3446843b226030524ea8498d4d8997","modified":1554714952494},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"0d6f0df798449b710e1e5dbd43d470089b2a3c95","modified":1554714952497},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_sidebar.styl","hash":"5b5e0a02a7bf63de9efcd33a4e482939cce5822d","modified":1554714952495},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/index.styl","hash":"adb7379f3b9001840eb38b260434e89365771a81","modified":1554714952498},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css","hash":"3655f1fdf1e584c4d8e8d39026093ca306a5a341","modified":1554714952609},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1554714952611},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.min.css","hash":"88af80502c44cd52ca81ffe7dc7276b7eccb06cf","modified":1554714952616},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1554714952629},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.js","hash":"4237c6e9d59da349639de20e559e87c2c0218cfd","modified":1554714952638},{"_id":"themes/hexo-theme-next/.git/logs/refs/remotes/origin/HEAD","hash":"611b9d1174c0a9ebb1e2c85b6b8c0cb64d1251e0","modified":1554714951556},{"_id":"themes/hexo-theme-next/source/css/_common/components/footer/footer.styl","hash":"2df409df04fdb52d7234876a9f6e502edd4e3929","modified":1554714952273},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/github-banner.styl","hash":"a8f4d4b86acaa34c99111b2dde5d0779cc7e0de6","modified":1554714952276},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/header.styl","hash":"c9cfb4b99e1ec8ec9cf075cb761b8f7fa5fe63fd","modified":1554714952278},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/headerband.styl","hash":"d63e0cacc53dd375fcc113465a4328c59ff5f2c1","modified":1554714952279},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/menu.styl","hash":"33200f60bd6a8bbfc66dd49a239bcc75c2f564c1","modified":1554714952281},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-meta.styl","hash":"b8647d6140141b0a160607f6353e4d4594cca92e","modified":1554714952282},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-nav.styl","hash":"3a0efe849587b34f20d4e260028dc799215b0bb3","modified":1554714952284},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/diff.styl","hash":"024e8ff40ca881c6fbf45712897e22f58a3811ab","modified":1554714952286},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/highlight.styl","hash":"9c1a082e6c1f96187a099c3f4cb5424c0c9fd06e","modified":1554714952288},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/theme.styl","hash":"7fe4d4d656e86276c17cb4e48a560cb6a4def703","modified":1554714952290},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/archive.styl","hash":"e5a5f8747fdf2ca960e4e73c081b8952afd62224","modified":1554714952292},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/breadcrumb.styl","hash":"fa1cea6fcc3f552d57cc7d28380a304859139bf6","modified":1554714952294},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/categories.styl","hash":"7fb593f90d74a99c21840679933b9ef6fdc16a61","modified":1554714952295},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/pages.styl","hash":"9a8fb61bd2d184de9d206e62ba8961d1845c5669","modified":1554714952297},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/post-detail.styl","hash":"4e3838d7ac81d9ad133960f0f7ed58a44a015285","modified":1554714952298},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/schedule.styl","hash":"c27527cdeb9e3a9f447f7238f442a5dc33fde4e6","modified":1554714952304},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/tag-cloud.styl","hash":"c97c819a65f6967485184399397601e5133deda6","modified":1554714952305},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-button.styl","hash":"62fbbd32cf5a99ae550c45c763a2c4813a138d01","modified":1554714952309},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-collapse.styl","hash":"f3b0d259e991ac86454ae5eac6bc94dc8691d8c9","modified":1554714952316},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-copyright.styl","hash":"fc94dd09b4245143b452d6cf2fc4c12134d99d6d","modified":1554714952317},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-eof.styl","hash":"a73346f999b31355075cd58637946a8950cf6f7e","modified":1554714952319},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-expand.styl","hash":"f14cefc99309934d4103a3aa785e1258d858813f","modified":1554714952321},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-gallery.styl","hash":"b6a241626783d2ac115d683fd59ec283af68e5bb","modified":1554714952322},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-meta.styl","hash":"d77f85d3af2d7090d84b28ab01c6a49f92eec647","modified":1554714952324},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-nav.styl","hash":"13d365ee626c01f17ec664b3f54f51d8b9ee7cf4","modified":1554714952325},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-reading_progress.styl","hash":"4aad8e36178faaa71a767af0084d578df4c09f73","modified":1554714952327},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-reward.styl","hash":"ccd0b1309acff0c676fdcc848a8ae2d05f0369ab","modified":1554714952328},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-rtl.styl","hash":"b2495ae5e04dcca610aacadc47881d9e716cd440","modified":1554714952330},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-tags.styl","hash":"5a982d8ef3b3623ea5f59e63728990f5623c1b57","modified":1554714952331},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-title.styl","hash":"539fc0880b2e035e8316d5d4b423703195c1b7ba","modified":1554714952333},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-type.styl","hash":"c8009fd9598a661b7d23158b5121b6ac266939e9","modified":1554714952334},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-widgets.styl","hash":"981795aad232c8bd3f52a0ed8720db696d18a234","modified":1554714952336},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post.styl","hash":"615fca7dff197a2ca3df674cf963ce70b8525985","modified":1554714952337},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"a5484d8436b2b7862faf6e7309a9e7b88cdd0027","modified":1554714952361},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"ab1776c5dc537beabb0ab81a0f04e08bebad070b","modified":1554714952362},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"03a4e75e963e3e7cc393d588b1495a88d52e0e40","modified":1554714952364},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"b36eea093bd4b32056b5de6f370ff57e50b25a49","modified":1554714952367},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"e58bb8b7127aa21e8260493a425ec00fcb25d338","modified":1554714952369},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"7e2ba73073daaea0a18c3d67ff137dd683af7011","modified":1554714952370},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"9204c79c05d620ecd5d411cdf11e27441b6281dc","modified":1554714952372},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"0eadef0381f696de7f88d7dc5f0ddc3cd5d309b3","modified":1554714952374},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar.styl","hash":"3cb387fa70017f3c24a1a1884461d29deda54585","modified":1554714952375},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/site-state.styl","hash":"ed3a2960ebce7396d1893bb8e08c99c7d9259140","modified":1554714952377},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/blockquote-center.styl","hash":"fde59300ec38868676ff5ed495b9dc9b02d07ffc","modified":1554714952380},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/full-image.styl","hash":"2d58ad90f148e845bc7023751a7a13260600f8d6","modified":1554714952381},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/group-pictures.styl","hash":"2ad1a2a9bbf6742d1b0762c4c623b68113d1e0fe","modified":1554714952383},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/label.styl","hash":"b43421291bf85b589e8d0ec853e238d36ab80631","modified":1554714952385},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/note.styl","hash":"020fac447d7a17c03e2802f0f724ae0738088354","modified":1554714952387},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/pdf.styl","hash":"3baeeb51cfe123e99235ee1816d0e1f6a97c7852","modified":1554714952388},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/tabs.styl","hash":"54c5398c7bf5b8bd9f38a9ece1dd82a9255f9a30","modified":1554714952390},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/tags.styl","hash":"da7a21f5a2f7dcf4c5a4788d7670159ca4132b65","modified":1554714952398},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/algolia-search.styl","hash":"4305813408a1cd6aba764a7769b94b081d383d4f","modified":1554714952401},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/copy-code.styl","hash":"d9c244b1c3a09a7fccd3c3f732e6fb112a8cd565","modified":1554714952405},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl","hash":"a01484e350ad5fc9b1fdfbfafb2ddd9687ad4d20","modified":1554714952407},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/gitment.styl","hash":"2fbe52f955da41c7a14eb09918bf86a252e4504f","modified":1554714952408},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/han.styl","hash":"2a1008f1044b450b806adc166754ba9513e68375","modified":1554714952410},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/localsearch.styl","hash":"ed8a12982c0497eeb9d7642781abeb801428f83d","modified":1554714952411},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/math.styl","hash":"6880467b4f6d7b057fb8291aa10966429a0a3bff","modified":1554714952413},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/needsharebutton.styl","hash":"35dc9f3990fadff3ea038d4e8ac75923219886ed","modified":1554714952415},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/related-posts.styl","hash":"9801977a23268e36c5deefd270423f6f1a0c3bb2","modified":1554714952417},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/third-party.styl","hash":"7cf42f96ba6b249c75e00dad251ebacf7de61e6c","modified":1554714952418},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/outline/outline.styl","hash":"a07aa12cc36ac5c819670c2a3c17d07ed7a08986","modified":1554714952466},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1554714952476},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"1f09be9bb38411f0629b58c3b23873589a6dbcaa","modified":1554714952488},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1554714952626},{"_id":"source/images/pasted-21.png","hash":"e31d7b92b0c58faeecdd44c8ad00eeb9a3783e53","modified":1554880537095},{"_id":"themes/hexo-theme-next/.git/objects/pack/pack-eb99e69322f4d6b6cf7422657ccdd2a72a650054.idx","hash":"379dc20b1b8de0aaa7bc7644f3b092d0315b15d0","modified":1554714951419},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1554714952623},{"_id":"source/images/pasted-23.png","hash":"9c01c23fd815ffbd134add353fab53e9855254df","modified":1554880633115},{"_id":"source/images/pasted-20.png","hash":"6853b316e1e526f9bb5805b3bdd2f0260d4f9fe3","modified":1554880512495},{"_id":"themes/hexo-theme-next/.git/objects/pack/pack-eb99e69322f4d6b6cf7422657ccdd2a72a650054.pack","hash":"824d9499330da002e0eec0639d46c335822efb78","modified":1554714951413},{"_id":"public/about/index.html","hash":"2dc594728942ea4d5d8e0ac5b811ad4a1fa4a5cd","modified":1554886871163},{"_id":"public/404.html","hash":"df38da4dc819403f67a23f46093461a9a726cc0c","modified":1554886871163},{"_id":"public/categories/index.html","hash":"82fc3abe4c4d8cf3e006c51b9f0b65d361f445bf","modified":1554886871164},{"_id":"public/schedule/index.html","hash":"7c9b9aa5bf4d841ab8d5685e9ba4b79c2221056d","modified":1554886871164},{"_id":"public/2019/04/08/谈一谈锁/index.html","hash":"6147d07652af8064a9deedb9f51e4a3ebc814df8","modified":1554886871164},{"_id":"public/archives/page/4/index.html","hash":"1aacbb09b3493ef2ede014b4de106b37d5a95772","modified":1554886871164},{"_id":"public/archives/2017/09/index.html","hash":"31da7bdd68c35795ef82aa52a6f63c5c2edb8736","modified":1554886871164},{"_id":"public/archives/2018/05/index.html","hash":"b49c98c80483e1eefc35df74afdd4df4958dce31","modified":1554886871164},{"_id":"public/archives/2018/06/index.html","hash":"f674cda2a1b8f447aa2c8c4dda5e1ec2edb1efef","modified":1554886871164},{"_id":"public/archives/2018/08/index.html","hash":"ff87e03c17c41436b1e5b6ef935ad2f6cf8823bf","modified":1554886871165},{"_id":"public/archives/2018/09/index.html","hash":"31a8fe61da42019d5a17cfd382cb4f6a3ed64f77","modified":1554886871165},{"_id":"public/archives/2018/10/index.html","hash":"2a3eb96d7723c3e7fb888321cba19cbd8228e7e0","modified":1554886871165},{"_id":"public/archives/2018/12/index.html","hash":"ce0e52dd5d09649ad129dc1d8d94a4e4563d56e9","modified":1554886871165},{"_id":"public/archives/2019/03/index.html","hash":"881712995d0db8c79a2f50bd019c7cc2c468d6bb","modified":1554886871165},{"_id":"public/categories/JVM/index.html","hash":"bb0d8845c900d387c7713a084732b06505b5d88c","modified":1554886871165},{"_id":"public/categories/外部引用/index.html","hash":"dadcae77ba5dec8616c4f2f1c61ce16383f637ce","modified":1554886871165},{"_id":"public/tags/GC-G1/index.html","hash":"641f8e00855fa806b057467ce1efb803335cbd92","modified":1554886871165},{"_id":"public/tags/JVM/index.html","hash":"a321cae576c6454d409671cd792589d3d82c8636","modified":1554886871165},{"_id":"public/tags/GC/index.html","hash":"fbbd8388145fc244bc7e817e9881e57c072ec825","modified":1554886871165},{"_id":"public/tags/类加载/index.html","hash":"75807e98dd5bff2801c97d3732ed1f314cf3ed97","modified":1554886871165},{"_id":"public/tags/数据库连接池/index.html","hash":"cab006b3f4c3b98b60fb694ad230193830847ccd","modified":1554886871165},{"_id":"public/tags/db/index.html","hash":"9a3262f2802bcad953f57cbebd1f356276fef543","modified":1554886871166},{"_id":"public/tags/druid/index.html","hash":"18f8f4c6b1fb98bb23b7a5c516f5aec36b5337b7","modified":1554886871166},{"_id":"public/tags/dubbo/index.html","hash":"a7b0bb0c56b504dcc75f817a50510c0ae35e3fb8","modified":1554886871166},{"_id":"public/tags/序列化/index.html","hash":"b8eec1b7f7d837e5b5db9300d8b5f10f40c970fd","modified":1554886871166},{"_id":"public/tags/hessian/index.html","hash":"441c9b40433e2ee1db39a1b1cc3966a4212a9f34","modified":1554886871166},{"_id":"public/tags/zookeeper/index.html","hash":"078743cb7a83c9d6cf8e86014e71bce02b531551","modified":1554886871166},{"_id":"public/tags/elk/index.html","hash":"97f95a5e5d21078acc3e447b6ef31cba2d1714d2","modified":1554886871166},{"_id":"public/tags/集群/index.html","hash":"22fd969fdc1b733ddddf0cf30a0ee6819ab2876b","modified":1554886871166},{"_id":"public/tags/java/index.html","hash":"9de987eb890fb1895d2760d01367f851a4df16ce","modified":1554886871166},{"_id":"public/tags/java对象/index.html","hash":"f24713ccdaf8c72544b68c2a3935504c62049b10","modified":1554886871166},{"_id":"public/tags/jdk8/index.html","hash":"a4f8137e09d09f0c3c4c4ddc650d63af413903ce","modified":1554886871166},{"_id":"public/tags/dump/index.html","hash":"a97be316fffdeb4cfd29af241569caa489ad72c8","modified":1554886871166},{"_id":"public/tags/linux/index.html","hash":"fcd05d4584c39b0f21e23ac6e6398daacb8737dc","modified":1554886871167},{"_id":"public/tags/tail/index.html","hash":"2b09a8d76588a54f34c1aba1549d39e734602363","modified":1554886871167},{"_id":"public/tags/maven/index.html","hash":"604a6732a0cf1fc2b13fef0080dbb20d979b1e1e","modified":1554886871167},{"_id":"public/tags/jdk/index.html","hash":"cd39d5b0f2f30fb2e91d54202df50e93be3d17c8","modified":1554886871167},{"_id":"public/tags/mysql/index.html","hash":"678e8a01532b0710ad271a7b9c89492c640288d7","modified":1554886871167},{"_id":"public/tags/mongo/index.html","hash":"05f006fe9fbf410d9910f9e49d9fe2bc225ba0d5","modified":1554886871167},{"_id":"public/tags/rabbitmq/index.html","hash":"61ff282bd4b5f0cf422e0c391c9bfc7e76bf3e84","modified":1554886871167},{"_id":"public/tags/消息队列/index.html","hash":"3628b1cb8520634af920cf18ffac746aecb5be61","modified":1554886871167},{"_id":"public/tags/struts2/index.html","hash":"5f71f7a871c1ef139426a00b5e8bacf194b97731","modified":1554886871167},{"_id":"public/tags/spring/index.html","hash":"cc55b66b8d0f4f9ec1268a62439346709286ed64","modified":1554886871167},{"_id":"public/tags/springboot/index.html","hash":"59aac7a32cae01f6e3dd27866a43f7e78edbb3a5","modified":1554886871167},{"_id":"public/tags/应用监控检查/index.html","hash":"6d3ccb591704a620dfa52faec39cb0fae883e383","modified":1554886871168},{"_id":"public/tags/内存泄漏/index.html","hash":"e0191d03921f0008cb21d18c213ab320e1f4c006","modified":1554886871168},{"_id":"public/tags/mat/index.html","hash":"a5c9022cd10f2ad9c1d6e2423289de69ecff1bda","modified":1554886871168},{"_id":"public/tags/优雅停机/index.html","hash":"f2622f6fdac49d81770b76006a8104bb0a884902","modified":1554886871168},{"_id":"public/tags/浏览器/index.html","hash":"556347613efc62e82380658af20bc02ba59d48d8","modified":1554886871169},{"_id":"public/tags/架构/index.html","hash":"d9eccb080026021bcca69af7f67b7e97f041465a","modified":1554886871169},{"_id":"public/tags/javaagent/index.html","hash":"086eb6f337074c7956f51c19f2a3ba49ccf188ca","modified":1554886871169},{"_id":"public/tags/index.html","hash":"d77b6a052715ff8315a8aadbf2fb65fb43596e6d","modified":1554886871170},{"_id":"public/2019/04/10/G1-Evacuation-Failure/index.html","hash":"0eedc39fed09f9f0510d3098cba2922290d7fec5","modified":1554886871170},{"_id":"public/2019/04/10/G1-Humongous-Allocation/index.html","hash":"f3f9c053cb4eb371b070861282bc5ff57d6ac9a1","modified":1554886871170},{"_id":"public/2019/04/09/G1垃圾回收器-xx-initiatingheapoccupancypercent变量之问/index.html","hash":"bc9ed06a9affdeea8c97237adea894d1b7b03fbe","modified":1554886871171},{"_id":"public/2019/04/08/浅谈JVM之垃圾回收/index.html","hash":"d455453c4b5fd208b286737841cc9bc2c388ac9b","modified":1554886871171},{"_id":"public/2019/03/07/dubbo-基于zookeeper的注册结构/index.html","hash":"bd8038a8cd1e21b776914abbc73c712fc0344edc","modified":1554886871171},{"_id":"public/2018/12/07/mongo-查询报no-property-found-on/index.html","hash":"a2d0bce6031e4afed6f4857b7b17a3810c35e508","modified":1554886871172},{"_id":"public/2018/10/31/javaagent-bytebuddy/index.html","hash":"557b5d636b4e7a98cc6cc0de173ddedb8078d0eb","modified":1554886871172},{"_id":"public/2018/09/10/zookeeper-反复重连问题/index.html","hash":"e4d072a61d59404cdbf8f6815ddd4835262dfef2","modified":1554886871172},{"_id":"public/2018/09/10/jdk8-dump异常/index.html","hash":"b4f93bd41de7022ef0d38e539430e6d8c9580381","modified":1554886871173},{"_id":"public/2018/08/06/java-对象使用问题案例/index.html","hash":"1c2069a2502118f20af03256976b2fc416a4d71a","modified":1554886871173},{"_id":"public/2018/07/30/数据库-kill服务进程引发的血案/index.html","hash":"b7a5fc8a45a897b6d26ee1d2db84413cc0e0c80b","modified":1554886871173},{"_id":"public/2018/07/22/数据库-重启引发的主键问题/index.html","hash":"958f0e60959a07f9373c1664ca4ea7df0d0cacc0","modified":1554886871174},{"_id":"public/2018/07/19/rabbitmq-报not-equivalent错/index.html","hash":"993402210a641f3f215b36c720d2a8be20648353","modified":1554886871174},{"_id":"public/2018/07/17/应用停机-优雅停机问题/index.html","hash":"d245cd41badecb8710862e0f93f221aa37576376","modified":1554886871174},{"_id":"public/2018/07/12/springboot-spring-boot-starter-actuator/index.html","hash":"65866380bf88c0477b041713195a61fccdec7876","modified":1554886871175},{"_id":"public/2018/07/12/druid-filter/index.html","hash":"36c43c212d429b119dfda98af47dd3716e656c00","modified":1554886871175},{"_id":"public/2018/07/09/内存泄漏案例分析/index.html","hash":"e0594cc2451b80b5e32ba6f28e7be7c9aa166edb","modified":1554886871175},{"_id":"public/2018/06/28/dubbo-反序列化问题/index.html","hash":"494742175b7a1f297722d6555303d27bb501eb54","modified":1554886871175},{"_id":"public/2018/06/12/dubbo-（反）序列化/index.html","hash":"c143948b3004e091e88e40c2ba777cc70b9c13c3","modified":1554886871175},{"_id":"public/2018/05/28/JVM-类加载/index.html","hash":"14672630bd55c2093c869d16c601676e35a39f9b","modified":1554886871176},{"_id":"public/2017/09/27/elasticsearch-集群/index.html","hash":"e020d8fc72306ad305c5e601f35d4b12c011613b","modified":1554886871176},{"_id":"public/2017/07/20/mysql-TIMESTAMP/index.html","hash":"c667c266ba798493645c14f3080b512abd80d106","modified":1554886871176},{"_id":"public/2017/07/20/maven-Failed-to-execute-goal-org-apache-maven-plugins-maven-enforcer-plugin/index.html","hash":"6b274a0471e91b9f936a02c354a508e943676125","modified":1554886871176},{"_id":"public/2017/07/20/maven-Plugin-execution-not-covered-by-lifecycle-configuration/index.html","hash":"d1992aae0738171c3c060a29b1c654489c0a3384","modified":1554886871176},{"_id":"public/2017/07/20/struts2-no-action-in-maven/index.html","hash":"c65e30d10dbfce89cf6a8b53f8579fab1cee72a6","modified":1554886871176},{"_id":"public/2017/07/20/浏览器-资源加载/index.html","hash":"c0e54ee880fadeec31031d0563d11b78cce0be4c","modified":1554886871176},{"_id":"public/2017/07/20/淘宝架构-进化/index.html","hash":"e094a8cf19850b669c379cd1e703715602ff996a","modified":1554886871176},{"_id":"public/2017/07/20/linux-tail命令不生效/index.html","hash":"232b6e1544a38ec62b07bc83d4a550be23af0ba4","modified":1554886871176},{"_id":"public/2017/07/20/maven-No-plugin-found-for-prefix-tomcat7/index.html","hash":"52dd4d0a0fda6b1be4efbd1b60c5be2ecb0d94fe","modified":1554886871176},{"_id":"public/2017/07/20/maven-默认jdk版本/index.html","hash":"c6b465e2677b8969af4a104acddb62df243ba850","modified":1554886871176},{"_id":"public/archives/index.html","hash":"f84ec4066252e77858dd5e8c536b40aae00b3e1e","modified":1554886871177},{"_id":"public/archives/page/2/index.html","hash":"67930de93d55bfcb30bb96e251017ed3835ee571","modified":1554886871177},{"_id":"public/archives/page/3/index.html","hash":"c0acc2bf7f9df5d32662b1e208e8aa9fedf42aea","modified":1554886871177},{"_id":"public/archives/2017/index.html","hash":"a611c4acb1efa225c2d60e261c2645b239af51ce","modified":1554886871177},{"_id":"public/archives/2017/07/index.html","hash":"50f18ccc18684d32e4fad4f14e30ca09c3a3e4fd","modified":1554886871177},{"_id":"public/archives/2018/index.html","hash":"4be0f73c0ff5916261901c7be420c5caccfd0963","modified":1554886871177},{"_id":"public/archives/2018/page/2/index.html","hash":"4b8dbd57d504c26a03bbbc3cb0ffcfa5540c9821","modified":1554886871177},{"_id":"public/archives/2018/07/index.html","hash":"ff67fc3acc83abdbba2d3ea718502e35ee74992e","modified":1554886871177},{"_id":"public/archives/2019/index.html","hash":"3d5fe8a29d5523cde3f98b2496bc5f731bdf2fa0","modified":1554886871177},{"_id":"public/archives/2019/04/index.html","hash":"af38b37697ad59e2fbf2b929d818d01751882a4d","modified":1554886871178},{"_id":"public/categories/爱学爱问/index.html","hash":"1cd603b87556ddfb73ff9959e2fe1108662b9d8b","modified":1554886871178},{"_id":"public/categories/爱学爱问/page/2/index.html","hash":"deeaef41a669fd7eccde0a1d6f8440eff8b3aaa3","modified":1554886871178},{"_id":"public/categories/爱学爱问/page/3/index.html","hash":"36530e7dbd17fd1c0237212f2c5923e20b71a39c","modified":1554886871178},{"_id":"public/page/2/index.html","hash":"d93e86ebbf8d95866cc74a24a3f0673ba008c4dc","modified":1554886871178},{"_id":"public/index.html","hash":"50380fb92ae085eb9aefd6061303cf33b6ff854e","modified":1554886871179},{"_id":"public/page/3/index.html","hash":"43df7044daac016895f41860267c2f28a190d567","modified":1554886871179},{"_id":"public/page/4/index.html","hash":"f9675f80410d16d8237ff557d42b5d45a5affdc6","modified":1554886871180},{"_id":"public/tags/bytebuddy/index.html","hash":"00086a457d808990b53e7efe5fde60079d1b5da4","modified":1554886871225},{"_id":"public/images/pasted-0.png","hash":"3c5bebef8fcf19a8f2c98a88495866b25e28c288","modified":1554886871226},{"_id":"public/images/pasted-10.png","hash":"7c63f1cc32c191cff49ec5bee0634ffebb4d0f41","modified":1554886871226},{"_id":"public/images/pasted-11.png","hash":"0da5839c58d93b98b577b40374630992516397c9","modified":1554886871227},{"_id":"public/images/pasted-14.png","hash":"7d7fa913eef8c753d25b24cd610297be8e979e79","modified":1554886871228},{"_id":"public/images/pasted-18.png","hash":"895e9a3d62baa7c9da9af873b11cf74377ac99a4","modified":1554886871228},{"_id":"public/images/pasted-19.png","hash":"1f045eed6f9ebad8ee4981bb2ac7e571400fa789","modified":1554886871228},{"_id":"public/images/pasted-2.png","hash":"572b64658cfaa1bf0b752a9408821f4133331a5e","modified":1554886871229},{"_id":"public/images/pasted-24.png","hash":"12d854af02c4101e329dcdecd1a3aba33a030f60","modified":1554886871229},{"_id":"public/images/pasted-25.png","hash":"4b73f1a98581612d407594370e5c5397a5c80d1e","modified":1554886871229},{"_id":"public/images/pasted-26.png","hash":"5b5fe3fba7c5b2691e4aca04216d02dabc66cea5","modified":1554886871230},{"_id":"public/images/pasted-27.png","hash":"76ebe1be5de9bc77ba3bded99b0e421a67554dfc","modified":1554886871230},{"_id":"public/images/pasted-28.png","hash":"a334565cd08774738f05af99cd25449b40afeecd","modified":1554886871230},{"_id":"public/images/pasted-29.png","hash":"a334565cd08774738f05af99cd25449b40afeecd","modified":1554886871230},{"_id":"public/images/pasted-32.png","hash":"5da3568c83cdc7f1665806c152f922bd3a260fb5","modified":1554886871230},{"_id":"public/images/pasted-33.png","hash":"0e1a4784aec0a0d49f2cef37b9ced85eae0f19d1","modified":1554886871230},{"_id":"public/images/pasted-34.png","hash":"b6883d450159369476845b3304599b33d55bc25b","modified":1554886871230},{"_id":"public/images/pasted-36.png","hash":"e1d15b97163e3f49aa6fca964e36bfaec20505d7","modified":1554886871231},{"_id":"public/images/pasted-37.png","hash":"a647f6b5f4af9c97b0345064c2e03bed433fb7e5","modified":1554886871231},{"_id":"public/images/pasted-38.png","hash":"97f34628fd7816d9daa1e799fcc756bbbca82ad9","modified":1554886871231},{"_id":"public/images/pasted-39.png","hash":"8015ae73c4b94397bf2b04bfb833472f89244532","modified":1554886871232},{"_id":"public/images/pasted-40.png","hash":"efc5da95b15c817fd34471f30d13ec7780521514","modified":1554886871232},{"_id":"public/images/pasted-41.png","hash":"8cfaf01339aae2e46dbf5ce7863086caaeb32b3f","modified":1554886871233},{"_id":"public/images/pasted-42.png","hash":"1b63b44b25fe9690c2a4bff85a2b164ddc191e44","modified":1554886871235},{"_id":"public/images/pasted-43.png","hash":"58ede5e6d6feff9b62ae537856c96f87d269aa01","modified":1554886871235},{"_id":"public/images/pasted-44.png","hash":"ac34c1452a07347421b6cbf52c8f768d3084fa75","modified":1554886871236},{"_id":"public/images/pasted-45.png","hash":"540bcd2ecf51702fcf7cfa8aa41eac361e742f2a","modified":1554886871236},{"_id":"public/images/pasted-47.png","hash":"39f267579a50d5fefc1a29ed0383718433ad685a","modified":1554886871236},{"_id":"public/images/pasted-48.png","hash":"0afe35569b77ebb8ad4c198203c3dc6937942ad4","modified":1554886871236},{"_id":"public/images/pasted-53.png","hash":"9af4c8c80a9f1316559b9f7e20879443daaf564f","modified":1554886871236},{"_id":"public/images/pasted-55.png","hash":"fdde17b659e2a2a594638d9b9612ac39d5251f10","modified":1554886871237},{"_id":"public/images/pasted-54.png","hash":"3e3fece4e90e123648dafc121d8222d70fead0bf","modified":1554886871237},{"_id":"public/images/pasted-56.png","hash":"1deba22e9e40e5868dc4477130cd8092968209fb","modified":1554886871238},{"_id":"public/images/pasted-7.png","hash":"18d586673d7d12e0b4cb6b0ec7679b995b8d57ae","modified":1554886871238},{"_id":"public/images/pasted-8.png","hash":"553fb1dd618d381332e5e33b0ddcdb9e65e3e8c8","modified":1554886871238},{"_id":"public/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1554886871239},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1554886871240},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1554886871240},{"_id":"public/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1554886871240},{"_id":"public/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1554886871240},{"_id":"public/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1554886871240},{"_id":"public/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1554886871242},{"_id":"public/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1554886871242},{"_id":"public/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1554886871242},{"_id":"public/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1554886871242},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1554886871242},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1554886871242},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1554886871243},{"_id":"public/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1554886871243},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1554886871243},{"_id":"public/images/quote-l.svg","hash":"cd108d6f44351cadf8e6742565217f88818a0458","modified":1554886871243},{"_id":"public/images/quote-r.svg","hash":"2a2a250b32a87c69dcc1b1976c74b747bedbfb41","modified":1554886871243},{"_id":"public/images/searchicon.png","hash":"025d64ba0160a3a2257dd2b3032b5f7c9dd9b82b","modified":1554886871243},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"ee33b2798b1e714b904d663436c6b3521011d1fa","modified":1554886871243},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"1573904b82807abbb32c97a3632c6c6808eaac50","modified":1554886871244},{"_id":"public/images/pasted-1.png","hash":"2fa5474ed957c6db8a1706c0dd6f7ebe246fe8ce","modified":1554886874716},{"_id":"public/images/pasted-15.png","hash":"982268d3cc54f70beae137f40c0e829ecc79e267","modified":1554886874717},{"_id":"public/images/pasted-16.png","hash":"4bd7bdf4bb0e335166ca6b73d2519ecde5186c13","modified":1554886874722},{"_id":"public/images/pasted-22.png","hash":"c559fed4f04798d54344a2be9eb426aed2d090cd","modified":1554886874723},{"_id":"public/images/pasted-3.png","hash":"542656a87c61559ba6b9de7d898959ce5b66bf26","modified":1554886874723},{"_id":"public/images/pasted-30.png","hash":"c14c8dc37a7346d34faeec058c2433e2fe6b230d","modified":1554886874723},{"_id":"public/images/pasted-31.png","hash":"34d16af5e5c08ed5d21e4dba6a9f824a38ffdf95","modified":1554886874724},{"_id":"public/images/pasted-35.png","hash":"5cdd93179bbd33c52c5e882e1794c22c2b1ac83e","modified":1554886874724},{"_id":"public/images/pasted-46.png","hash":"0750ae34c5cd71f65471af8135d2ab204fa189cc","modified":1554886874724},{"_id":"public/images/pasted-4.png","hash":"f08def5db40d8ced9cdf23d5d0261ecbb0d245c5","modified":1554886874725},{"_id":"public/images/pasted-49.png","hash":"5fe72327894be154937213278bb11b1518b55a09","modified":1554886874726},{"_id":"public/images/pasted-52.png","hash":"51a45ad8a44ebfab8ca80997109a0fb5b48636b2","modified":1554886874727},{"_id":"public/images/pasted-6.png","hash":"aa86792c3bd66a7ebd57dcf17ab6bdae6fb225f1","modified":1554886874727},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1554886874728},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1554886874728},{"_id":"public/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1554886874878},{"_id":"public/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1554886874879},{"_id":"public/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1554886874880},{"_id":"public/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1554886874880},{"_id":"public/js/next-boot.js","hash":"e0615efab5f81ba0fd39c0527eac31144deac7ce","modified":1554886874881},{"_id":"public/js/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1554886874881},{"_id":"public/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1554886874881},{"_id":"public/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1554886874881},{"_id":"public/js/schemes/muse.js","hash":"e9bfa6b343b67625f58757efce46ccdaac8f308c","modified":1554886874881},{"_id":"public/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1554886874881},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1554886874881},{"_id":"public/css/main.css","hash":"5ff9e164866b9535c242b75fdcff009d21e7d19d","modified":1554886874882},{"_id":"public/images/pasted-12.png","hash":"2b99b4381ba748311a8dd92588cf491a4059b9bc","modified":1554886874882},{"_id":"public/images/pasted-13.png","hash":"2b99b4381ba748311a8dd92588cf491a4059b9bc","modified":1554886874882},{"_id":"public/images/pasted-17.png","hash":"bbcd99aad0b7a56282018978f9557c8aa1c7cfc6","modified":1554886874882},{"_id":"public/images/pasted-9.png","hash":"92fb7b9ed14256063d814aeb1c64417999d12529","modified":1554886874883},{"_id":"public/images/pasted-51.png","hash":"3cfc16acb4552defa33fc0d75fcfc7d6ad8bf991","modified":1554886874883},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1554886874883},{"_id":"public/js/motion.js","hash":"a16bc0b701646bf6653484675f4d5dc0f892d184","modified":1554886875098},{"_id":"public/js/utils.js","hash":"3c987de7cfb944c33e9e527f1214724c7aafc796","modified":1554886875099},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1554886875103},{"_id":"public/images/pasted-5.png","hash":"f3b4cea1946a8308ebd0a158fba6badd50b8e061","modified":1554886875161},{"_id":"public/images/pasted-57.png","hash":"4579bebdf9fff7ce70063012a5042d45d657e0c3","modified":1554886875161},{"_id":"public/images/pasted-59.png","hash":"0362818f13459539382e17dbeb4c89a5436aa2c1","modified":1554886875164},{"_id":"public/images/pasted-50.png","hash":"69eedb93a41e66286f300eb3e330b7ad54c7be63","modified":1554886875165},{"_id":"public/images/pasted-60.png","hash":"df2d739232ca94f0aadb66dcb0ee00c1354bdbdd","modified":1554886875166},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1554886875256},{"_id":"public/images/pasted-61.png","hash":"d0c99730ed8a3d141fcb016e5dea7509584497a7","modified":1554886875257},{"_id":"public/images/pasted-58.png","hash":"e83295ea073c15b6e07d66f853bbea4a0d679222","modified":1554886875260},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1554886875397},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1554886875397},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1554886875399},{"_id":"public/images/pasted-20.png","hash":"6853b316e1e526f9bb5805b3bdd2f0260d4f9fe3","modified":1554886876317},{"_id":"public/images/pasted-23.png","hash":"9c01c23fd815ffbd134add353fab53e9855254df","modified":1554886876381},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1554886876478},{"_id":"public/images/pasted-21.png","hash":"e31d7b92b0c58faeecdd44c8ad00eeb9a3783e53","modified":1554886876696},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1554886876732}],"Category":[{"name":"爱学爱问","_id":"cjuazhbm30005ysuv8t9smu3u"},{"name":"JVM","_id":"cjuazhbv20027ysuv54und1i9"},{"name":"外部引用","_id":"cjuazhclo004uysuvghmq6wqo"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到首页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到首页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","date":"2019-04-10T06:46:06.994Z","updated":"2019-04-10T06:46:06.985Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cjuazhaqw0000ysuvisokh04y","content":"<!DOCTYPE HTML>\n<html>\n<head><meta name=\"generator\" content=\"Hexo 3.8.0\">\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"回到首页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","site":{"data":{}},"excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head><meta name=\"generator\" content=\"Hexo 3.8.0\">\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"回到首页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>"},{"title":"about","date":"2019-04-10T06:21:37.000Z","type":"about","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-04-10 14:21:37\ntype: \"about\"\n---\n","updated":"2019-04-10T06:23:33.981Z","path":"about/index.html","comments":1,"layout":"page","_id":"cjuazhblh0002ysuvv3vr8nki","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"categories","date":"2019-04-08T09:39:57.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2019-04-08 17:39:57\ntype: \"categories\"\n---\n","updated":"2019-04-10T06:06:18.250Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cjuazhblx0004ysuv9t6axfth","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"schedule","date":"2019-04-10T06:22:00.000Z","type":"schedule","_content":"","source":"schedule/index.md","raw":"---\ntitle: schedule\ndate: 2019-04-10 14:22:00\ntype: \"schedule\"\n---\n","updated":"2019-04-10T06:24:15.658Z","path":"schedule/index.html","comments":1,"layout":"page","_id":"cjuazhbmq0008ysuvh35pydap","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","date":"2019-04-10T05:52:42.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2019-04-10 13:52:42\ntype: \"tags\"\n---\n","updated":"2019-04-10T06:06:00.031Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cjuazhbn6000aysuvnidapxqd","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"G1-Evacuation Failure","author":"Xiang Chuang","date":"2019-04-10T03:56:00.000Z","_content":"当没有更多的空闲region被提升到老一代或者复制到幸存空间时，并且由于堆已经达到最大值，堆不能扩展，从而发生Evacuation Failure。对于G1 GC，它是非常耗时的。 \n\n a.对于成功复制的对象，G1需要更新引用，并且该region被一直引用。\n\n b.对于未成功复制的对象，G1将自动转发它们，并保留这些region。\n\n解决方案：\n\n①.不要过度加一些jvm参数。比如-Xmn,这个参数会限制G1的参数的自动扩展。可以仅使用-Xms，-Xmx和暂停时间目标-XX：MaxGCPauseMillis，删除任何额外的堆大小，例如-Xmn，-XX：NewSize，-XX：MaxNewSize，-XX：SurvivorRatio等。\n\n②.如果问题仍然存在，则增加JVM堆大小（即-Xmx）。\n\n③.如果您无法增加堆大小，并且您注意到marking cycle没有足够早地开始回收老一代，那么请减少-XX：InitiatingHeapOccupancyPercent。默认值是45％。减小该值将提前开始marking cycle 。另一方面，如果marking cycle 提前开始并且未收回，请将-XX：InitiatingHeapOccupancyPercent阈值增加到默认值以上。\n\n④.如果并发marking cycle准时开始，但需要很长时间才能完成，那么使用属性'-XX：ConcGCThreads'增加并发标记线程数的数量。默认是GC Workers: 1 ，单线程执行。\n\n⑤.如果有大量“空间耗尽（to-space exhausted）”或“空间溢出（to-space overflow）”GC事件，则增加-XX:G1ReservePercent。默认值是Java堆的10％。注意：G1 GC将此值限制在50％以内。","source":"_posts/G1-Evacuation-Failure.md","raw":"title: G1-Evacuation Failure\nauthor: Xiang Chuang\ntags:\n  - GC-G1\n  - JVM\n  - GC\ncategories:\n  - 爱学爱问\ndate: 2019-04-10 11:56:00\n---\n当没有更多的空闲region被提升到老一代或者复制到幸存空间时，并且由于堆已经达到最大值，堆不能扩展，从而发生Evacuation Failure。对于G1 GC，它是非常耗时的。 \n\n a.对于成功复制的对象，G1需要更新引用，并且该region被一直引用。\n\n b.对于未成功复制的对象，G1将自动转发它们，并保留这些region。\n\n解决方案：\n\n①.不要过度加一些jvm参数。比如-Xmn,这个参数会限制G1的参数的自动扩展。可以仅使用-Xms，-Xmx和暂停时间目标-XX：MaxGCPauseMillis，删除任何额外的堆大小，例如-Xmn，-XX：NewSize，-XX：MaxNewSize，-XX：SurvivorRatio等。\n\n②.如果问题仍然存在，则增加JVM堆大小（即-Xmx）。\n\n③.如果您无法增加堆大小，并且您注意到marking cycle没有足够早地开始回收老一代，那么请减少-XX：InitiatingHeapOccupancyPercent。默认值是45％。减小该值将提前开始marking cycle 。另一方面，如果marking cycle 提前开始并且未收回，请将-XX：InitiatingHeapOccupancyPercent阈值增加到默认值以上。\n\n④.如果并发marking cycle准时开始，但需要很长时间才能完成，那么使用属性'-XX：ConcGCThreads'增加并发标记线程数的数量。默认是GC Workers: 1 ，单线程执行。\n\n⑤.如果有大量“空间耗尽（to-space exhausted）”或“空间溢出（to-space overflow）”GC事件，则增加-XX:G1ReservePercent。默认值是Java堆的10％。注意：G1 GC将此值限制在50％以内。","slug":"G1-Evacuation-Failure","published":1,"updated":"2019-04-10T06:27:51.170Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbkp0001ysuvuge6pv37","content":"<p>当没有更多的空闲region被提升到老一代或者复制到幸存空间时，并且由于堆已经达到最大值，堆不能扩展，从而发生Evacuation Failure。对于G1 GC，它是非常耗时的。 </p>\n<p> a.对于成功复制的对象，G1需要更新引用，并且该region被一直引用。</p>\n<p> b.对于未成功复制的对象，G1将自动转发它们，并保留这些region。</p>\n<p>解决方案：</p>\n<p>①.不要过度加一些jvm参数。比如-Xmn,这个参数会限制G1的参数的自动扩展。可以仅使用-Xms，-Xmx和暂停时间目标-XX：MaxGCPauseMillis，删除任何额外的堆大小，例如-Xmn，-XX：NewSize，-XX：MaxNewSize，-XX：SurvivorRatio等。</p>\n<p>②.如果问题仍然存在，则增加JVM堆大小（即-Xmx）。</p>\n<p>③.如果您无法增加堆大小，并且您注意到marking cycle没有足够早地开始回收老一代，那么请减少-XX：InitiatingHeapOccupancyPercent。默认值是45％。减小该值将提前开始marking cycle 。另一方面，如果marking cycle 提前开始并且未收回，请将-XX：InitiatingHeapOccupancyPercent阈值增加到默认值以上。</p>\n<p>④.如果并发marking cycle准时开始，但需要很长时间才能完成，那么使用属性’-XX：ConcGCThreads’增加并发标记线程数的数量。默认是GC Workers: 1 ，单线程执行。</p>\n<p>⑤.如果有大量“空间耗尽（to-space exhausted）”或“空间溢出（to-space overflow）”GC事件，则增加-XX:G1ReservePercent。默认值是Java堆的10％。注意：G1 GC将此值限制在50％以内。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>当没有更多的空闲region被提升到老一代或者复制到幸存空间时，并且由于堆已经达到最大值，堆不能扩展，从而发生Evacuation Failure。对于G1 GC，它是非常耗时的。 </p>\n<p> a.对于成功复制的对象，G1需要更新引用，并且该region被一直引用。</p>\n<p> b.对于未成功复制的对象，G1将自动转发它们，并保留这些region。</p>\n<p>解决方案：</p>\n<p>①.不要过度加一些jvm参数。比如-Xmn,这个参数会限制G1的参数的自动扩展。可以仅使用-Xms，-Xmx和暂停时间目标-XX：MaxGCPauseMillis，删除任何额外的堆大小，例如-Xmn，-XX：NewSize，-XX：MaxNewSize，-XX：SurvivorRatio等。</p>\n<p>②.如果问题仍然存在，则增加JVM堆大小（即-Xmx）。</p>\n<p>③.如果您无法增加堆大小，并且您注意到marking cycle没有足够早地开始回收老一代，那么请减少-XX：InitiatingHeapOccupancyPercent。默认值是45％。减小该值将提前开始marking cycle 。另一方面，如果marking cycle 提前开始并且未收回，请将-XX：InitiatingHeapOccupancyPercent阈值增加到默认值以上。</p>\n<p>④.如果并发marking cycle准时开始，但需要很长时间才能完成，那么使用属性’-XX：ConcGCThreads’增加并发标记线程数的数量。默认是GC Workers: 1 ，单线程执行。</p>\n<p>⑤.如果有大量“空间耗尽（to-space exhausted）”或“空间溢出（to-space overflow）”GC事件，则增加-XX:G1ReservePercent。默认值是Java堆的10％。注意：G1 GC将此值限制在50％以内。</p>\n"},{"title":"G1-Humongous Allocation","author":"Xiang Chuang","date":"2019-04-10T03:56:00.000Z","_content":"它是由'G1 Humongous Allocation'造成的。大型对象（Humongous ）是大于G1中region大小50％的对象。频繁大型对象分配会导致性能问题。如果region里面包含大量的大型对象，则该region中最后一个具有巨型对象的区域与区域末端之间的空间将不会使用。如果有多个这样的大型对象，这个未使用的空间可能导致堆碎片化。直到jdk1.8u40之前，这些巨型对象的回收只在full GC期间完成。在较新的JVM中，对这些对象的清理放在了清理阶段。\n\n解决方案：\n\n①.可以加大region的大小，设置-XX:G1HeapRegionSize=n，但是这个参数需要设置为2的幂次方，最小值是1M，最大值是32M。\n\n②.如果可以的话增加JVM堆大小（即-Xmx -Xms）。","source":"_posts/G1-Humongous-Allocation.md","raw":"title: G1-Humongous Allocation\nauthor: Xiang Chuang\ntags:\n  - GC-G1\n  - JVM\n  - GC\ncategories:\n  - 爱学爱问\ndate: 2019-04-10 11:56:00\n---\n它是由'G1 Humongous Allocation'造成的。大型对象（Humongous ）是大于G1中region大小50％的对象。频繁大型对象分配会导致性能问题。如果region里面包含大量的大型对象，则该region中最后一个具有巨型对象的区域与区域末端之间的空间将不会使用。如果有多个这样的大型对象，这个未使用的空间可能导致堆碎片化。直到jdk1.8u40之前，这些巨型对象的回收只在full GC期间完成。在较新的JVM中，对这些对象的清理放在了清理阶段。\n\n解决方案：\n\n①.可以加大region的大小，设置-XX:G1HeapRegionSize=n，但是这个参数需要设置为2的幂次方，最小值是1M，最大值是32M。\n\n②.如果可以的话增加JVM堆大小（即-Xmx -Xms）。","slug":"G1-Humongous-Allocation","published":1,"updated":"2019-04-10T06:27:33.093Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbls0003ysuv743w6f6q","content":"<p>它是由’G1 Humongous Allocation’造成的。大型对象（Humongous ）是大于G1中region大小50％的对象。频繁大型对象分配会导致性能问题。如果region里面包含大量的大型对象，则该region中最后一个具有巨型对象的区域与区域末端之间的空间将不会使用。如果有多个这样的大型对象，这个未使用的空间可能导致堆碎片化。直到jdk1.8u40之前，这些巨型对象的回收只在full GC期间完成。在较新的JVM中，对这些对象的清理放在了清理阶段。</p>\n<p>解决方案：</p>\n<p>①.可以加大region的大小，设置-XX:G1HeapRegionSize=n，但是这个参数需要设置为2的幂次方，最小值是1M，最大值是32M。</p>\n<p>②.如果可以的话增加JVM堆大小（即-Xmx -Xms）。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>它是由’G1 Humongous Allocation’造成的。大型对象（Humongous ）是大于G1中region大小50％的对象。频繁大型对象分配会导致性能问题。如果region里面包含大量的大型对象，则该region中最后一个具有巨型对象的区域与区域末端之间的空间将不会使用。如果有多个这样的大型对象，这个未使用的空间可能导致堆碎片化。直到jdk1.8u40之前，这些巨型对象的回收只在full GC期间完成。在较新的JVM中，对这些对象的清理放在了清理阶段。</p>\n<p>解决方案：</p>\n<p>①.可以加大region的大小，设置-XX:G1HeapRegionSize=n，但是这个参数需要设置为2的幂次方，最小值是1M，最大值是32M。</p>\n<p>②.如果可以的话增加JVM堆大小（即-Xmx -Xms）。</p>\n"},{"title":"G1- --xx:initiatingheapoccupancypercent变量之问","author":"Xiang Chuang","date":"2019-04-09T14:24:00.000Z","_content":"\n问题：该变量究竟何意？\n官方解释\n![upload successful](\\images\\pasted-0.png)\n\n疑问：整堆占用率，到底是老年代区域占用整堆比率还是所有区域占用整堆比率？\n个人认为应该是老年代占用区域\n原因：\n1、新生代默认比例为5-60%， 新生代的回收是使用殆尽时，那么，本文讨论的这个变量默认时45%，这两个是用一点冲突的\n2、工作内存调优时发现gc日志，报出占用率超过45%时，此时更像是老年代超过45%\n3、工作内存调优过程：\nmpay堆大小 1500多兆，堆内存使用率预警值90%  \na、最初时候出现预警时 堆内存占用率时 1500*60% + ？ = 1500M左右 即，差不多用光了； 时常预警\nb、后来调成 1500*25% + ？=1000M左右； 没有再预警\nc、再后来调成 1500*45% + ？ = 1350M左右 很少出现\n【？】处是老年代的占比，  如果用45%来计算，才能符合我们的现象。\n\na、 最初时候出现预警时 堆内存占用率时 1500*60% + 1500*45% ；\nb、后来调成 1500*25% + 1500*45%=975M ；\nc、再后来调成 1500*45% + 1500*45% = 1350M","source":"_posts/G1垃圾回收器-xx-initiatingheapoccupancypercent变量之问.md","raw":"title: 'G1- --xx:initiatingheapoccupancypercent变量之问'\nauthor: Xiang Chuang\ncategories:\n  - 爱学爱问\ntags:\n  - GC-G1\n  - JVM\n  - GC\ndate: 2019-04-09 22:24:00\n---\n\n问题：该变量究竟何意？\n官方解释\n![upload successful](\\images\\pasted-0.png)\n\n疑问：整堆占用率，到底是老年代区域占用整堆比率还是所有区域占用整堆比率？\n个人认为应该是老年代占用区域\n原因：\n1、新生代默认比例为5-60%， 新生代的回收是使用殆尽时，那么，本文讨论的这个变量默认时45%，这两个是用一点冲突的\n2、工作内存调优时发现gc日志，报出占用率超过45%时，此时更像是老年代超过45%\n3、工作内存调优过程：\nmpay堆大小 1500多兆，堆内存使用率预警值90%  \na、最初时候出现预警时 堆内存占用率时 1500*60% + ？ = 1500M左右 即，差不多用光了； 时常预警\nb、后来调成 1500*25% + ？=1000M左右； 没有再预警\nc、再后来调成 1500*45% + ？ = 1350M左右 很少出现\n【？】处是老年代的占比，  如果用45%来计算，才能符合我们的现象。\n\na、 最初时候出现预警时 堆内存占用率时 1500*60% + 1500*45% ；\nb、后来调成 1500*25% + 1500*45%=975M ；\nc、再后来调成 1500*45% + 1500*45% = 1350M","slug":"G1垃圾回收器-xx-initiatingheapoccupancypercent变量之问","published":1,"updated":"2019-04-10T06:28:28.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbmk0007ysuvfw2q13ao","content":"<p>问题：该变量究竟何意？<br>官方解释<br><img src=\"\\images\\pasted-0.png\" alt=\"upload successful\"></p>\n<p>疑问：整堆占用率，到底是老年代区域占用整堆比率还是所有区域占用整堆比率？<br>个人认为应该是老年代占用区域<br>原因：<br>1、新生代默认比例为5-60%， 新生代的回收是使用殆尽时，那么，本文讨论的这个变量默认时45%，这两个是用一点冲突的<br>2、工作内存调优时发现gc日志，报出占用率超过45%时，此时更像是老年代超过45%<br>3、工作内存调优过程：<br>mpay堆大小 1500多兆，堆内存使用率预警值90%<br>a、最初时候出现预警时 堆内存占用率时 1500<em>60% + ？ = 1500M左右 即，差不多用光了； 时常预警<br>b、后来调成 1500</em>25% + ？=1000M左右； 没有再预警<br>c、再后来调成 1500*45% + ？ = 1350M左右 很少出现<br>【？】处是老年代的占比，  如果用45%来计算，才能符合我们的现象。</p>\n<p>a、 最初时候出现预警时 堆内存占用率时 1500<em>60% + 1500</em>45% ；<br>b、后来调成 1500<em>25% + 1500</em>45%=975M ；<br>c、再后来调成 1500<em>45% + 1500</em>45% = 1350M</p>\n","site":{"data":{}},"excerpt":"","more":"<p>问题：该变量究竟何意？<br>官方解释<br><img src=\"\\images\\pasted-0.png\" alt=\"upload successful\"></p>\n<p>疑问：整堆占用率，到底是老年代区域占用整堆比率还是所有区域占用整堆比率？<br>个人认为应该是老年代占用区域<br>原因：<br>1、新生代默认比例为5-60%， 新生代的回收是使用殆尽时，那么，本文讨论的这个变量默认时45%，这两个是用一点冲突的<br>2、工作内存调优时发现gc日志，报出占用率超过45%时，此时更像是老年代超过45%<br>3、工作内存调优过程：<br>mpay堆大小 1500多兆，堆内存使用率预警值90%<br>a、最初时候出现预警时 堆内存占用率时 1500<em>60% + ？ = 1500M左右 即，差不多用光了； 时常预警<br>b、后来调成 1500</em>25% + ？=1000M左右； 没有再预警<br>c、再后来调成 1500*45% + ？ = 1350M左右 很少出现<br>【？】处是老年代的占比，  如果用45%来计算，才能符合我们的现象。</p>\n<p>a、 最初时候出现预警时 堆内存占用率时 1500<em>60% + 1500</em>45% ；<br>b、后来调成 1500<em>25% + 1500</em>45%=975M ；<br>c、再后来调成 1500<em>45% + 1500</em>45% = 1350M</p>\n"},{"title":"JVM-类加载","author":"Xiang Chuang","date":"2018-05-28T02:08:00.000Z","_content":"![upload successful](\\images\\pasted-50.png)\n\n\n![upload successful](\\images\\pasted-51.png)\n\n![upload successful](\\images\\pasted-52.png)\n\n![upload successful](\\images\\pasted-53.png)","source":"_posts/JVM-类加载.md","raw":"title: JVM-类加载\nauthor: Xiang Chuang\ntags:\n  - JVM\n  - 类加载\ncategories:\n  - 爱学爱问\ndate: 2018-05-28 10:08:00\n---\n![upload successful](\\images\\pasted-50.png)\n\n\n![upload successful](\\images\\pasted-51.png)\n\n![upload successful](\\images\\pasted-52.png)\n\n![upload successful](\\images\\pasted-53.png)","slug":"JVM-类加载","published":1,"updated":"2019-04-10T07:56:33.132Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbn20009ysuvot334u5l","content":"<p><img src=\"\\images\\pasted-50.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-51.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-52.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-53.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"\\images\\pasted-50.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-51.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-52.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-53.png\" alt=\"upload successful\"></p>\n"},{"title":"druid-filter","author":"Xiang Chuang","date":"2018-07-12T06:02:00.000Z","_content":"com.alibaba.druid.filter.Filter\n过滤器，对数据库操作做切面代理\n\norg.apache.ibatis.session.SqlSession\norg.mybatis.spring.SqlSessionTemplate#sqlSessionProxy\ncom.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3fadc0bd(DataSourceUtils.getConnection(this.dataSource);)\ncom.alibaba.druid.pool.DruidPooledPreparedStatement（createChain().preparedStatement_execute(this);）       \ncom.alibaba.druid.filter.FilterEventAdapter\ncom.yiji.common.ds.druid.YijiStatFilter（易极付实现）","source":"_posts/druid-filter.md","raw":"title: druid-filter\nauthor: Xiang Chuang\ntags:\n  - 数据库连接池\n  - db\n  - druid\ncategories:\n  - 爱学爱问\ndate: 2018-07-12 14:02:00\n---\ncom.alibaba.druid.filter.Filter\n过滤器，对数据库操作做切面代理\n\norg.apache.ibatis.session.SqlSession\norg.mybatis.spring.SqlSessionTemplate#sqlSessionProxy\ncom.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3fadc0bd(DataSourceUtils.getConnection(this.dataSource);)\ncom.alibaba.druid.pool.DruidPooledPreparedStatement（createChain().preparedStatement_execute(this);）       \ncom.alibaba.druid.filter.FilterEventAdapter\ncom.yiji.common.ds.druid.YijiStatFilter（易极付实现）","slug":"druid-filter","published":1,"updated":"2019-04-10T07:07:14.822Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbna000bysuvykwx6h4x","content":"<p>com.alibaba.druid.filter.Filter<br>过滤器，对数据库操作做切面代理</p>\n<p>org.apache.ibatis.session.SqlSession<br>org.mybatis.spring.SqlSessionTemplate#sqlSessionProxy<br>com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3fadc0bd(DataSourceUtils.getConnection(this.dataSource);)<br>com.alibaba.druid.pool.DruidPooledPreparedStatement（createChain().preparedStatement_execute(this);）<br>com.alibaba.druid.filter.FilterEventAdapter<br>com.yiji.common.ds.druid.YijiStatFilter（易极付实现）</p>\n","site":{"data":{}},"excerpt":"","more":"<p>com.alibaba.druid.filter.Filter<br>过滤器，对数据库操作做切面代理</p>\n<p>org.apache.ibatis.session.SqlSession<br>org.mybatis.spring.SqlSessionTemplate#sqlSessionProxy<br>com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@3fadc0bd(DataSourceUtils.getConnection(this.dataSource);)<br>com.alibaba.druid.pool.DruidPooledPreparedStatement（createChain().preparedStatement_execute(this);）<br>com.alibaba.druid.filter.FilterEventAdapter<br>com.yiji.common.ds.druid.YijiStatFilter（易极付实现）</p>\n"},{"title":"dubbo-反序列化问题","author":"Xiang Chuang","date":"2018-06-28T04:14:00.000Z","_content":"问题：网银充值，支付引擎调用清算调用网关，网关响应清算，清算响应支付引擎（支付引擎解析时出现反序列化异常）\n\n原因分析：清算配置了yiji.dubbo.provider.serialization=hessian3，即传输时使用hessian3序列化、反序列化\n，但是支付引擎使用的hessian2.  使用hessian2反序列化hessian3序列化出了问题\n\n但是清算反序列化网关为什么没有问题，  3反序列化2做了兼容？还是说，本身就是用的2反序列化2.  如果时2反序列化2，那么即使支付引擎配置成3，那岂不又成了2反序列化3？   所以应该是兼容吧！！！！","source":"_posts/dubbo-反序列化问题.md","raw":"title: dubbo-反序列化问题\nauthor: Xiang Chuang\ntags:\n  - dubbo\n  - 序列化\n  - hessian\ncategories:\n  - 爱学爱问\ndate: 2018-06-28 12:14:00\n---\n问题：网银充值，支付引擎调用清算调用网关，网关响应清算，清算响应支付引擎（支付引擎解析时出现反序列化异常）\n\n原因分析：清算配置了yiji.dubbo.provider.serialization=hessian3，即传输时使用hessian3序列化、反序列化\n，但是支付引擎使用的hessian2.  使用hessian2反序列化hessian3序列化出了问题\n\n但是清算反序列化网关为什么没有问题，  3反序列化2做了兼容？还是说，本身就是用的2反序列化2.  如果时2反序列化2，那么即使支付引擎配置成3，那岂不又成了2反序列化3？   所以应该是兼容吧！！！！","slug":"dubbo-反序列化问题","published":1,"updated":"2019-04-10T07:35:07.883Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbnr000eysuvr0xuu048","content":"<p>问题：网银充值，支付引擎调用清算调用网关，网关响应清算，清算响应支付引擎（支付引擎解析时出现反序列化异常）</p>\n<p>原因分析：清算配置了yiji.dubbo.provider.serialization=hessian3，即传输时使用hessian3序列化、反序列化<br>，但是支付引擎使用的hessian2.  使用hessian2反序列化hessian3序列化出了问题</p>\n<p>但是清算反序列化网关为什么没有问题，  3反序列化2做了兼容？还是说，本身就是用的2反序列化2.  如果时2反序列化2，那么即使支付引擎配置成3，那岂不又成了2反序列化3？   所以应该是兼容吧！！！！</p>\n","site":{"data":{}},"excerpt":"","more":"<p>问题：网银充值，支付引擎调用清算调用网关，网关响应清算，清算响应支付引擎（支付引擎解析时出现反序列化异常）</p>\n<p>原因分析：清算配置了yiji.dubbo.provider.serialization=hessian3，即传输时使用hessian3序列化、反序列化<br>，但是支付引擎使用的hessian2.  使用hessian2反序列化hessian3序列化出了问题</p>\n<p>但是清算反序列化网关为什么没有问题，  3反序列化2做了兼容？还是说，本身就是用的2反序列化2.  如果时2反序列化2，那么即使支付引擎配置成3，那岂不又成了2反序列化3？   所以应该是兼容吧！！！！</p>\n"},{"title":"dubbo-基于zookeeper的注册结构","author":"Xiang Chuang","date":"2019-03-07T07:25:00.000Z","_content":"\n![upload successful](\\images\\pasted-49.png)","source":"_posts/dubbo-基于zookeeper的注册结构.md","raw":"title: dubbo-基于zookeeper的注册结构\nauthor: Xiang Chuang\ntags:\n  - dubbo\n  - zookeeper\ncategories:\n  - 爱学爱问\ndate: 2019-03-07 15:25:00\n---\n\n![upload successful](\\images\\pasted-49.png)","slug":"dubbo-基于zookeeper的注册结构","published":1,"updated":"2019-04-10T07:50:18.262Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbnv000fysuvpbosc71l","content":"<p><img src=\"\\images\\pasted-49.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"\\images\\pasted-49.png\" alt=\"upload successful\"></p>\n"},{"title":"dubbo-（反）序列化","author":"Xiang Chuang","date":"2018-06-12T10:24:00.000Z","_content":"dubbo枚举（反）序列化使用的是：com.alibaba.com.caucho.hessian.io.EnumDeserializer\n根据枚举的name进行处理Enum.valueOf(Class, enumName);\n使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常\n\n注：\n1、rabbit mq序列化默认使用com.esotericsoftware.kryo.serializers.DefaultSerializers.EnumSerializer\nkyro按顺序处理\n使用时，必须保证序列化和反序列化时，枚举值的顺序是一致的，否则拿到错误的枚举值，同时可能出现下标越界\n\n2、com.alibaba.fastjson.JSON.parseObject.parseJSON使用com.alibaba.fastjson.parser.deserializer.EnumDeserializer\n根据枚举的name进行处理Enum.valueOf(Class, enumName);\n使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常","source":"_posts/dubbo-（反）序列化.md","raw":"title: dubbo-（反）序列化\nauthor: Xiang Chuang\ntags:\n  - dubbo\n  - 序列化\ncategories:\n  - 爱学爱问\ndate: 2018-06-12 18:24:00\n---\ndubbo枚举（反）序列化使用的是：com.alibaba.com.caucho.hessian.io.EnumDeserializer\n根据枚举的name进行处理Enum.valueOf(Class, enumName);\n使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常\n\n注：\n1、rabbit mq序列化默认使用com.esotericsoftware.kryo.serializers.DefaultSerializers.EnumSerializer\nkyro按顺序处理\n使用时，必须保证序列化和反序列化时，枚举值的顺序是一致的，否则拿到错误的枚举值，同时可能出现下标越界\n\n2、com.alibaba.fastjson.JSON.parseObject.parseJSON使用com.alibaba.fastjson.parser.deserializer.EnumDeserializer\n根据枚举的name进行处理Enum.valueOf(Class, enumName);\n使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常","slug":"dubbo-（反）序列化","published":1,"updated":"2019-04-10T07:08:48.561Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbo3000jysuvye5g00ng","content":"<p>dubbo枚举（反）序列化使用的是：com.alibaba.com.caucho.hessian.io.EnumDeserializer<br>根据枚举的name进行处理Enum.valueOf(Class, enumName);<br>使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常</p>\n<p>注：<br>1、rabbit mq序列化默认使用com.esotericsoftware.kryo.serializers.DefaultSerializers.EnumSerializer<br>kyro按顺序处理<br>使用时，必须保证序列化和反序列化时，枚举值的顺序是一致的，否则拿到错误的枚举值，同时可能出现下标越界</p>\n<p>2、com.alibaba.fastjson.JSON.parseObject.parseJSON使用com.alibaba.fastjson.parser.deserializer.EnumDeserializer<br>根据枚举的name进行处理Enum.valueOf(Class, enumName);<br>使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常</p>\n","site":{"data":{}},"excerpt":"","more":"<p>dubbo枚举（反）序列化使用的是：com.alibaba.com.caucho.hessian.io.EnumDeserializer<br>根据枚举的name进行处理Enum.valueOf(Class, enumName);<br>使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常</p>\n<p>注：<br>1、rabbit mq序列化默认使用com.esotericsoftware.kryo.serializers.DefaultSerializers.EnumSerializer<br>kyro按顺序处理<br>使用时，必须保证序列化和反序列化时，枚举值的顺序是一致的，否则拿到错误的枚举值，同时可能出现下标越界</p>\n<p>2、com.alibaba.fastjson.JSON.parseObject.parseJSON使用com.alibaba.fastjson.parser.deserializer.EnumDeserializer<br>根据枚举的name进行处理Enum.valueOf(Class, enumName);<br>使用时，只要保证当前应用有对应name的枚举值就能拿到，没有则抛异常</p>\n"},{"title":"elasticsearch-集群","author":"Xiang Chuang","date":"2017-09-27T08:02:00.000Z","_content":"ElasticSearch 的主旨是随时可用和按需扩容。 \n1、通过购买性能更强大（ 垂直扩容 ，或 纵向扩容） 扩容能力有限   \n2、数量更多的服务器（ 水平扩容 ，或 横向扩容 ） （elasticsearch天生分布式）     \n\n一个运行中的 Elasticsearch 实例称为一个 节点，而集群是由一个或者多个拥有相同 cluster.name 配置的节点组成， 它们共同承担数据和负载的压力。当有节点加入集群中或者从集群中移除节点时，集群将会重新平均分布所有的数据。\n\n主 节点： 负责管理集群范围内的所有变更（如增加、删除索引，或者增加、删除节点等），不需要涉及到文档级别的变更和搜索等操作，所以当集群只拥有一个主节点的情况下，即使流量的增加它也不会成为瓶颈。 任何节点都可以成为主节点。用户可以将请求发送到 集群中的任何节点 ，包括主节点。 每个节点都知道任意文档所处的位置，并且能够将我们的请求直接转发到存储我们所需文档的节点。 无论我们将请求发送到哪个节点，它都能负责从各个包含我们所需文档的节点收集回数据，并将最终结果返回給客户端。 Elasticsearch 对这一切的管理都是透明的。\n\n查询集群健康：GET /_cluster/health\nstatus\ngreen  所有的主分片和副本分片都正常运行。 \nyellow  所有的主分片都正常运行，但不是所有的副本分片都正常运行。 \nred  有主分片没能正常运行。\n\n索引实际上是指向一个或者多个物理 分片（仅保存了 全部数据中的一部分，一个分片是一个 Lucene 的实例） 的 逻辑命名空间 。\n初始化索引的分片（默认5个主分片）\nPUT /blogs\n{\n   \"settings\" : {\n      \"number_of_shards\" : 3,\n      \"number_of_replicas\" : 1\n   }\n}\n调整副分片大小\nPUT /blogs/_settings\n{\n   \"number_of_replicas\" : 2\n}","source":"_posts/elasticsearch-集群.md","raw":"title: elasticsearch-集群\nauthor: Xiang Chuang\ntags:\n  - elk\n  - 集群\ncategories:\n  - 爱学爱问\ndate: 2017-09-27 16:02:00\n---\nElasticSearch 的主旨是随时可用和按需扩容。 \n1、通过购买性能更强大（ 垂直扩容 ，或 纵向扩容） 扩容能力有限   \n2、数量更多的服务器（ 水平扩容 ，或 横向扩容 ） （elasticsearch天生分布式）     \n\n一个运行中的 Elasticsearch 实例称为一个 节点，而集群是由一个或者多个拥有相同 cluster.name 配置的节点组成， 它们共同承担数据和负载的压力。当有节点加入集群中或者从集群中移除节点时，集群将会重新平均分布所有的数据。\n\n主 节点： 负责管理集群范围内的所有变更（如增加、删除索引，或者增加、删除节点等），不需要涉及到文档级别的变更和搜索等操作，所以当集群只拥有一个主节点的情况下，即使流量的增加它也不会成为瓶颈。 任何节点都可以成为主节点。用户可以将请求发送到 集群中的任何节点 ，包括主节点。 每个节点都知道任意文档所处的位置，并且能够将我们的请求直接转发到存储我们所需文档的节点。 无论我们将请求发送到哪个节点，它都能负责从各个包含我们所需文档的节点收集回数据，并将最终结果返回給客户端。 Elasticsearch 对这一切的管理都是透明的。\n\n查询集群健康：GET /_cluster/health\nstatus\ngreen  所有的主分片和副本分片都正常运行。 \nyellow  所有的主分片都正常运行，但不是所有的副本分片都正常运行。 \nred  有主分片没能正常运行。\n\n索引实际上是指向一个或者多个物理 分片（仅保存了 全部数据中的一部分，一个分片是一个 Lucene 的实例） 的 逻辑命名空间 。\n初始化索引的分片（默认5个主分片）\nPUT /blogs\n{\n   \"settings\" : {\n      \"number_of_shards\" : 3,\n      \"number_of_replicas\" : 1\n   }\n}\n调整副分片大小\nPUT /blogs/_settings\n{\n   \"number_of_replicas\" : 2\n}","slug":"elasticsearch-集群","published":1,"updated":"2019-04-10T07:52:45.850Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhboc000lysuvjwu6mdza","content":"<p>ElasticSearch 的主旨是随时可用和按需扩容。<br>1、通过购买性能更强大（ 垂直扩容 ，或 纵向扩容） 扩容能力有限<br>2、数量更多的服务器（ 水平扩容 ，或 横向扩容 ） （elasticsearch天生分布式）     </p>\n<p>一个运行中的 Elasticsearch 实例称为一个 节点，而集群是由一个或者多个拥有相同 cluster.name 配置的节点组成， 它们共同承担数据和负载的压力。当有节点加入集群中或者从集群中移除节点时，集群将会重新平均分布所有的数据。</p>\n<p>主 节点： 负责管理集群范围内的所有变更（如增加、删除索引，或者增加、删除节点等），不需要涉及到文档级别的变更和搜索等操作，所以当集群只拥有一个主节点的情况下，即使流量的增加它也不会成为瓶颈。 任何节点都可以成为主节点。用户可以将请求发送到 集群中的任何节点 ，包括主节点。 每个节点都知道任意文档所处的位置，并且能够将我们的请求直接转发到存储我们所需文档的节点。 无论我们将请求发送到哪个节点，它都能负责从各个包含我们所需文档的节点收集回数据，并将最终结果返回給客户端。 Elasticsearch 对这一切的管理都是透明的。</p>\n<p>查询集群健康：GET /_cluster/health<br>status<br>green  所有的主分片和副本分片都正常运行。<br>yellow  所有的主分片都正常运行，但不是所有的副本分片都正常运行。<br>red  有主分片没能正常运行。</p>\n<p>索引实际上是指向一个或者多个物理 分片（仅保存了 全部数据中的一部分，一个分片是一个 Lucene 的实例） 的 逻辑命名空间 。<br>初始化索引的分片（默认5个主分片）<br>PUT /blogs<br>{<br>   “settings” : {<br>      “number_of_shards” : 3,<br>      “number_of_replicas” : 1<br>   }<br>}<br>调整副分片大小<br>PUT /blogs/_settings<br>{<br>   “number_of_replicas” : 2<br>}</p>\n","site":{"data":{}},"excerpt":"","more":"<p>ElasticSearch 的主旨是随时可用和按需扩容。<br>1、通过购买性能更强大（ 垂直扩容 ，或 纵向扩容） 扩容能力有限<br>2、数量更多的服务器（ 水平扩容 ，或 横向扩容 ） （elasticsearch天生分布式）     </p>\n<p>一个运行中的 Elasticsearch 实例称为一个 节点，而集群是由一个或者多个拥有相同 cluster.name 配置的节点组成， 它们共同承担数据和负载的压力。当有节点加入集群中或者从集群中移除节点时，集群将会重新平均分布所有的数据。</p>\n<p>主 节点： 负责管理集群范围内的所有变更（如增加、删除索引，或者增加、删除节点等），不需要涉及到文档级别的变更和搜索等操作，所以当集群只拥有一个主节点的情况下，即使流量的增加它也不会成为瓶颈。 任何节点都可以成为主节点。用户可以将请求发送到 集群中的任何节点 ，包括主节点。 每个节点都知道任意文档所处的位置，并且能够将我们的请求直接转发到存储我们所需文档的节点。 无论我们将请求发送到哪个节点，它都能负责从各个包含我们所需文档的节点收集回数据，并将最终结果返回給客户端。 Elasticsearch 对这一切的管理都是透明的。</p>\n<p>查询集群健康：GET /_cluster/health<br>status<br>green  所有的主分片和副本分片都正常运行。<br>yellow  所有的主分片都正常运行，但不是所有的副本分片都正常运行。<br>red  有主分片没能正常运行。</p>\n<p>索引实际上是指向一个或者多个物理 分片（仅保存了 全部数据中的一部分，一个分片是一个 Lucene 的实例） 的 逻辑命名空间 。<br>初始化索引的分片（默认5个主分片）<br>PUT /blogs<br>{<br>   “settings” : {<br>      “number_of_shards” : 3,<br>      “number_of_replicas” : 1<br>   }<br>}<br>调整副分片大小<br>PUT /blogs/_settings<br>{<br>   “number_of_replicas” : 2<br>}</p>\n"},{"title":"java-对象使用问题案例","author":"Xiang Chuang","date":"2018-08-06T09:23:00.000Z","_content":"关于java对象的使用，java编码的一个基本能力，但事实上，业务开发中，往往会有疏忽，下面从易极付支付引擎一个bug再次剖析java对象的使用。\n\n业务场景：支付引擎转账-定时任务批量加载挂起的数据执行转账并异步回执\n                1、批量查询挂起的转账数据，list\n                2、循环遍历list执行转换并回执\n                    2.1、将数据转换到业务上下文中\n                    2.2、执行转账（数据从业务上下文中获取）\n                    2.3、发布转账回执事件（数据从业务上下文中获取）\n                 3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）\n\n上述是简化后的业务流程，下面加以核心代码说明支付引擎的实现逻辑\n                1、批量查询挂起的转账数据，list \n              \n![upload successful](\\images\\pasted-24.png)\n\n![upload successful](\\images\\pasted-25.png)\n 2、循环遍历list执行转换并回执\n     2.1、将数据转换到业务上下文中\n     \n![upload successful](\\images\\pasted-26.png)\n\n![upload successful](\\images\\pasted-27.png)\n\n![upload successful](\\images\\pasted-28.png)\n这儿调用的是易极付common-util中提供的对象转换方法，源码如下：\n\n![upload successful](\\images\\pasted-30.png)\n\n![upload successful](\\images\\pasted-31.png)\n\n 2.2、执行转账（数据从业务上下文中获取）\n![upload successful](\\images\\pasted-32.png)\n\n2.3、发布转账回执事件（数据从业务上下文中获取）\n![upload successful](\\images\\pasted-33.png)\n\n![upload successful](\\images\\pasted-34.png)\n\n![upload successful](\\images\\pasted-35.png)\n\n![upload successful](\\images\\pasted-36.png)\n\n![upload successful](\\images\\pasted-37.png)\n\n3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）\n![upload successful](\\images\\pasted-38.png)\n\n上述逻辑，经过实际测试，存在严重问题，问题如下：\n异步回执时，拿到的数据并不是实际预期的数据，而被篡改了，可以看见的是，执行异步回执时，拿到了list循环遍历后续的数据。\n\n分析问题，很明显，我们看到了2.1这么一行代码：\n![upload successful](\\images\\pasted-39.png)\n那么，当前2.2转账完成后，发出2.3异步回执事件，3执行回执是异步的（并行的），此时下一次循环完全可能已经再次执行了2.1这行代码，那么就有问题！！！  为什么？\n\n上述判断只是初次分析，但经过进一步分析，我们发现其实3中的数据已经在2.3中将数据封装好，3只是从封装好的数据中取出相应的数据而已，2.3是同步执行过程，那么，下一次2.1执行时，一定是在上一次2.3执行完成之后！\n\n但是，经测试，这儿确实是有问题的，\n于是，再次分析：\n2.1进行数据转换时，通过源码分析，我们得出，此处只是将数据的值一个一个的set到业务上下文的数据对象中，那么意味着什么？  业务上下午serviceContext是一个全局对象，进入执行逻辑前已经初始化完成，那么，其内存已经开辟完成，意味着该对象中数据对象的内存也已开辟完成。那么，set值只是为那一块内存进行了赋值操作\n2.3通过getEntityObject将数据赋给新的对象I，那么，此时I和业务上下午中的数据对象都是指向同一块内存区域\n3/2.1 此时3和下一个2.1并行执行，3中获取数据对象的值，而1.2给上下文数据对象赋予新的值， 那么，3是从这块内存区域取值，1.2是给这块内存区域赋值，一旦1.2执行在前，那么3拿到的当然是重新赋予的值。\n\n通过上述分析，我们知道了问题根源，那么，如何改造？\n很简单\n修改2.1的代码为\n![upload successful](\\images\\pasted-40.png)\n\n![upload successful](\\images\\pasted-41.png)\n很显然，同样是给业务上下午数据对象赋值，与上面的方案区别在于，此处是将上下午数据对象指向的新的内存地址。\n那么执行2.3时，通过getEntityObject将数据赋给新的对象I，其所指向的内存地址也是这块新的地址\n执行3/2.1时，3依旧从这块内存地址取值，而2.1则是将上下午数据对象指向另一块内存地址，毫不冲突，更谈不上数据篡改。\n\n下面图示的方式给与说明：\n![upload successful](\\images\\pasted-42.png)\n","source":"_posts/java-对象使用问题案例.md","raw":"title: java-对象使用问题案例\nauthor: Xiang Chuang\ntags:\n  - java\n  - java对象\ncategories:\n  - 爱学爱问\ndate: 2018-08-06 17:23:00\n---\n关于java对象的使用，java编码的一个基本能力，但事实上，业务开发中，往往会有疏忽，下面从易极付支付引擎一个bug再次剖析java对象的使用。\n\n业务场景：支付引擎转账-定时任务批量加载挂起的数据执行转账并异步回执\n                1、批量查询挂起的转账数据，list\n                2、循环遍历list执行转换并回执\n                    2.1、将数据转换到业务上下文中\n                    2.2、执行转账（数据从业务上下文中获取）\n                    2.3、发布转账回执事件（数据从业务上下文中获取）\n                 3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）\n\n上述是简化后的业务流程，下面加以核心代码说明支付引擎的实现逻辑\n                1、批量查询挂起的转账数据，list \n              \n![upload successful](\\images\\pasted-24.png)\n\n![upload successful](\\images\\pasted-25.png)\n 2、循环遍历list执行转换并回执\n     2.1、将数据转换到业务上下文中\n     \n![upload successful](\\images\\pasted-26.png)\n\n![upload successful](\\images\\pasted-27.png)\n\n![upload successful](\\images\\pasted-28.png)\n这儿调用的是易极付common-util中提供的对象转换方法，源码如下：\n\n![upload successful](\\images\\pasted-30.png)\n\n![upload successful](\\images\\pasted-31.png)\n\n 2.2、执行转账（数据从业务上下文中获取）\n![upload successful](\\images\\pasted-32.png)\n\n2.3、发布转账回执事件（数据从业务上下文中获取）\n![upload successful](\\images\\pasted-33.png)\n\n![upload successful](\\images\\pasted-34.png)\n\n![upload successful](\\images\\pasted-35.png)\n\n![upload successful](\\images\\pasted-36.png)\n\n![upload successful](\\images\\pasted-37.png)\n\n3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）\n![upload successful](\\images\\pasted-38.png)\n\n上述逻辑，经过实际测试，存在严重问题，问题如下：\n异步回执时，拿到的数据并不是实际预期的数据，而被篡改了，可以看见的是，执行异步回执时，拿到了list循环遍历后续的数据。\n\n分析问题，很明显，我们看到了2.1这么一行代码：\n![upload successful](\\images\\pasted-39.png)\n那么，当前2.2转账完成后，发出2.3异步回执事件，3执行回执是异步的（并行的），此时下一次循环完全可能已经再次执行了2.1这行代码，那么就有问题！！！  为什么？\n\n上述判断只是初次分析，但经过进一步分析，我们发现其实3中的数据已经在2.3中将数据封装好，3只是从封装好的数据中取出相应的数据而已，2.3是同步执行过程，那么，下一次2.1执行时，一定是在上一次2.3执行完成之后！\n\n但是，经测试，这儿确实是有问题的，\n于是，再次分析：\n2.1进行数据转换时，通过源码分析，我们得出，此处只是将数据的值一个一个的set到业务上下文的数据对象中，那么意味着什么？  业务上下午serviceContext是一个全局对象，进入执行逻辑前已经初始化完成，那么，其内存已经开辟完成，意味着该对象中数据对象的内存也已开辟完成。那么，set值只是为那一块内存进行了赋值操作\n2.3通过getEntityObject将数据赋给新的对象I，那么，此时I和业务上下午中的数据对象都是指向同一块内存区域\n3/2.1 此时3和下一个2.1并行执行，3中获取数据对象的值，而1.2给上下文数据对象赋予新的值， 那么，3是从这块内存区域取值，1.2是给这块内存区域赋值，一旦1.2执行在前，那么3拿到的当然是重新赋予的值。\n\n通过上述分析，我们知道了问题根源，那么，如何改造？\n很简单\n修改2.1的代码为\n![upload successful](\\images\\pasted-40.png)\n\n![upload successful](\\images\\pasted-41.png)\n很显然，同样是给业务上下午数据对象赋值，与上面的方案区别在于，此处是将上下午数据对象指向的新的内存地址。\n那么执行2.3时，通过getEntityObject将数据赋给新的对象I，其所指向的内存地址也是这块新的地址\n执行3/2.1时，3依旧从这块内存地址取值，而2.1则是将上下午数据对象指向另一块内存地址，毫不冲突，更谈不上数据篡改。\n\n下面图示的方式给与说明：\n![upload successful](\\images\\pasted-42.png)\n","slug":"java-对象使用问题案例","published":1,"updated":"2019-04-10T07:29:56.740Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbok000oysuvcmuw1ojx","content":"<p>关于java对象的使用，java编码的一个基本能力，但事实上，业务开发中，往往会有疏忽，下面从易极付支付引擎一个bug再次剖析java对象的使用。</p>\n<p>业务场景：支付引擎转账-定时任务批量加载挂起的数据执行转账并异步回执<br>                1、批量查询挂起的转账数据，list<br>                2、循环遍历list执行转换并回执<br>                    2.1、将数据转换到业务上下文中<br>                    2.2、执行转账（数据从业务上下文中获取）<br>                    2.3、发布转账回执事件（数据从业务上下文中获取）<br>                 3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）</p>\n<p>上述是简化后的业务流程，下面加以核心代码说明支付引擎的实现逻辑<br>                1、批量查询挂起的转账数据，list </p>\n<p><img src=\"\\images\\pasted-24.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-25.png\" alt=\"upload successful\"><br> 2、循环遍历list执行转换并回执<br>     2.1、将数据转换到业务上下文中</p>\n<p><img src=\"\\images\\pasted-26.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-27.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-28.png\" alt=\"upload successful\"><br>这儿调用的是易极付common-util中提供的对象转换方法，源码如下：</p>\n<p><img src=\"\\images\\pasted-30.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-31.png\" alt=\"upload successful\"></p>\n<p> 2.2、执行转账（数据从业务上下文中获取）<br><img src=\"\\images\\pasted-32.png\" alt=\"upload successful\"></p>\n<p>2.3、发布转账回执事件（数据从业务上下文中获取）<br><img src=\"\\images\\pasted-33.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-34.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-35.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-36.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-37.png\" alt=\"upload successful\"></p>\n<p>3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）<br><img src=\"\\images\\pasted-38.png\" alt=\"upload successful\"></p>\n<p>上述逻辑，经过实际测试，存在严重问题，问题如下：<br>异步回执时，拿到的数据并不是实际预期的数据，而被篡改了，可以看见的是，执行异步回执时，拿到了list循环遍历后续的数据。</p>\n<p>分析问题，很明显，我们看到了2.1这么一行代码：<br><img src=\"\\images\\pasted-39.png\" alt=\"upload successful\"><br>那么，当前2.2转账完成后，发出2.3异步回执事件，3执行回执是异步的（并行的），此时下一次循环完全可能已经再次执行了2.1这行代码，那么就有问题！！！  为什么？</p>\n<p>上述判断只是初次分析，但经过进一步分析，我们发现其实3中的数据已经在2.3中将数据封装好，3只是从封装好的数据中取出相应的数据而已，2.3是同步执行过程，那么，下一次2.1执行时，一定是在上一次2.3执行完成之后！</p>\n<p>但是，经测试，这儿确实是有问题的，<br>于是，再次分析：<br>2.1进行数据转换时，通过源码分析，我们得出，此处只是将数据的值一个一个的set到业务上下文的数据对象中，那么意味着什么？  业务上下午serviceContext是一个全局对象，进入执行逻辑前已经初始化完成，那么，其内存已经开辟完成，意味着该对象中数据对象的内存也已开辟完成。那么，set值只是为那一块内存进行了赋值操作<br>2.3通过getEntityObject将数据赋给新的对象I，那么，此时I和业务上下午中的数据对象都是指向同一块内存区域<br>3/2.1 此时3和下一个2.1并行执行，3中获取数据对象的值，而1.2给上下文数据对象赋予新的值， 那么，3是从这块内存区域取值，1.2是给这块内存区域赋值，一旦1.2执行在前，那么3拿到的当然是重新赋予的值。</p>\n<p>通过上述分析，我们知道了问题根源，那么，如何改造？<br>很简单<br>修改2.1的代码为<br><img src=\"\\images\\pasted-40.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-41.png\" alt=\"upload successful\"><br>很显然，同样是给业务上下午数据对象赋值，与上面的方案区别在于，此处是将上下午数据对象指向的新的内存地址。<br>那么执行2.3时，通过getEntityObject将数据赋给新的对象I，其所指向的内存地址也是这块新的地址<br>执行3/2.1时，3依旧从这块内存地址取值，而2.1则是将上下午数据对象指向另一块内存地址，毫不冲突，更谈不上数据篡改。</p>\n<p>下面图示的方式给与说明：<br><img src=\"\\images\\pasted-42.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>关于java对象的使用，java编码的一个基本能力，但事实上，业务开发中，往往会有疏忽，下面从易极付支付引擎一个bug再次剖析java对象的使用。</p>\n<p>业务场景：支付引擎转账-定时任务批量加载挂起的数据执行转账并异步回执<br>                1、批量查询挂起的转账数据，list<br>                2、循环遍历list执行转换并回执<br>                    2.1、将数据转换到业务上下文中<br>                    2.2、执行转账（数据从业务上下文中获取）<br>                    2.3、发布转账回执事件（数据从业务上下文中获取）<br>                 3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）</p>\n<p>上述是简化后的业务流程，下面加以核心代码说明支付引擎的实现逻辑<br>                1、批量查询挂起的转账数据，list </p>\n<p><img src=\"\\images\\pasted-24.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-25.png\" alt=\"upload successful\"><br> 2、循环遍历list执行转换并回执<br>     2.1、将数据转换到业务上下文中</p>\n<p><img src=\"\\images\\pasted-26.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-27.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-28.png\" alt=\"upload successful\"><br>这儿调用的是易极付common-util中提供的对象转换方法，源码如下：</p>\n<p><img src=\"\\images\\pasted-30.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-31.png\" alt=\"upload successful\"></p>\n<p> 2.2、执行转账（数据从业务上下文中获取）<br><img src=\"\\images\\pasted-32.png\" alt=\"upload successful\"></p>\n<p>2.3、发布转账回执事件（数据从业务上下文中获取）<br><img src=\"\\images\\pasted-33.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-34.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-35.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-36.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-37.png\" alt=\"upload successful\"></p>\n<p>3、在新线程中异步回执（订阅到2.3发布的回执事件后与2并行执行）<br><img src=\"\\images\\pasted-38.png\" alt=\"upload successful\"></p>\n<p>上述逻辑，经过实际测试，存在严重问题，问题如下：<br>异步回执时，拿到的数据并不是实际预期的数据，而被篡改了，可以看见的是，执行异步回执时，拿到了list循环遍历后续的数据。</p>\n<p>分析问题，很明显，我们看到了2.1这么一行代码：<br><img src=\"\\images\\pasted-39.png\" alt=\"upload successful\"><br>那么，当前2.2转账完成后，发出2.3异步回执事件，3执行回执是异步的（并行的），此时下一次循环完全可能已经再次执行了2.1这行代码，那么就有问题！！！  为什么？</p>\n<p>上述判断只是初次分析，但经过进一步分析，我们发现其实3中的数据已经在2.3中将数据封装好，3只是从封装好的数据中取出相应的数据而已，2.3是同步执行过程，那么，下一次2.1执行时，一定是在上一次2.3执行完成之后！</p>\n<p>但是，经测试，这儿确实是有问题的，<br>于是，再次分析：<br>2.1进行数据转换时，通过源码分析，我们得出，此处只是将数据的值一个一个的set到业务上下文的数据对象中，那么意味着什么？  业务上下午serviceContext是一个全局对象，进入执行逻辑前已经初始化完成，那么，其内存已经开辟完成，意味着该对象中数据对象的内存也已开辟完成。那么，set值只是为那一块内存进行了赋值操作<br>2.3通过getEntityObject将数据赋给新的对象I，那么，此时I和业务上下午中的数据对象都是指向同一块内存区域<br>3/2.1 此时3和下一个2.1并行执行，3中获取数据对象的值，而1.2给上下文数据对象赋予新的值， 那么，3是从这块内存区域取值，1.2是给这块内存区域赋值，一旦1.2执行在前，那么3拿到的当然是重新赋予的值。</p>\n<p>通过上述分析，我们知道了问题根源，那么，如何改造？<br>很简单<br>修改2.1的代码为<br><img src=\"\\images\\pasted-40.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-41.png\" alt=\"upload successful\"><br>很显然，同样是给业务上下午数据对象赋值，与上面的方案区别在于，此处是将上下午数据对象指向的新的内存地址。<br>那么执行2.3时，通过getEntityObject将数据赋给新的对象I，其所指向的内存地址也是这块新的地址<br>执行3/2.1时，3依旧从这块内存地址取值，而2.1则是将上下午数据对象指向另一块内存地址，毫不冲突，更谈不上数据篡改。</p>\n<p>下面图示的方式给与说明：<br><img src=\"\\images\\pasted-42.png\" alt=\"upload successful\"></p>\n"},{"title":"jdk8-dump异常","author":"Xiang Chuang","date":"2018-09-10T02:36:00.000Z","_content":"![upload successful](\\images\\pasted-1.png)\n易极付代扣应用疑似存在内存泄漏，因此，尝试进行dump分析，后发现dump一直失败，报错如上，dump命令为：\n jmap -F -dump:format=b,file=盘符:/XXX.hprof <pid>\n\n原因分析：\nhttps://bugs.java.com/view_bug.do?bug_id=8044416\n\n\n\n解决方案： \n1、jmap -dump:format=b,file=盘符:/XXX.hprof <pid>，同时应用启动时，jvm参数-XX:+StartAttachListener\n    use flag -XX:+StartAttachListener in target java process and make sure you run jmap within the same user as main java process\n\n2、升级jdk版本到1.8.0_60以上8u60(Fixed)9b64(Fixed) ","source":"_posts/jdk8-dump异常.md","raw":"title: jdk8-dump异常\nauthor: Xiang Chuang\ntags:\n  - jdk8\n  - dump\n  - java\ncategories:\n  - 爱学爱问\ndate: 2018-09-10 10:36:00\n---\n![upload successful](\\images\\pasted-1.png)\n易极付代扣应用疑似存在内存泄漏，因此，尝试进行dump分析，后发现dump一直失败，报错如上，dump命令为：\n jmap -F -dump:format=b,file=盘符:/XXX.hprof <pid>\n\n原因分析：\nhttps://bugs.java.com/view_bug.do?bug_id=8044416\n\n\n\n解决方案： \n1、jmap -dump:format=b,file=盘符:/XXX.hprof <pid>，同时应用启动时，jvm参数-XX:+StartAttachListener\n    use flag -XX:+StartAttachListener in target java process and make sure you run jmap within the same user as main java process\n\n2、升级jdk版本到1.8.0_60以上8u60(Fixed)9b64(Fixed) ","slug":"jdk8-dump异常","published":1,"updated":"2019-04-10T06:40:27.923Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhboy000rysuvbwh68oy6","content":"<p><img src=\"\\images\\pasted-1.png\" alt=\"upload successful\"><br>易极付代扣应用疑似存在内存泄漏，因此，尝试进行dump分析，后发现dump一直失败，报错如上，dump命令为：<br> jmap -F -dump:format=b,file=盘符:/XXX.hprof <pid></pid></p>\n<p>原因分析：<br><a href=\"https://bugs.java.com/view_bug.do?bug_id=8044416\" target=\"_blank\" rel=\"noopener\">https://bugs.java.com/view_bug.do?bug_id=8044416</a></p>\n<p>解决方案：<br>1、jmap -dump:format=b,file=盘符:/XXX.hprof <pid>，同时应用启动时，jvm参数-XX:+StartAttachListener<br>    use flag -XX:+StartAttachListener in target java process and make sure you run jmap within the same user as main java process</pid></p>\n<p>2、升级jdk版本到1.8.0_60以上8u60(Fixed)9b64(Fixed) </p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"\\images\\pasted-1.png\" alt=\"upload successful\"><br>易极付代扣应用疑似存在内存泄漏，因此，尝试进行dump分析，后发现dump一直失败，报错如上，dump命令为：<br> jmap -F -dump:format=b,file=盘符:/XXX.hprof <pid></pid></p>\n<p>原因分析：<br><a href=\"https://bugs.java.com/view_bug.do?bug_id=8044416\" target=\"_blank\" rel=\"noopener\">https://bugs.java.com/view_bug.do?bug_id=8044416</a></p>\n<p>解决方案：<br>1、jmap -dump:format=b,file=盘符:/XXX.hprof <pid>，同时应用启动时，jvm参数-XX:+StartAttachListener<br>    use flag -XX:+StartAttachListener in target java process and make sure you run jmap within the same user as main java process</pid></p>\n<p>2、升级jdk版本到1.8.0_60以上8u60(Fixed)9b64(Fixed) </p>\n"},{"title":"linux-tail命令不生效","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"tail: option used in invalid context -- 1\n\n遇到此类命令使用不合法的警告时，可以which tail或者whereis tail 看看命令是否被使用了别名","source":"_posts/linux-tail命令不生效.md","raw":"title: linux-tail命令不生效\nauthor: Xiang Chuang\ntags:\n  - linux\n  - tail\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\ntail: option used in invalid context -- 1\n\n遇到此类命令使用不合法的警告时，可以which tail或者whereis tail 看看命令是否被使用了别名","slug":"linux-tail命令不生效","published":1,"updated":"2019-04-10T08:18:56.458Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbpi000vysuvntvtp9vh","content":"<p>tail: option used in invalid context – 1</p>\n<p>遇到此类命令使用不合法的警告时，可以which tail或者whereis tail 看看命令是否被使用了别名</p>\n","site":{"data":{}},"excerpt":"","more":"<p>tail: option used in invalid context – 1</p>\n<p>遇到此类命令使用不合法的警告时，可以which tail或者whereis tail 看看命令是否被使用了别名</p>\n"},{"title":"maven-Failed to execute goal org.apache.maven.plugins:maven-enforcer-plugin:","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"maven带的强制或者自定义得强制，导致打包不过。\n\ninfo：\n\nutil:jar:2.2.20150520\nFound Banned Dependency: org.slf4j:slf4j-log4j12:jar:1.7.10\nUse 'mvn dependency:tree' to locate the source of the banned dependencies.\n\n\n禁止依赖org.slf4j:slf4j-log4j12:jar，因此打包不过，需要排除依赖","source":"_posts/maven-Failed-to-execute-goal-org-apache-maven-plugins-maven-enforcer-plugin.md","raw":"title: 'maven-Failed to execute goal org.apache.maven.plugins:maven-enforcer-plugin:'\nauthor: Xiang Chuang\ntags:\n  - maven\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\nmaven带的强制或者自定义得强制，导致打包不过。\n\ninfo：\n\nutil:jar:2.2.20150520\nFound Banned Dependency: org.slf4j:slf4j-log4j12:jar:1.7.10\nUse 'mvn dependency:tree' to locate the source of the banned dependencies.\n\n\n禁止依赖org.slf4j:slf4j-log4j12:jar，因此打包不过，需要排除依赖","slug":"maven-Failed-to-execute-goal-org-apache-maven-plugins-maven-enforcer-plugin","published":1,"updated":"2019-04-10T08:18:56.497Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbpn000yysuvjvh9we88","content":"<p>maven带的强制或者自定义得强制，导致打包不过。</p>\n<p>info：</p>\n<p>util:jar:2.2.20150520<br>Found Banned Dependency: org.slf4j:slf4j-log4j12:jar:1.7.10<br>Use ‘mvn dependency:tree’ to locate the source of the banned dependencies.</p>\n<p>禁止依赖org.slf4j:slf4j-log4j12:jar，因此打包不过，需要排除依赖</p>\n","site":{"data":{}},"excerpt":"","more":"<p>maven带的强制或者自定义得强制，导致打包不过。</p>\n<p>info：</p>\n<p>util:jar:2.2.20150520<br>Found Banned Dependency: org.slf4j:slf4j-log4j12:jar:1.7.10<br>Use ‘mvn dependency:tree’ to locate the source of the banned dependencies.</p>\n<p>禁止依赖org.slf4j:slf4j-log4j12:jar，因此打包不过，需要排除依赖</p>\n"},{"title":"maven-No plugin found for prefix 'tomcat7'","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"没有tomcat7插件\n解决：在parent中\n\n <plugin>\n         <groupId>org.apache.tomcat.maven</groupId>\n         <artifactId>tomcat7-maven-plugin</artifactId>\n         <version>2.2</version>\n         <configuration>\n             <port>8091</port>\n             <uriEncoding>UTF-8</uriEncoding>\n             <path>/</path>\n         </configuration>\n       </plugin>","source":"_posts/maven-No-plugin-found-for-prefix-tomcat7.md","raw":"title: maven-No plugin found for prefix 'tomcat7'\nauthor: Xiang Chuang\ntags:\n  - maven\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\n没有tomcat7插件\n解决：在parent中\n\n <plugin>\n         <groupId>org.apache.tomcat.maven</groupId>\n         <artifactId>tomcat7-maven-plugin</artifactId>\n         <version>2.2</version>\n         <configuration>\n             <port>8091</port>\n             <uriEncoding>UTF-8</uriEncoding>\n             <path>/</path>\n         </configuration>\n       </plugin>","slug":"maven-No-plugin-found-for-prefix-tomcat7","published":1,"updated":"2019-04-10T08:18:56.384Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbpy0011ysuvxndbtmm7","content":"<p>没有tomcat7插件<br>解决：在parent中</p>\n <plugin><br>         <groupid>org.apache.tomcat.maven</groupid><br>         <artifactid>tomcat7-maven-plugin</artifactid><br>         <version>2.2</version><br>         <configuration><br>             <port>8091</port><br>             <uriencoding>UTF-8</uriencoding><br>             <path>/</path><br>         </configuration><br>       </plugin>","site":{"data":{}},"excerpt":"","more":"<p>没有tomcat7插件<br>解决：在parent中</p>\n <plugin><br>         <groupid>org.apache.tomcat.maven</groupid><br>         <artifactid>tomcat7-maven-plugin</artifactid><br>         <version>2.2</version><br>         <configuration><br>             <port>8091</port><br>             <uriencoding>UTF-8</uriencoding><br>             <path>/</path><br>         </configuration><br>       </plugin>"},{"title":"maven-Plugin execution not covered by lifecycle configuration","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"description:Project build lifecycle mapping can be configured in a project’s pom.xml, contributed by Eclipse plugins, or defaulted to the commonly used Maven plugins shipped with m2e. We call these “lifecycle mapping metadata sources”. m2e will create error marker like below for all plugin executions that do not have lifecycle mapping in any of the mapping metadata sources.\n\nM2Eclipse matches plugin executions to actions using combination of plugin groupId, artifactId, version range and goal. There are three basic actions that M2Eclipse can be instructed to do with a plugin execution – ignore, execute and delegate to a project configurator(recommended).","source":"_posts/maven-Plugin-execution-not-covered-by-lifecycle-configuration.md","raw":"title: maven-Plugin execution not covered by lifecycle configuration\nauthor: Xiang Chuang\ntags:\n  - maven\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\ndescription:Project build lifecycle mapping can be configured in a project’s pom.xml, contributed by Eclipse plugins, or defaulted to the commonly used Maven plugins shipped with m2e. We call these “lifecycle mapping metadata sources”. m2e will create error marker like below for all plugin executions that do not have lifecycle mapping in any of the mapping metadata sources.\n\nM2Eclipse matches plugin executions to actions using combination of plugin groupId, artifactId, version range and goal. There are three basic actions that M2Eclipse can be instructed to do with a plugin execution – ignore, execute and delegate to a project configurator(recommended).","slug":"maven-Plugin-execution-not-covered-by-lifecycle-configuration","published":1,"updated":"2019-04-10T08:18:56.404Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbq90013ysuv1oirpalb","content":"<p>description:Project build lifecycle mapping can be configured in a project’s pom.xml, contributed by Eclipse plugins, or defaulted to the commonly used Maven plugins shipped with m2e. We call these “lifecycle mapping metadata sources”. m2e will create error marker like below for all plugin executions that do not have lifecycle mapping in any of the mapping metadata sources.</p>\n<p>M2Eclipse matches plugin executions to actions using combination of plugin groupId, artifactId, version range and goal. There are three basic actions that M2Eclipse can be instructed to do with a plugin execution – ignore, execute and delegate to a project configurator(recommended).</p>\n","site":{"data":{}},"excerpt":"","more":"<p>description:Project build lifecycle mapping can be configured in a project’s pom.xml, contributed by Eclipse plugins, or defaulted to the commonly used Maven plugins shipped with m2e. We call these “lifecycle mapping metadata sources”. m2e will create error marker like below for all plugin executions that do not have lifecycle mapping in any of the mapping metadata sources.</p>\n<p>M2Eclipse matches plugin executions to actions using combination of plugin groupId, artifactId, version range and goal. There are three basic actions that M2Eclipse can be instructed to do with a plugin execution – ignore, execute and delegate to a project configurator(recommended).</p>\n"},{"title":"maven-默认jdk版本","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"修改maven默认的jdk版本，想改彻底需要在maven的全局配文件（settings.xml）增加以下信息：\n\n在profiles 节点下增加：\n\n![upload successful](\\images\\pasted-55.png)\n<profile>\n    <id>jdk-1.6</id>\n    <activation>\n        <activeByDefault>true</activeByDefault>\n        <jdk>1.6</jdk>\n    </activation>\n    <properties>\n        <maven.compiler.source>1.6</maven.compiler.source>\n        <maven.compiler.target>1.6</maven.compiler.target>\n        <maven.compiler.compilerVersion>1.6</maven.compiler.compilerVersion>\n    </properties>\n</profile> ","source":"_posts/maven-默认jdk版本.md","raw":"title: maven-默认jdk版本\nauthor: Xiang Chuang\ntags:\n  - maven\n  - jdk\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\n修改maven默认的jdk版本，想改彻底需要在maven的全局配文件（settings.xml）增加以下信息：\n\n在profiles 节点下增加：\n\n![upload successful](\\images\\pasted-55.png)\n<profile>\n    <id>jdk-1.6</id>\n    <activation>\n        <activeByDefault>true</activeByDefault>\n        <jdk>1.6</jdk>\n    </activation>\n    <properties>\n        <maven.compiler.source>1.6</maven.compiler.source>\n        <maven.compiler.target>1.6</maven.compiler.target>\n        <maven.compiler.compilerVersion>1.6</maven.compiler.compilerVersion>\n    </properties>\n</profile> ","slug":"maven-默认jdk版本","published":1,"updated":"2019-04-10T08:18:56.364Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbqh0016ysuvb9q2kapg","content":"<p>修改maven默认的jdk版本，想改彻底需要在maven的全局配文件（settings.xml）增加以下信息：</p>\n<p>在profiles 节点下增加：</p>\n<p><img src=\"\\images\\pasted-55.png\" alt=\"upload successful\"></p>\n<profile><br>    <id>jdk-1.6</id><br>    <activation><br>        <activebydefault>true</activebydefault><br>        <jdk>1.6</jdk><br>    </activation><br>    <properties><br>        &lt;maven.compiler.source&gt;1.6&lt;/maven.compiler.source&gt;<br>        &lt;maven.compiler.target&gt;1.6&lt;/maven.compiler.target&gt;<br>        &lt;maven.compiler.compilerVersion&gt;1.6&lt;/maven.compiler.compilerVersion&gt;<br>    </properties><br></profile> ","site":{"data":{}},"excerpt":"","more":"<p>修改maven默认的jdk版本，想改彻底需要在maven的全局配文件（settings.xml）增加以下信息：</p>\n<p>在profiles 节点下增加：</p>\n<p><img src=\"\\images\\pasted-55.png\" alt=\"upload successful\"></p>\n<profile><br>    <id>jdk-1.6</id><br>    <activation><br>        <activebydefault>true</activebydefault><br>        <jdk>1.6</jdk><br>    </activation><br>    <properties><br>        &lt;maven.compiler.source&gt;1.6&lt;/maven.compiler.source&gt;<br>        &lt;maven.compiler.target&gt;1.6&lt;/maven.compiler.target&gt;<br>        &lt;maven.compiler.compilerVersion&gt;1.6&lt;/maven.compiler.compilerVersion&gt;<br>    </properties><br></profile> "},{"title":"mysql -TIMESTAMP","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"The TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of '1970-01-01 00:00:01' UTC to '2038-01-19 03:14:07' UTCThe TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of '1970-01-01 00:00:01' UTC to '2038-01-19 03:14:07' UTC\n\n\nUTC+8: 2038-01-19 11:14:07","source":"_posts/mysql-TIMESTAMP.md","raw":"title: mysql -TIMESTAMP\nauthor: Xiang Chuang\ntags:\n  - mysql\n  - db\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\nThe TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of '1970-01-01 00:00:01' UTC to '2038-01-19 03:14:07' UTCThe TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of '1970-01-01 00:00:01' UTC to '2038-01-19 03:14:07' UTC\n\n\nUTC+8: 2038-01-19 11:14:07","slug":"mysql-TIMESTAMP","published":1,"updated":"2019-04-10T08:18:56.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbql0019ysuvglwfd6mo","content":"<p>The TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of ‘1970-01-01 00:00:01’ UTC to ‘2038-01-19 03:14:07’ UTCThe TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of ‘1970-01-01 00:00:01’ UTC to ‘2038-01-19 03:14:07’ UTC</p>\n<p>UTC+8: 2038-01-19 11:14:07</p>\n","site":{"data":{}},"excerpt":"","more":"<p>The TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of ‘1970-01-01 00:00:01’ UTC to ‘2038-01-19 03:14:07’ UTCThe TIMESTAMP data type is used for values that contain both date and time parts. TIMESTAMP has a range of ‘1970-01-01 00:00:01’ UTC to ‘2038-01-19 03:14:07’ UTC</p>\n<p>UTC+8: 2038-01-19 11:14:07</p>\n"},{"title":"mongo-查询报no property found on","author":"Xiang Chuang","date":"2018-12-07T07:11:20.000Z","_content":"No property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!\n\n现象：线上和本地都没问题，同样的应用同样的数据，就测试环境有问题\n\n\n如果有自定义转换器走这，没得 就会默认\n\n![upload successful](\\images\\pasted-6.png)\n\n![upload successful](\\images\\pasted-7.png)\n加载构造函数，这里是通过java8新特性，直接获取到了构造函数的入参名称，然后以此为key获取mongo集合对应的值\n![upload successful](\\images\\pasted-8.png)\n\n![upload successful](\\images\\pasted-9.png)\n\n![upload successful](\\images\\pasted-10.png)\n\n![upload successful](\\images\\pasted-11.png)\n根据构造函数的入参获取mongo查出来的值，问题出在constructor.getParameters()获取入参时候， 取得了一个null\n\n![upload successful](\\images\\pasted-12.png)\n\nNo property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!\n\n问题在于：\n测试环境apm启动时，使用了javaagent代理，代理本身就是apm的，里面也有com.yiji.dtrace.core.SpanId，因此出现了冲突！！！！！\n\njava8通过以下类提供了反射获取方法参数名成的能力\n\n![upload successful](\\images\\pasted-14.png)\n\n![upload successful](\\images\\pasted-15.png)","source":"_posts/mongo-查询报no-property-found-on.md","raw":"title: mongo-查询报no property found on\nauthor: Xiang Chuang\ntags:\n  - mongo\n  - db\ncategories:\n  - 爱学爱问\ndate: 2018-12-07 15:11:20\n---\nNo property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!\n\n现象：线上和本地都没问题，同样的应用同样的数据，就测试环境有问题\n\n\n如果有自定义转换器走这，没得 就会默认\n\n![upload successful](\\images\\pasted-6.png)\n\n![upload successful](\\images\\pasted-7.png)\n加载构造函数，这里是通过java8新特性，直接获取到了构造函数的入参名称，然后以此为key获取mongo集合对应的值\n![upload successful](\\images\\pasted-8.png)\n\n![upload successful](\\images\\pasted-9.png)\n\n![upload successful](\\images\\pasted-10.png)\n\n![upload successful](\\images\\pasted-11.png)\n根据构造函数的入参获取mongo查出来的值，问题出在constructor.getParameters()获取入参时候， 取得了一个null\n\n![upload successful](\\images\\pasted-12.png)\n\nNo property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!\n\n问题在于：\n测试环境apm启动时，使用了javaagent代理，代理本身就是apm的，里面也有com.yiji.dtrace.core.SpanId，因此出现了冲突！！！！！\n\njava8通过以下类提供了反射获取方法参数名成的能力\n\n![upload successful](\\images\\pasted-14.png)\n\n![upload successful](\\images\\pasted-15.png)","slug":"mongo-查询报no-property-found-on","published":1,"updated":"2019-04-10T06:59:56.322Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbr5001dysuvb8zdh9jm","content":"<p>No property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!</p>\n<p>现象：线上和本地都没问题，同样的应用同样的数据，就测试环境有问题</p>\n<p>如果有自定义转换器走这，没得 就会默认</p>\n<p><img src=\"\\images\\pasted-6.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-7.png\" alt=\"upload successful\"><br>加载构造函数，这里是通过java8新特性，直接获取到了构造函数的入参名称，然后以此为key获取mongo集合对应的值<br><img src=\"\\images\\pasted-8.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-9.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-10.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-11.png\" alt=\"upload successful\"><br>根据构造函数的入参获取mongo查出来的值，问题出在constructor.getParameters()获取入参时候， 取得了一个null</p>\n<p><img src=\"\\images\\pasted-12.png\" alt=\"upload successful\"></p>\n<p>No property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!</p>\n<p>问题在于：<br>测试环境apm启动时，使用了javaagent代理，代理本身就是apm的，里面也有com.yiji.dtrace.core.SpanId，因此出现了冲突！！！！！</p>\n<p>java8通过以下类提供了反射获取方法参数名成的能力</p>\n<p><img src=\"\\images\\pasted-14.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-15.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>No property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!</p>\n<p>现象：线上和本地都没问题，同样的应用同样的数据，就测试环境有问题</p>\n<p>如果有自定义转换器走这，没得 就会默认</p>\n<p><img src=\"\\images\\pasted-6.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-7.png\" alt=\"upload successful\"><br>加载构造函数，这里是通过java8新特性，直接获取到了构造函数的入参名称，然后以此为key获取mongo集合对应的值<br><img src=\"\\images\\pasted-8.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-9.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-10.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-11.png\" alt=\"upload successful\"><br>根据构造函数的入参获取mongo查出来的值，问题出在constructor.getParameters()获取入参时候， 取得了一个null</p>\n<p><img src=\"\\images\\pasted-12.png\" alt=\"upload successful\"></p>\n<p>No property null found on entity com.yiji.dtrace.core.SpanId to bind constructor parameter to!</p>\n<p>问题在于：<br>测试环境apm启动时，使用了javaagent代理，代理本身就是apm的，里面也有com.yiji.dtrace.core.SpanId，因此出现了冲突！！！！！</p>\n<p>java8通过以下类提供了反射获取方法参数名成的能力</p>\n<p><img src=\"\\images\\pasted-14.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-15.png\" alt=\"upload successful\"></p>\n"},{"title":"rabbitmq-报not equivalent错","author":"Xiang Chuang","date":"2018-07-19T09:28:00.000Z","_content":"问题：\n支付引擎往monitor发送监控mq消息时，报错：\n2018-07-19 15:54:35.423 ERROR [AMQP Connection 10.21.30.153:5672] CachingConnectionFactory-- Channel shutdown: channel error; protocol method: #method<channel.close>(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue 'queue.monitor.logmsg' in vhost '/' not equivalent, class-id=50, method-id=10)\nCaused by: com.rabbitmq.client.ShutdownSignalException: channel error; protocol method: #method<channel.close>(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue 'queue.monitor.logmsg' in vhost '/' not equivalent, class-id=50, method-id=10)\n\n原因：\n支付引擎使用monitor客户端发送mq消息，由如下逻辑：\n![upload successful](\\images\\pasted-43.png)\n\n![upload successful](\\images\\pasted-44.png)\n\n![upload successful](\\images\\pasted-45.png)\n\n![upload successful](\\images\\pasted-46.png)\n问题出在：new Queue(XXX);\n我们来看看参数：true、false、false。  但是mq服务器上当前的队列是monitor系统通过spring集成创建的，参数为：\nfalse、false、true  同样的队列名，参数不一致，mq会报上述错误\n![upload successful](\\images\\pasted-47.png)\n\n![upload successful](\\images\\pasted-48.png)\n解决方案：\n合理的方案：保持参数一致\n临时方案：停止monitor，这是队列自动删除了，启动支付引擎，创建队列，再启动monitor，因为monitor是采用spring方式创建队列，不会尝试重新创建","source":"_posts/rabbitmq-报not-equivalent错.md","raw":"title: rabbitmq-报not equivalent错\nauthor: Xiang Chuang\ntags:\n  - rabbitmq\n  - 消息队列\ncategories:\n  - 爱学爱问\ndate: 2018-07-19 17:28:00\n---\n问题：\n支付引擎往monitor发送监控mq消息时，报错：\n2018-07-19 15:54:35.423 ERROR [AMQP Connection 10.21.30.153:5672] CachingConnectionFactory-- Channel shutdown: channel error; protocol method: #method<channel.close>(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue 'queue.monitor.logmsg' in vhost '/' not equivalent, class-id=50, method-id=10)\nCaused by: com.rabbitmq.client.ShutdownSignalException: channel error; protocol method: #method<channel.close>(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue 'queue.monitor.logmsg' in vhost '/' not equivalent, class-id=50, method-id=10)\n\n原因：\n支付引擎使用monitor客户端发送mq消息，由如下逻辑：\n![upload successful](\\images\\pasted-43.png)\n\n![upload successful](\\images\\pasted-44.png)\n\n![upload successful](\\images\\pasted-45.png)\n\n![upload successful](\\images\\pasted-46.png)\n问题出在：new Queue(XXX);\n我们来看看参数：true、false、false。  但是mq服务器上当前的队列是monitor系统通过spring集成创建的，参数为：\nfalse、false、true  同样的队列名，参数不一致，mq会报上述错误\n![upload successful](\\images\\pasted-47.png)\n\n![upload successful](\\images\\pasted-48.png)\n解决方案：\n合理的方案：保持参数一致\n临时方案：停止monitor，这是队列自动删除了，启动支付引擎，创建队列，再启动monitor，因为monitor是采用spring方式创建队列，不会尝试重新创建","slug":"rabbitmq-报not-equivalent错","published":1,"updated":"2019-04-10T07:33:51.156Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbrf001gysuvib29m9em","content":"<p>问题：<br>支付引擎往monitor发送监控mq消息时，报错：<br>2018-07-19 15:54:35.423 ERROR [AMQP Connection 10.21.30.153:5672] CachingConnectionFactory– Channel shutdown: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue ‘queue.monitor.logmsg’ in vhost ‘/‘ not equivalent, class-id=50, method-id=10)<br>Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue ‘queue.monitor.logmsg’ in vhost ‘/‘ not equivalent, class-id=50, method-id=10)</p>\n<p>原因：<br>支付引擎使用monitor客户端发送mq消息，由如下逻辑：<br><img src=\"\\images\\pasted-43.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-44.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-45.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-46.png\" alt=\"upload successful\"><br>问题出在：new Queue(XXX);<br>我们来看看参数：true、false、false。  但是mq服务器上当前的队列是monitor系统通过spring集成创建的，参数为：<br>false、false、true  同样的队列名，参数不一致，mq会报上述错误<br><img src=\"\\images\\pasted-47.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-48.png\" alt=\"upload successful\"><br>解决方案：<br>合理的方案：保持参数一致<br>临时方案：停止monitor，这是队列自动删除了，启动支付引擎，创建队列，再启动monitor，因为monitor是采用spring方式创建队列，不会尝试重新创建</p>\n","site":{"data":{}},"excerpt":"","more":"<p>问题：<br>支付引擎往monitor发送监控mq消息时，报错：<br>2018-07-19 15:54:35.423 ERROR [AMQP Connection 10.21.30.153:5672] CachingConnectionFactory– Channel shutdown: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue ‘queue.monitor.logmsg’ in vhost ‘/‘ not equivalent, class-id=50, method-id=10)<br>Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=406, reply-text=PRECONDITION_FAILED - parameters for queue ‘queue.monitor.logmsg’ in vhost ‘/‘ not equivalent, class-id=50, method-id=10)</p>\n<p>原因：<br>支付引擎使用monitor客户端发送mq消息，由如下逻辑：<br><img src=\"\\images\\pasted-43.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-44.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-45.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-46.png\" alt=\"upload successful\"><br>问题出在：new Queue(XXX);<br>我们来看看参数：true、false、false。  但是mq服务器上当前的队列是monitor系统通过spring集成创建的，参数为：<br>false、false、true  同样的队列名，参数不一致，mq会报上述错误<br><img src=\"\\images\\pasted-47.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-48.png\" alt=\"upload successful\"><br>解决方案：<br>合理的方案：保持参数一致<br>临时方案：停止monitor，这是队列自动删除了，启动支付引擎，创建队列，再启动monitor，因为monitor是采用spring方式创建队列，不会尝试重新创建</p>\n"},{"title":"struts2-no action in maven","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"原因：convention插件默认不扫描jar中的action\n 解决方案：http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)\n    <!-- the jar URL can contain a path to the jar file and a trailing \"!/\" -->\n    <constant name=\"struts.convention.action.includeJars\" value=\".*?/Imanage\\w*.*?jar(!/)?\"/>  匹配 前缀为Imanage的所有jar\n    \n![upload successful](\\images\\pasted-56.png)","source":"_posts/struts2-no-action-in-maven.md","raw":"title: struts2-no action in maven\nauthor: Xiang Chuang\ntags:\n  - struts2\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\n原因：convention插件默认不扫描jar中的action\n 解决方案：http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)\n    <!-- the jar URL can contain a path to the jar file and a trailing \"!/\" -->\n    <constant name=\"struts.convention.action.includeJars\" value=\".*?/Imanage\\w*.*?jar(!/)?\"/>  匹配 前缀为Imanage的所有jar\n    \n![upload successful](\\images\\pasted-56.png)","slug":"struts2-no-action-in-maven","published":1,"updated":"2019-04-10T08:18:56.479Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbru001jysuv3zr4zlp1","content":"<p>原因：convention插件默认不扫描jar中的action<br> 解决方案：<a href=\"http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)\" target=\"_blank\" rel=\"noopener\">http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)</a><br>    <!-- the jar URL can contain a path to the jar file and a trailing \"!/\" --><br>    <constant name=\"struts.convention.action.includeJars\" value=\".*?/Imanage\\w*.*?jar(!/)?\">  匹配 前缀为Imanage的所有jar</constant></p>\n<p><img src=\"\\images\\pasted-56.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>原因：convention插件默认不扫描jar中的action<br> 解决方案：<a href=\"http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)\" target=\"_blank\" rel=\"noopener\">http://struts.apache.org/release/2.3.x/docs/convention-plugin.html#ConventionPlugin-Actionsinjarfiles(struts2convention插件说明)</a><br>    <!-- the jar URL can contain a path to the jar file and a trailing \"!/\" --><br>    <constant name=\"struts.convention.action.includeJars\" value=\".*?/Imanage\\w*.*?jar(!/)?\">  匹配 前缀为Imanage的所有jar</constant></p>\n<p><img src=\"\\images\\pasted-56.png\" alt=\"upload successful\"></p>\n"},{"title":"springboot-spring-boot-starter-actuator","author":"Xiang Chuang","date":"2018-07-12T08:03:00.000Z","_content":"应用监控管理\n自定义健康检测器，实现org.springframework.boot.actuate.health.AbstractHealthIndicator\n充分利用java.lang.management.ManagementFactory，获取系统资源情况\n\n易极付：\n基于spring-boot的应用健康监控：\ndubboHealthIndicator      dubbo健康检查\ndeadlockedThreadsHealthIndicator  死锁线程检查\nthreadsCountHealthIndicator 线程数量检查，阈值2000\nsystemLoadHealthIndicator cpu负载检查，阈值1/3\nrabbitHealthIndicator rabbitmq可用性检查\nsessionYedisHealthIndicator  sessionRedis可用性检查\ntomcatHealthIndicator 线程占用数量 阈值1半，   tomcat默认最大线程400\nyedisHealthIndicator redis可用性检查\ndiskSpaceHealthIndicator 硬盘空间检查 阈值management.health.diskspace.threshold=524288000\ndataSourceHealthIndicator  使用select 1检查连接 （spring-boot提供）\n\n![upload successful](\\images\\pasted-17.png)","source":"_posts/springboot-spring-boot-starter-actuator.md","raw":"title: springboot-spring-boot-starter-actuator\nauthor: Xiang Chuang\ntags:\n  - spring\n  - springboot\n  - 应用监控检查\ncategories:\n  - 爱学爱问\ndate: 2018-07-12 16:03:00\n---\n应用监控管理\n自定义健康检测器，实现org.springframework.boot.actuate.health.AbstractHealthIndicator\n充分利用java.lang.management.ManagementFactory，获取系统资源情况\n\n易极付：\n基于spring-boot的应用健康监控：\ndubboHealthIndicator      dubbo健康检查\ndeadlockedThreadsHealthIndicator  死锁线程检查\nthreadsCountHealthIndicator 线程数量检查，阈值2000\nsystemLoadHealthIndicator cpu负载检查，阈值1/3\nrabbitHealthIndicator rabbitmq可用性检查\nsessionYedisHealthIndicator  sessionRedis可用性检查\ntomcatHealthIndicator 线程占用数量 阈值1半，   tomcat默认最大线程400\nyedisHealthIndicator redis可用性检查\ndiskSpaceHealthIndicator 硬盘空间检查 阈值management.health.diskspace.threshold=524288000\ndataSourceHealthIndicator  使用select 1检查连接 （spring-boot提供）\n\n![upload successful](\\images\\pasted-17.png)","slug":"springboot-spring-boot-starter-actuator","published":1,"updated":"2019-04-10T07:44:39.674Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbry001lysuvss2f4a05","content":"<p>应用监控管理<br>自定义健康检测器，实现org.springframework.boot.actuate.health.AbstractHealthIndicator<br>充分利用java.lang.management.ManagementFactory，获取系统资源情况</p>\n<p>易极付：<br>基于spring-boot的应用健康监控：<br>dubboHealthIndicator      dubbo健康检查<br>deadlockedThreadsHealthIndicator  死锁线程检查<br>threadsCountHealthIndicator 线程数量检查，阈值2000<br>systemLoadHealthIndicator cpu负载检查，阈值1/3<br>rabbitHealthIndicator rabbitmq可用性检查<br>sessionYedisHealthIndicator  sessionRedis可用性检查<br>tomcatHealthIndicator 线程占用数量 阈值1半，   tomcat默认最大线程400<br>yedisHealthIndicator redis可用性检查<br>diskSpaceHealthIndicator 硬盘空间检查 阈值management.health.diskspace.threshold=524288000<br>dataSourceHealthIndicator  使用select 1检查连接 （spring-boot提供）</p>\n<p><img src=\"\\images\\pasted-17.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>应用监控管理<br>自定义健康检测器，实现org.springframework.boot.actuate.health.AbstractHealthIndicator<br>充分利用java.lang.management.ManagementFactory，获取系统资源情况</p>\n<p>易极付：<br>基于spring-boot的应用健康监控：<br>dubboHealthIndicator      dubbo健康检查<br>deadlockedThreadsHealthIndicator  死锁线程检查<br>threadsCountHealthIndicator 线程数量检查，阈值2000<br>systemLoadHealthIndicator cpu负载检查，阈值1/3<br>rabbitHealthIndicator rabbitmq可用性检查<br>sessionYedisHealthIndicator  sessionRedis可用性检查<br>tomcatHealthIndicator 线程占用数量 阈值1半，   tomcat默认最大线程400<br>yedisHealthIndicator redis可用性检查<br>diskSpaceHealthIndicator 硬盘空间检查 阈值management.health.diskspace.threshold=524288000<br>dataSourceHealthIndicator  使用select 1检查连接 （spring-boot提供）</p>\n<p><img src=\"\\images\\pasted-17.png\" alt=\"upload successful\"></p>\n"},{"title":"zookeeper-反复重连问题","author":"Xiang Chuang","date":"2018-09-10T10:09:00.000Z","_content":"现象，zk后台日志发现频繁刷如下日志\nRefusing session request for client /192.168.46.4:48551 as it has seen zxid 0x3cdf3127 our last zxid is 0x5bba6c client must try another server\n\n大量刷日志导致zk性能下降，最终导致依赖于zk的服务不可用\n\n经分析：\n日志来源代码为 org.apache.zookeeper.server.ZooKeeperServer\n\n![upload successful](\\images\\pasted-18.png)\nlastProcessedZxid在zk中用于记录版本信息，即客户端与服务端版本控制\n\n后经反馈得知，18.09.07由于snet环境zk日志量大，曾情况过zk数据目录数据，当时导致各应用zk不可用，要求各应用重启，后续大部分应用重启完成后业务正常使用，但并没有核对所有系统是否都重启\n\n因此，部分没有重启的应用本地的版本信息还是老的信息，拿此信息与zk服务端交互，由于版本信息不对，导致zk拒绝连接，从而客户端又频繁发起重连尝试。。。\n\n解决，一旦发起过zk数据目录删除，或者迁移，请务必确保所有应用全部重启以获取最新的版本信息","source":"_posts/zookeeper-反复重连问题.md","raw":"title: zookeeper-反复重连问题\nauthor: Xiang Chuang\ntags:\n  - zookeeper\ncategories:\n  - 爱学爱问\ndate: 2018-09-10 18:09:00\n---\n现象，zk后台日志发现频繁刷如下日志\nRefusing session request for client /192.168.46.4:48551 as it has seen zxid 0x3cdf3127 our last zxid is 0x5bba6c client must try another server\n\n大量刷日志导致zk性能下降，最终导致依赖于zk的服务不可用\n\n经分析：\n日志来源代码为 org.apache.zookeeper.server.ZooKeeperServer\n\n![upload successful](\\images\\pasted-18.png)\nlastProcessedZxid在zk中用于记录版本信息，即客户端与服务端版本控制\n\n后经反馈得知，18.09.07由于snet环境zk日志量大，曾情况过zk数据目录数据，当时导致各应用zk不可用，要求各应用重启，后续大部分应用重启完成后业务正常使用，但并没有核对所有系统是否都重启\n\n因此，部分没有重启的应用本地的版本信息还是老的信息，拿此信息与zk服务端交互，由于版本信息不对，导致zk拒绝连接，从而客户端又频繁发起重连尝试。。。\n\n解决，一旦发起过zk数据目录删除，或者迁移，请务必确保所有应用全部重启以获取最新的版本信息","slug":"zookeeper-反复重连问题","published":1,"updated":"2019-04-10T07:13:47.514Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbs8001oysuvr2e8zqt5","content":"<p>现象，zk后台日志发现频繁刷如下日志<br>Refusing session request for client /192.168.46.4:48551 as it has seen zxid 0x3cdf3127 our last zxid is 0x5bba6c client must try another server</p>\n<p>大量刷日志导致zk性能下降，最终导致依赖于zk的服务不可用</p>\n<p>经分析：<br>日志来源代码为 org.apache.zookeeper.server.ZooKeeperServer</p>\n<p><img src=\"\\images\\pasted-18.png\" alt=\"upload successful\"><br>lastProcessedZxid在zk中用于记录版本信息，即客户端与服务端版本控制</p>\n<p>后经反馈得知，18.09.07由于snet环境zk日志量大，曾情况过zk数据目录数据，当时导致各应用zk不可用，要求各应用重启，后续大部分应用重启完成后业务正常使用，但并没有核对所有系统是否都重启</p>\n<p>因此，部分没有重启的应用本地的版本信息还是老的信息，拿此信息与zk服务端交互，由于版本信息不对，导致zk拒绝连接，从而客户端又频繁发起重连尝试。。。</p>\n<p>解决，一旦发起过zk数据目录删除，或者迁移，请务必确保所有应用全部重启以获取最新的版本信息</p>\n","site":{"data":{}},"excerpt":"","more":"<p>现象，zk后台日志发现频繁刷如下日志<br>Refusing session request for client /192.168.46.4:48551 as it has seen zxid 0x3cdf3127 our last zxid is 0x5bba6c client must try another server</p>\n<p>大量刷日志导致zk性能下降，最终导致依赖于zk的服务不可用</p>\n<p>经分析：<br>日志来源代码为 org.apache.zookeeper.server.ZooKeeperServer</p>\n<p><img src=\"\\images\\pasted-18.png\" alt=\"upload successful\"><br>lastProcessedZxid在zk中用于记录版本信息，即客户端与服务端版本控制</p>\n<p>后经反馈得知，18.09.07由于snet环境zk日志量大，曾情况过zk数据目录数据，当时导致各应用zk不可用，要求各应用重启，后续大部分应用重启完成后业务正常使用，但并没有核对所有系统是否都重启</p>\n<p>因此，部分没有重启的应用本地的版本信息还是老的信息，拿此信息与zk服务端交互，由于版本信息不对，导致zk拒绝连接，从而客户端又频繁发起重连尝试。。。</p>\n<p>解决，一旦发起过zk数据目录删除，或者迁移，请务必确保所有应用全部重启以获取最新的版本信息</p>\n"},{"title":"内存泄漏-案例分析","author":"Xiang Chuang","date":"2018-07-09T06:24:00.000Z","_content":"问题描述：代扣网关启动一段时间后，监控发现系统随着运行时间越长越缓慢（第一时间考虑是否内存泄漏）\n\n现象：1、一个很简单的代码块执行耗时很长，甚至长达30S以上\n          2、老年代频繁进行内存回收，但是回收后却仍旧占用了很多内存，且随着时间推移，占用的越来越多，只到系统                       down掉 \n          3、青年代内存频繁回收（该原因是青年代内存分配不合理，可考虑青年代占总堆内存3：8，但是不能太大，如果太                   大，当青年代回收时，如果需要晋升到老年代的对象占内容大于老年代可用空间的一般，将会导致Full GC）\n\n原因推测：\n            上述现象第一反应是疑似出现内存泄漏\n处理过程：1、系统挂掉（重启）前，dump内存镜像文件，  jmap -dump:format=b,file=盘符:/XXX.hprof <pid>\n                 2、使用mat工具分析dump文件\n                 3、找出引起内存泄漏的对象\n                 4、分析解决方案\n           \n\n附：\n1、执行缓慢的代码日志：下面是一段for循环代码块，每次循环先校验再入库，逻辑简单，但发现异常的慢！\n2018-07-04 08:39:06.511 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.539 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:06.596 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.613 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:06.673 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.696 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:39.615 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:39.618 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2、GC日志：老年代CMS策略垃圾回收日志，反复回收，但依旧回收不了内存，内存消耗的原来越多\n2018-07-09T14:24:21.701+0800: 337412.009: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4302687K(5183936K)] 4971300K(6106880K), 0.0621324 secs] [Times: user=0.73 sys=0.00, real=0.07 secs] \n2018-07-09T14:24:21.764+0800: 337412.072: [CMS-concurrent-mark-start]\n2018-07-09T14:24:22.900+0800: 337413.208: [GC (Allocation Failure) 337413.208: [ParNew: 760830K->17436K(922944K), 0.0174147 secs] 5063517K->4320664K(6106880K), 0.0180025 secs] [Times: user=0.11 sys=0.01, real=0.02 secs] \n2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-mark: 3.607/3.760 secs] [Times: user=16.27 sys=0.18, real=3.75 secs] \n2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-preclean-start]\n2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-preclean: 0.045/0.047 secs] [Times: user=0.07 sys=0.01, real=0.05 secs] \n2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-abortable-preclean-start]\n CMS: abort preclean due to time 2018-07-09T14:24:30.647+0800: 337420.955: [CMS-concurrent-abortable-preclean: 3.287/5.076 secs] [Times: user=4.95 sys=0.24, real=5.08 secs] \n2018-07-09T14:24:30.658+0800: 337420.966: [GC (CMS Final Remark) [YG occupancy: 617178 K (922944 K)]337420.966: [Rescan (parallel) , 0.0603228 secs]337421.027: [weak refs processing, 0.0000841 secs]337421.027: [class unloading, 0.1254411 secs]337421.152: [scrub symbol table, 0.0445538 secs]337421.197: [scrub string table, 0.0066675 secs][1 CMS-remark: 4303227K(5183936K)] 4920406K(6106880K), 0.2439490 secs] [Times: user=0.90 sys=0.01, real=0.24 secs] \n2018-07-09T14:24:30.903+0800: 337421.211: [CMS-concurrent-sweep-start]\n2018-07-09T14:24:31.941+0800: 337422.249: [GC (Allocation Failure) 337422.249: [ParNew: 755804K->24447K(922944K), 0.0350291 secs] 5059025K->4328220K(6106880K), 0.0357587 secs] [Times: user=0.18 sys=0.00, real=0.04 secs] \n2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-sweep: 2.815/2.958 secs] [Times: user=4.72 sys=0.24, real=2.96 secs] \n2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-reset-start]\n2018-07-09T14:24:33.877+0800: 337424.185: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.02 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:35.886+0800: 337426.194: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4303632K(5183936K)] 4520863K(6106880K), 0.0222239 secs] [Times: user=0.21 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:35.910+0800: 337426.218: [CMS-concurrent-mark-start]\n2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-mark: 3.449/3.463 secs] [Times: user=14.73 sys=0.10, real=3.46 secs] \n2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-preclean-start]\n2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-preclean: 0.023/0.023 secs] [Times: user=0.02 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-abortable-preclean-start]\n CMS: abort preclean due to time 2018-07-09T14:24:44.405+0800: 337434.713: [CMS-concurrent-abortable-preclean: 3.247/5.009 secs] [Times: user=3.97 sys=0.16, real=5.01 secs] \n2018-07-09T14:24:44.415+0800: 337434.723: [GC (CMS Final Remark) [YG occupancy: 553150 K (922944 K)]337434.723: [Rescan (parallel) , 0.0524846 secs]337434.776: [weak refs processing, 0.0000721 secs]337434.776: [class unloading, 0.1203949 secs]337434.896: [scrub symbol table, 0.0454455 secs]337434.942: [scrub string table, 0.0063738 secs][1 CMS-remark: 4303632K(5183936K)] 4856783K(6106880K), 0.2322675 secs] [Times: user=0.83 sys=0.00, real=0.23 secs] \n2018-07-09T14:24:44.648+0800: 337434.956: [CMS-concurrent-sweep-start]\n2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-sweep: 2.492/2.501 secs] [Times: user=2.85 sys=0.03, real=2.50 secs] \n2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-reset-start]\n2018-07-09T14:24:47.165+0800: 337437.473: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.01 sys=0.00, real=0.01 secs] \n3、mat分析情况：\n\n![upload successful](\\images\\pasted-2.png)\n\n![upload successful](\\images\\pasted-3.png)\n\n![upload successful](\\images\\pasted-4.png)\n\n![upload successful](\\images\\pasted-5.png)","source":"_posts/内存泄漏案例分析.md","raw":"title: 内存泄漏-案例分析\nauthor: Xiang Chuang\ntags:\n  - 内存泄漏\n  - java\n  - mat\ncategories:\n  - 爱学爱问\ndate: 2018-07-09 14:24:00\n---\n问题描述：代扣网关启动一段时间后，监控发现系统随着运行时间越长越缓慢（第一时间考虑是否内存泄漏）\n\n现象：1、一个很简单的代码块执行耗时很长，甚至长达30S以上\n          2、老年代频繁进行内存回收，但是回收后却仍旧占用了很多内存，且随着时间推移，占用的越来越多，只到系统                       down掉 \n          3、青年代内存频繁回收（该原因是青年代内存分配不合理，可考虑青年代占总堆内存3：8，但是不能太大，如果太                   大，当青年代回收时，如果需要晋升到老年代的对象占内容大于老年代可用空间的一般，将会导致Full GC）\n\n原因推测：\n            上述现象第一反应是疑似出现内存泄漏\n处理过程：1、系统挂掉（重启）前，dump内存镜像文件，  jmap -dump:format=b,file=盘符:/XXX.hprof <pid>\n                 2、使用mat工具分析dump文件\n                 3、找出引起内存泄漏的对象\n                 4、分析解决方案\n           \n\n附：\n1、执行缓慢的代码日志：下面是一段for循环代码块，每次循环先校验再入库，逻辑简单，但发现异常的慢！\n2018-07-04 08:39:06.511 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.539 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:06.596 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.613 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:06.673 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:06.696 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2018-07-04 08:39:39.615 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验\n2018-07-04 08:39:39.618 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表 \n2、GC日志：老年代CMS策略垃圾回收日志，反复回收，但依旧回收不了内存，内存消耗的原来越多\n2018-07-09T14:24:21.701+0800: 337412.009: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4302687K(5183936K)] 4971300K(6106880K), 0.0621324 secs] [Times: user=0.73 sys=0.00, real=0.07 secs] \n2018-07-09T14:24:21.764+0800: 337412.072: [CMS-concurrent-mark-start]\n2018-07-09T14:24:22.900+0800: 337413.208: [GC (Allocation Failure) 337413.208: [ParNew: 760830K->17436K(922944K), 0.0174147 secs] 5063517K->4320664K(6106880K), 0.0180025 secs] [Times: user=0.11 sys=0.01, real=0.02 secs] \n2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-mark: 3.607/3.760 secs] [Times: user=16.27 sys=0.18, real=3.75 secs] \n2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-preclean-start]\n2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-preclean: 0.045/0.047 secs] [Times: user=0.07 sys=0.01, real=0.05 secs] \n2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-abortable-preclean-start]\n CMS: abort preclean due to time 2018-07-09T14:24:30.647+0800: 337420.955: [CMS-concurrent-abortable-preclean: 3.287/5.076 secs] [Times: user=4.95 sys=0.24, real=5.08 secs] \n2018-07-09T14:24:30.658+0800: 337420.966: [GC (CMS Final Remark) [YG occupancy: 617178 K (922944 K)]337420.966: [Rescan (parallel) , 0.0603228 secs]337421.027: [weak refs processing, 0.0000841 secs]337421.027: [class unloading, 0.1254411 secs]337421.152: [scrub symbol table, 0.0445538 secs]337421.197: [scrub string table, 0.0066675 secs][1 CMS-remark: 4303227K(5183936K)] 4920406K(6106880K), 0.2439490 secs] [Times: user=0.90 sys=0.01, real=0.24 secs] \n2018-07-09T14:24:30.903+0800: 337421.211: [CMS-concurrent-sweep-start]\n2018-07-09T14:24:31.941+0800: 337422.249: [GC (Allocation Failure) 337422.249: [ParNew: 755804K->24447K(922944K), 0.0350291 secs] 5059025K->4328220K(6106880K), 0.0357587 secs] [Times: user=0.18 sys=0.00, real=0.04 secs] \n2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-sweep: 2.815/2.958 secs] [Times: user=4.72 sys=0.24, real=2.96 secs] \n2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-reset-start]\n2018-07-09T14:24:33.877+0800: 337424.185: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.02 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:35.886+0800: 337426.194: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4303632K(5183936K)] 4520863K(6106880K), 0.0222239 secs] [Times: user=0.21 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:35.910+0800: 337426.218: [CMS-concurrent-mark-start]\n2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-mark: 3.449/3.463 secs] [Times: user=14.73 sys=0.10, real=3.46 secs] \n2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-preclean-start]\n2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-preclean: 0.023/0.023 secs] [Times: user=0.02 sys=0.00, real=0.02 secs] \n2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-abortable-preclean-start]\n CMS: abort preclean due to time 2018-07-09T14:24:44.405+0800: 337434.713: [CMS-concurrent-abortable-preclean: 3.247/5.009 secs] [Times: user=3.97 sys=0.16, real=5.01 secs] \n2018-07-09T14:24:44.415+0800: 337434.723: [GC (CMS Final Remark) [YG occupancy: 553150 K (922944 K)]337434.723: [Rescan (parallel) , 0.0524846 secs]337434.776: [weak refs processing, 0.0000721 secs]337434.776: [class unloading, 0.1203949 secs]337434.896: [scrub symbol table, 0.0454455 secs]337434.942: [scrub string table, 0.0063738 secs][1 CMS-remark: 4303632K(5183936K)] 4856783K(6106880K), 0.2322675 secs] [Times: user=0.83 sys=0.00, real=0.23 secs] \n2018-07-09T14:24:44.648+0800: 337434.956: [CMS-concurrent-sweep-start]\n2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-sweep: 2.492/2.501 secs] [Times: user=2.85 sys=0.03, real=2.50 secs] \n2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-reset-start]\n2018-07-09T14:24:47.165+0800: 337437.473: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.01 sys=0.00, real=0.01 secs] \n3、mat分析情况：\n\n![upload successful](\\images\\pasted-2.png)\n\n![upload successful](\\images\\pasted-3.png)\n\n![upload successful](\\images\\pasted-4.png)\n\n![upload successful](\\images\\pasted-5.png)","slug":"内存泄漏案例分析","published":1,"updated":"2019-04-10T06:46:39.336Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbsq001rysuvl6j022b6","content":"<p>问题描述：代扣网关启动一段时间后，监控发现系统随着运行时间越长越缓慢（第一时间考虑是否内存泄漏）</p>\n<p>现象：1、一个很简单的代码块执行耗时很长，甚至长达30S以上<br>          2、老年代频繁进行内存回收，但是回收后却仍旧占用了很多内存，且随着时间推移，占用的越来越多，只到系统                       down掉<br>          3、青年代内存频繁回收（该原因是青年代内存分配不合理，可考虑青年代占总堆内存3：8，但是不能太大，如果太                   大，当青年代回收时，如果需要晋升到老年代的对象占内容大于老年代可用空间的一般，将会导致Full GC）</p>\n<p>原因推测：<br>            上述现象第一反应是疑似出现内存泄漏<br>处理过程：1、系统挂掉（重启）前，dump内存镜像文件，  jmap -dump:format=b,file=盘符:/XXX.hprof <pid><br>                 2、使用mat工具分析dump文件<br>                 3、找出引起内存泄漏的对象<br>                 4、分析解决方案</pid></p>\n<p>附：<br>1、执行缓慢的代码日志：下面是一段for循环代码块，每次循环先校验再入库，逻辑简单，但发现异常的慢！<br>2018-07-04 08:39:06.511 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.539 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:06.596 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.613 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:06.673 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.696 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:39.615 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:39.618 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2、GC日志：老年代CMS策略垃圾回收日志，反复回收，但依旧回收不了内存，内存消耗的原来越多<br>2018-07-09T14:24:21.701+0800: 337412.009: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4302687K(5183936K)] 4971300K(6106880K), 0.0621324 secs] [Times: user=0.73 sys=0.00, real=0.07 secs]<br>2018-07-09T14:24:21.764+0800: 337412.072: [CMS-concurrent-mark-start]<br>2018-07-09T14:24:22.900+0800: 337413.208: [GC (Allocation Failure) 337413.208: [ParNew: 760830K-&gt;17436K(922944K), 0.0174147 secs] 5063517K-&gt;4320664K(6106880K), 0.0180025 secs] [Times: user=0.11 sys=0.01, real=0.02 secs]<br>2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-mark: 3.607/3.760 secs] [Times: user=16.27 sys=0.18, real=3.75 secs]<br>2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-preclean-start]<br>2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-preclean: 0.045/0.047 secs] [Times: user=0.07 sys=0.01, real=0.05 secs]<br>2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-abortable-preclean-start]<br> CMS: abort preclean due to time 2018-07-09T14:24:30.647+0800: 337420.955: [CMS-concurrent-abortable-preclean: 3.287/5.076 secs] [Times: user=4.95 sys=0.24, real=5.08 secs]<br>2018-07-09T14:24:30.658+0800: 337420.966: [GC (CMS Final Remark) [YG occupancy: 617178 K (922944 K)]337420.966: [Rescan (parallel) , 0.0603228 secs]337421.027: [weak refs processing, 0.0000841 secs]337421.027: [class unloading, 0.1254411 secs]337421.152: [scrub symbol table, 0.0445538 secs]337421.197: [scrub string table, 0.0066675 secs][1 CMS-remark: 4303227K(5183936K)] 4920406K(6106880K), 0.2439490 secs] [Times: user=0.90 sys=0.01, real=0.24 secs]<br>2018-07-09T14:24:30.903+0800: 337421.211: [CMS-concurrent-sweep-start]<br>2018-07-09T14:24:31.941+0800: 337422.249: [GC (Allocation Failure) 337422.249: [ParNew: 755804K-&gt;24447K(922944K), 0.0350291 secs] 5059025K-&gt;4328220K(6106880K), 0.0357587 secs] [Times: user=0.18 sys=0.00, real=0.04 secs]<br>2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-sweep: 2.815/2.958 secs] [Times: user=4.72 sys=0.24, real=2.96 secs]<br>2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-reset-start]<br>2018-07-09T14:24:33.877+0800: 337424.185: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:35.886+0800: 337426.194: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4303632K(5183936K)] 4520863K(6106880K), 0.0222239 secs] [Times: user=0.21 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:35.910+0800: 337426.218: [CMS-concurrent-mark-start]<br>2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-mark: 3.449/3.463 secs] [Times: user=14.73 sys=0.10, real=3.46 secs]<br>2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-preclean-start]<br>2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-preclean: 0.023/0.023 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-abortable-preclean-start]<br> CMS: abort preclean due to time 2018-07-09T14:24:44.405+0800: 337434.713: [CMS-concurrent-abortable-preclean: 3.247/5.009 secs] [Times: user=3.97 sys=0.16, real=5.01 secs]<br>2018-07-09T14:24:44.415+0800: 337434.723: [GC (CMS Final Remark) [YG occupancy: 553150 K (922944 K)]337434.723: [Rescan (parallel) , 0.0524846 secs]337434.776: [weak refs processing, 0.0000721 secs]337434.776: [class unloading, 0.1203949 secs]337434.896: [scrub symbol table, 0.0454455 secs]337434.942: [scrub string table, 0.0063738 secs][1 CMS-remark: 4303632K(5183936K)] 4856783K(6106880K), 0.2322675 secs] [Times: user=0.83 sys=0.00, real=0.23 secs]<br>2018-07-09T14:24:44.648+0800: 337434.956: [CMS-concurrent-sweep-start]<br>2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-sweep: 2.492/2.501 secs] [Times: user=2.85 sys=0.03, real=2.50 secs]<br>2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-reset-start]<br>2018-07-09T14:24:47.165+0800: 337437.473: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.01 sys=0.00, real=0.01 secs]<br>3、mat分析情况：</p>\n<p><img src=\"\\images\\pasted-2.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-3.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-4.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-5.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>问题描述：代扣网关启动一段时间后，监控发现系统随着运行时间越长越缓慢（第一时间考虑是否内存泄漏）</p>\n<p>现象：1、一个很简单的代码块执行耗时很长，甚至长达30S以上<br>          2、老年代频繁进行内存回收，但是回收后却仍旧占用了很多内存，且随着时间推移，占用的越来越多，只到系统                       down掉<br>          3、青年代内存频繁回收（该原因是青年代内存分配不合理，可考虑青年代占总堆内存3：8，但是不能太大，如果太                   大，当青年代回收时，如果需要晋升到老年代的对象占内容大于老年代可用空间的一般，将会导致Full GC）</p>\n<p>原因推测：<br>            上述现象第一反应是疑似出现内存泄漏<br>处理过程：1、系统挂掉（重启）前，dump内存镜像文件，  jmap -dump:format=b,file=盘符:/XXX.hprof <pid><br>                 2、使用mat工具分析dump文件<br>                 3、找出引起内存泄漏的对象<br>                 4、分析解决方案</pid></p>\n<p>附：<br>1、执行缓慢的代码日志：下面是一段for循环代码块，每次循环先校验再入库，逻辑简单，但发现异常的慢！<br>2018-07-04 08:39:06.511 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.539 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:06.596 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.613 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:06.673 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:06.696 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2018-07-04 08:39:39.615 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 代扣请求校验<br>2018-07-04 08:39:39.618 INFO  [DubboServerHandler-172.20.30.60:20939-99] BatchDeductCheckNode-00060000030000000001807040838510002- 插入流水信息到代扣流水表和流水附表<br>2、GC日志：老年代CMS策略垃圾回收日志，反复回收，但依旧回收不了内存，内存消耗的原来越多<br>2018-07-09T14:24:21.701+0800: 337412.009: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4302687K(5183936K)] 4971300K(6106880K), 0.0621324 secs] [Times: user=0.73 sys=0.00, real=0.07 secs]<br>2018-07-09T14:24:21.764+0800: 337412.072: [CMS-concurrent-mark-start]<br>2018-07-09T14:24:22.900+0800: 337413.208: [GC (Allocation Failure) 337413.208: [ParNew: 760830K-&gt;17436K(922944K), 0.0174147 secs] 5063517K-&gt;4320664K(6106880K), 0.0180025 secs] [Times: user=0.11 sys=0.01, real=0.02 secs]<br>2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-mark: 3.607/3.760 secs] [Times: user=16.27 sys=0.18, real=3.75 secs]<br>2018-07-09T14:24:25.524+0800: 337415.832: [CMS-concurrent-preclean-start]<br>2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-preclean: 0.045/0.047 secs] [Times: user=0.07 sys=0.01, real=0.05 secs]<br>2018-07-09T14:24:25.571+0800: 337415.879: [CMS-concurrent-abortable-preclean-start]<br> CMS: abort preclean due to time 2018-07-09T14:24:30.647+0800: 337420.955: [CMS-concurrent-abortable-preclean: 3.287/5.076 secs] [Times: user=4.95 sys=0.24, real=5.08 secs]<br>2018-07-09T14:24:30.658+0800: 337420.966: [GC (CMS Final Remark) [YG occupancy: 617178 K (922944 K)]337420.966: [Rescan (parallel) , 0.0603228 secs]337421.027: [weak refs processing, 0.0000841 secs]337421.027: [class unloading, 0.1254411 secs]337421.152: [scrub symbol table, 0.0445538 secs]337421.197: [scrub string table, 0.0066675 secs][1 CMS-remark: 4303227K(5183936K)] 4920406K(6106880K), 0.2439490 secs] [Times: user=0.90 sys=0.01, real=0.24 secs]<br>2018-07-09T14:24:30.903+0800: 337421.211: [CMS-concurrent-sweep-start]<br>2018-07-09T14:24:31.941+0800: 337422.249: [GC (Allocation Failure) 337422.249: [ParNew: 755804K-&gt;24447K(922944K), 0.0350291 secs] 5059025K-&gt;4328220K(6106880K), 0.0357587 secs] [Times: user=0.18 sys=0.00, real=0.04 secs]<br>2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-sweep: 2.815/2.958 secs] [Times: user=4.72 sys=0.24, real=2.96 secs]<br>2018-07-09T14:24:33.862+0800: 337424.170: [CMS-concurrent-reset-start]<br>2018-07-09T14:24:33.877+0800: 337424.185: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:35.886+0800: 337426.194: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4303632K(5183936K)] 4520863K(6106880K), 0.0222239 secs] [Times: user=0.21 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:35.910+0800: 337426.218: [CMS-concurrent-mark-start]<br>2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-mark: 3.449/3.463 secs] [Times: user=14.73 sys=0.10, real=3.46 secs]<br>2018-07-09T14:24:39.373+0800: 337429.681: [CMS-concurrent-preclean-start]<br>2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-preclean: 0.023/0.023 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]<br>2018-07-09T14:24:39.396+0800: 337429.704: [CMS-concurrent-abortable-preclean-start]<br> CMS: abort preclean due to time 2018-07-09T14:24:44.405+0800: 337434.713: [CMS-concurrent-abortable-preclean: 3.247/5.009 secs] [Times: user=3.97 sys=0.16, real=5.01 secs]<br>2018-07-09T14:24:44.415+0800: 337434.723: [GC (CMS Final Remark) [YG occupancy: 553150 K (922944 K)]337434.723: [Rescan (parallel) , 0.0524846 secs]337434.776: [weak refs processing, 0.0000721 secs]337434.776: [class unloading, 0.1203949 secs]337434.896: [scrub symbol table, 0.0454455 secs]337434.942: [scrub string table, 0.0063738 secs][1 CMS-remark: 4303632K(5183936K)] 4856783K(6106880K), 0.2322675 secs] [Times: user=0.83 sys=0.00, real=0.23 secs]<br>2018-07-09T14:24:44.648+0800: 337434.956: [CMS-concurrent-sweep-start]<br>2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-sweep: 2.492/2.501 secs] [Times: user=2.85 sys=0.03, real=2.50 secs]<br>2018-07-09T14:24:47.150+0800: 337437.458: [CMS-concurrent-reset-start]<br>2018-07-09T14:24:47.165+0800: 337437.473: [CMS-concurrent-reset: 0.015/0.015 secs] [Times: user=0.01 sys=0.00, real=0.01 secs]<br>3、mat分析情况：</p>\n<p><img src=\"\\images\\pasted-2.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-3.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-4.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-5.png\" alt=\"upload successful\"></p>\n"},{"title":"应用停机-优雅停机问题","author":"Xiang Chuang","date":"2018-07-17T06:28:00.000Z","_content":"优雅停机问题，new对象的时候，应用classloader可能已经关闭了哦！\n\nTomcatEmbeddedWebappClassLoader\n  context: ROOT\n  delegate: true\n----------> Parent Classloader:\nsun.misc.Launcher$AppClassLoader@14dad5dc\n\n![upload successful](\\images\\pasted-19.png)\n\n![upload successful](\\images\\pasted-20.png)\n\n![upload successful](\\images\\pasted-21.png)\n\n理论分析：\nspring-boot启动：\n1、new SpringApplication(Main.class).run(args);\n     1.1、加载SpringApplicationRunListeners并执行started()\n     1.2、createAndRefreshContext \n            1.2.1、Create and configure the environment\n            1.2.2、Create, load, refresh and run the ApplicationContext                                        【org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext】\n            1.2.3、Add boot specific singleton beans->springApplicationArguments\n            1.2.4、Load the sources->Main方法\n            1.2.5、SpringApplicationRunListeners执行contextLoaded\n            1.2.6、Refresh the context->AbstractApplicationContext\n                        1.2.6.1、Prepare this context for refreshing.\n                        1.2.6.2、Tell the subclass to refresh the internal bean factory.\n                        1.2.6.3、Prepare the bean factory for use in this context.\n                        1.2.6.4、Allows post-processing of the bean factory in context subclasses.\n                   【org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainer】\n                        1.2.6.5、Invoke factory processors registered as beans in the context.\n                        1.2.6.6、Register bean processors that intercept bean creation.\n                        1.2.6.7、Initialize message source for this context.\n                        1.2.6.8、Initialize event multicaster for this context.\n                        1.2.6.9、Initialize other special beans in specific context subclasses.\n                        1.2.6.10、Check for listener beans and register them.\n                        1.2.6.11、Instantiate all remaining (non-lazy-init) singletons.\n                        1.2.6.12、Last step: publish corresponding event.\n        1.3、call finished listener（可以做自己的事哦，yijiboot在这里就注册系统关闭钩子）\n        eg:com.yiji.boot.core.listener.YijiApplicationRunListener \n        new ShutdownThread().register();  ->shutdownApp();\n\nspring-boot关闭： AbstractApplicationContext.doClose()\n    1、Publish shutdown event.\n        earlyApplicationEvents（里面对应的事件，延迟执行）\n        eg：我们配置的dubbo关闭钩子就是同步执行的\n    2、Stop all Lifecycle beans, to avoid delays during individual destruction.\n    3、Destroy all cached singletons in the context's BeanFactory.\n    4、Close the state of this context itself.\n    5、Let subclasses do some final clean-up if they wish...\n    【org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.doClose()】\n![upload successful](\\images\\pasted-22.png)\n18.07.12\n又出问题啦\n自主化发布时，直接替换项目包，项目自动重启了，且，没有消费掉dubbo\n\n经分析：\n账务系统采用的依旧是war包的方式，部署在tomcat容器的。\n\n因此，替换war包后，项目自动重启，首先关闭tomcat容器，calssloader注销，然后注销springbean（这时候就出问题啦，因此某些bean已经不存在，不可使用）\n![upload successful](\\images\\pasted-23.png)","source":"_posts/应用停机-优雅停机问题.md","raw":"title: 应用停机-优雅停机问题\nauthor: Xiang Chuang\ntags:\n  - 优雅停机\ncategories:\n  - 爱学爱问\ndate: 2018-07-17 14:28:00\n---\n优雅停机问题，new对象的时候，应用classloader可能已经关闭了哦！\n\nTomcatEmbeddedWebappClassLoader\n  context: ROOT\n  delegate: true\n----------> Parent Classloader:\nsun.misc.Launcher$AppClassLoader@14dad5dc\n\n![upload successful](\\images\\pasted-19.png)\n\n![upload successful](\\images\\pasted-20.png)\n\n![upload successful](\\images\\pasted-21.png)\n\n理论分析：\nspring-boot启动：\n1、new SpringApplication(Main.class).run(args);\n     1.1、加载SpringApplicationRunListeners并执行started()\n     1.2、createAndRefreshContext \n            1.2.1、Create and configure the environment\n            1.2.2、Create, load, refresh and run the ApplicationContext                                        【org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext】\n            1.2.3、Add boot specific singleton beans->springApplicationArguments\n            1.2.4、Load the sources->Main方法\n            1.2.5、SpringApplicationRunListeners执行contextLoaded\n            1.2.6、Refresh the context->AbstractApplicationContext\n                        1.2.6.1、Prepare this context for refreshing.\n                        1.2.6.2、Tell the subclass to refresh the internal bean factory.\n                        1.2.6.3、Prepare the bean factory for use in this context.\n                        1.2.6.4、Allows post-processing of the bean factory in context subclasses.\n                   【org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainer】\n                        1.2.6.5、Invoke factory processors registered as beans in the context.\n                        1.2.6.6、Register bean processors that intercept bean creation.\n                        1.2.6.7、Initialize message source for this context.\n                        1.2.6.8、Initialize event multicaster for this context.\n                        1.2.6.9、Initialize other special beans in specific context subclasses.\n                        1.2.6.10、Check for listener beans and register them.\n                        1.2.6.11、Instantiate all remaining (non-lazy-init) singletons.\n                        1.2.6.12、Last step: publish corresponding event.\n        1.3、call finished listener（可以做自己的事哦，yijiboot在这里就注册系统关闭钩子）\n        eg:com.yiji.boot.core.listener.YijiApplicationRunListener \n        new ShutdownThread().register();  ->shutdownApp();\n\nspring-boot关闭： AbstractApplicationContext.doClose()\n    1、Publish shutdown event.\n        earlyApplicationEvents（里面对应的事件，延迟执行）\n        eg：我们配置的dubbo关闭钩子就是同步执行的\n    2、Stop all Lifecycle beans, to avoid delays during individual destruction.\n    3、Destroy all cached singletons in the context's BeanFactory.\n    4、Close the state of this context itself.\n    5、Let subclasses do some final clean-up if they wish...\n    【org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.doClose()】\n![upload successful](\\images\\pasted-22.png)\n18.07.12\n又出问题啦\n自主化发布时，直接替换项目包，项目自动重启了，且，没有消费掉dubbo\n\n经分析：\n账务系统采用的依旧是war包的方式，部署在tomcat容器的。\n\n因此，替换war包后，项目自动重启，首先关闭tomcat容器，calssloader注销，然后注销springbean（这时候就出问题啦，因此某些bean已经不存在，不可使用）\n![upload successful](\\images\\pasted-23.png)","slug":"应用停机-优雅停机问题","published":1,"updated":"2019-04-10T07:18:17.373Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbtg001vysuv0vaobaws","content":"<p>优雅停机问题，new对象的时候，应用classloader可能已经关闭了哦！</p>\n<p>TomcatEmbeddedWebappClassLoader<br>  context: ROOT<br>  delegate: true<br>———-&gt; Parent Classloader:<br>sun.misc.Launcher$AppClassLoader@14dad5dc</p>\n<p><img src=\"\\images\\pasted-19.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-20.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-21.png\" alt=\"upload successful\"></p>\n<p>理论分析：<br>spring-boot启动：<br>1、new SpringApplication(Main.class).run(args);<br>     1.1、加载SpringApplicationRunListeners并执行started()<br>     1.2、createAndRefreshContext<br>            1.2.1、Create and configure the environment<br>            1.2.2、Create, load, refresh and run the ApplicationContext                                        【org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext】<br>            1.2.3、Add boot specific singleton beans-&gt;springApplicationArguments<br>            1.2.4、Load the sources-&gt;Main方法<br>            1.2.5、SpringApplicationRunListeners执行contextLoaded<br>            1.2.6、Refresh the context-&gt;AbstractApplicationContext<br>                        1.2.6.1、Prepare this context for refreshing.<br>                        1.2.6.2、Tell the subclass to refresh the internal bean factory.<br>                        1.2.6.3、Prepare the bean factory for use in this context.<br>                        1.2.6.4、Allows post-processing of the bean factory in context subclasses.<br>                   【org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainer】<br>                        1.2.6.5、Invoke factory processors registered as beans in the context.<br>                        1.2.6.6、Register bean processors that intercept bean creation.<br>                        1.2.6.7、Initialize message source for this context.<br>                        1.2.6.8、Initialize event multicaster for this context.<br>                        1.2.6.9、Initialize other special beans in specific context subclasses.<br>                        1.2.6.10、Check for listener beans and register them.<br>                        1.2.6.11、Instantiate all remaining (non-lazy-init) singletons.<br>                        1.2.6.12、Last step: publish corresponding event.<br>        1.3、call finished listener（可以做自己的事哦，yijiboot在这里就注册系统关闭钩子）<br>        eg:com.yiji.boot.core.listener.YijiApplicationRunListener<br>        new ShutdownThread().register();  -&gt;shutdownApp();</p>\n<p>spring-boot关闭： AbstractApplicationContext.doClose()<br>    1、Publish shutdown event.<br>        earlyApplicationEvents（里面对应的事件，延迟执行）<br>        eg：我们配置的dubbo关闭钩子就是同步执行的<br>    2、Stop all Lifecycle beans, to avoid delays during individual destruction.<br>    3、Destroy all cached singletons in the context’s BeanFactory.<br>    4、Close the state of this context itself.<br>    5、Let subclasses do some final clean-up if they wish…<br>    【org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.doClose()】<br><img src=\"\\images\\pasted-22.png\" alt=\"upload successful\"><br>18.07.12<br>又出问题啦<br>自主化发布时，直接替换项目包，项目自动重启了，且，没有消费掉dubbo</p>\n<p>经分析：<br>账务系统采用的依旧是war包的方式，部署在tomcat容器的。</p>\n<p>因此，替换war包后，项目自动重启，首先关闭tomcat容器，calssloader注销，然后注销springbean（这时候就出问题啦，因此某些bean已经不存在，不可使用）<br><img src=\"\\images\\pasted-23.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>优雅停机问题，new对象的时候，应用classloader可能已经关闭了哦！</p>\n<p>TomcatEmbeddedWebappClassLoader<br>  context: ROOT<br>  delegate: true<br>———-&gt; Parent Classloader:<br>sun.misc.Launcher$AppClassLoader@14dad5dc</p>\n<p><img src=\"\\images\\pasted-19.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-20.png\" alt=\"upload successful\"></p>\n<p><img src=\"\\images\\pasted-21.png\" alt=\"upload successful\"></p>\n<p>理论分析：<br>spring-boot启动：<br>1、new SpringApplication(Main.class).run(args);<br>     1.1、加载SpringApplicationRunListeners并执行started()<br>     1.2、createAndRefreshContext<br>            1.2.1、Create and configure the environment<br>            1.2.2、Create, load, refresh and run the ApplicationContext                                        【org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext】<br>            1.2.3、Add boot specific singleton beans-&gt;springApplicationArguments<br>            1.2.4、Load the sources-&gt;Main方法<br>            1.2.5、SpringApplicationRunListeners执行contextLoaded<br>            1.2.6、Refresh the context-&gt;AbstractApplicationContext<br>                        1.2.6.1、Prepare this context for refreshing.<br>                        1.2.6.2、Tell the subclass to refresh the internal bean factory.<br>                        1.2.6.3、Prepare the bean factory for use in this context.<br>                        1.2.6.4、Allows post-processing of the bean factory in context subclasses.<br>                   【org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainer】<br>                        1.2.6.5、Invoke factory processors registered as beans in the context.<br>                        1.2.6.6、Register bean processors that intercept bean creation.<br>                        1.2.6.7、Initialize message source for this context.<br>                        1.2.6.8、Initialize event multicaster for this context.<br>                        1.2.6.9、Initialize other special beans in specific context subclasses.<br>                        1.2.6.10、Check for listener beans and register them.<br>                        1.2.6.11、Instantiate all remaining (non-lazy-init) singletons.<br>                        1.2.6.12、Last step: publish corresponding event.<br>        1.3、call finished listener（可以做自己的事哦，yijiboot在这里就注册系统关闭钩子）<br>        eg:com.yiji.boot.core.listener.YijiApplicationRunListener<br>        new ShutdownThread().register();  -&gt;shutdownApp();</p>\n<p>spring-boot关闭： AbstractApplicationContext.doClose()<br>    1、Publish shutdown event.<br>        earlyApplicationEvents（里面对应的事件，延迟执行）<br>        eg：我们配置的dubbo关闭钩子就是同步执行的<br>    2、Stop all Lifecycle beans, to avoid delays during individual destruction.<br>    3、Destroy all cached singletons in the context’s BeanFactory.<br>    4、Close the state of this context itself.<br>    5、Let subclasses do some final clean-up if they wish…<br>    【org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.doClose()】<br><img src=\"\\images\\pasted-22.png\" alt=\"upload successful\"><br>18.07.12<br>又出问题啦<br>自主化发布时，直接替换项目包，项目自动重启了，且，没有消费掉dubbo</p>\n<p>经分析：<br>账务系统采用的依旧是war包的方式，部署在tomcat容器的。</p>\n<p>因此，替换war包后，项目自动重启，首先关闭tomcat容器，calssloader注销，然后注销springbean（这时候就出问题啦，因此某些bean已经不存在，不可使用）<br><img src=\"\\images\\pasted-23.png\" alt=\"upload successful\"></p>\n"},{"title":"数据库-重启引发的主键问题","author":"Xiang Chuang","date":"2018-07-22T04:04:00.000Z","_content":"问题：cs系统 shut_message  自增主键id变小了。\n\n原因：cs的数据库重启了，但是应用没停止，   mysql重启后，回滚了部分自增id，（亦或者是备库当主库用）\n\n\n业务原因：本以为外网关闭了，定时任务关闭了 不会有交易\n但是，  应用监控检查发邮件了，cs通过mq接收到了请求，连接数据库失败（此时数据库连接不上）。","source":"_posts/数据库-重启引发的主键问题.md","raw":"title: 数据库-重启引发的主键问题\nauthor: Xiang Chuang\ntags:\n  - db\ncategories:\n  - 爱学爱问\ndate: 2018-07-22 12:04:00\n---\n问题：cs系统 shut_message  自增主键id变小了。\n\n原因：cs的数据库重启了，但是应用没停止，   mysql重启后，回滚了部分自增id，（亦或者是备库当主库用）\n\n\n业务原因：本以为外网关闭了，定时任务关闭了 不会有交易\n但是，  应用监控检查发邮件了，cs通过mq接收到了请求，连接数据库失败（此时数据库连接不上）。","slug":"数据库-重启引发的主键问题","published":1,"updated":"2019-04-10T07:05:24.982Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbtt001yysuvjvbc7zdg","content":"<p>问题：cs系统 shut_message  自增主键id变小了。</p>\n<p>原因：cs的数据库重启了，但是应用没停止，   mysql重启后，回滚了部分自增id，（亦或者是备库当主库用）</p>\n<p>业务原因：本以为外网关闭了，定时任务关闭了 不会有交易<br>但是，  应用监控检查发邮件了，cs通过mq接收到了请求，连接数据库失败（此时数据库连接不上）。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>问题：cs系统 shut_message  自增主键id变小了。</p>\n<p>原因：cs的数据库重启了，但是应用没停止，   mysql重启后，回滚了部分自增id，（亦或者是备库当主库用）</p>\n<p>业务原因：本以为外网关闭了，定时任务关闭了 不会有交易<br>但是，  应用监控检查发邮件了，cs通过mq接收到了请求，连接数据库失败（此时数据库连接不上）。</p>\n"},{"title":"浅谈JVM之垃圾回收","author":"Xiang Chuang","date":"2019-04-08T08:54:02.000Z","_content":"---\ntitle: 浅谈JVM之垃圾回收\n---\n\n# {{ page.title }}\n\n## 概述\n+ [关于JVM内存](#partI)\n+ [java对象生命周期](#partII)\n+ [垃圾回收](#partIII)\n+ [内存调优](#partIV)\n\n----------------------------------\n\n## 关于JVM内存\n \n内存分布\n\n----------------------------------\n\n## java对象生命周期\n \n诞生与销毁\n\n----------------------------------\n\n## 垃圾回收\n \n回收策略\nhotspot垃圾回执器\n\n----------------------------------\n\n## 内存调优\n \n高性能的垃圾回收\n","source":"_posts/浅谈JVM之垃圾回收.md","raw":"title: 浅谈JVM之垃圾回收\nauthor: Xiang Chuang\ndate: 2019-04-08 16:54:02\ntags:\ncategories: JVM\n---\n---\ntitle: 浅谈JVM之垃圾回收\n---\n\n# {{ page.title }}\n\n## 概述\n+ [关于JVM内存](#partI)\n+ [java对象生命周期](#partII)\n+ [垃圾回收](#partIII)\n+ [内存调优](#partIV)\n\n----------------------------------\n\n## 关于JVM内存\n \n内存分布\n\n----------------------------------\n\n## java对象生命周期\n \n诞生与销毁\n\n----------------------------------\n\n## 垃圾回收\n \n回收策略\nhotspot垃圾回执器\n\n----------------------------------\n\n## 内存调优\n \n高性能的垃圾回收\n","slug":"浅谈JVM之垃圾回收","published":1,"updated":"2019-04-09T14:17:08.667Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbu40021ysuvpo5js34q","content":"<hr>\n<h2 id=\"title-浅谈JVM之垃圾回收\"><a href=\"#title-浅谈JVM之垃圾回收\" class=\"headerlink\" title=\"title: 浅谈JVM之垃圾回收\"></a>title: 浅谈JVM之垃圾回收</h2><h1 id><a href=\"#\" class=\"headerlink\" title></a></h1><h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><ul>\n<li><a href=\"#partI\">关于JVM内存</a></li>\n<li><a href=\"#partII\">java对象生命周期</a></li>\n<li><a href=\"#partIII\">垃圾回收</a></li>\n<li><a href=\"#partIV\">内存调优</a></li>\n</ul>\n<hr>\n<h2 id=\"关于JVM内存\"><a href=\"#关于JVM内存\" class=\"headerlink\" title=\"关于JVM内存\"></a>关于JVM内存</h2><p>内存分布</p>\n<hr>\n<h2 id=\"java对象生命周期\"><a href=\"#java对象生命周期\" class=\"headerlink\" title=\"java对象生命周期\"></a>java对象生命周期</h2><p>诞生与销毁</p>\n<hr>\n<h2 id=\"垃圾回收\"><a href=\"#垃圾回收\" class=\"headerlink\" title=\"垃圾回收\"></a>垃圾回收</h2><p>回收策略<br>hotspot垃圾回执器</p>\n<hr>\n<h2 id=\"内存调优\"><a href=\"#内存调优\" class=\"headerlink\" title=\"内存调优\"></a>内存调优</h2><p>高性能的垃圾回收</p>\n","site":{"data":{}},"excerpt":"","more":"<hr>\n<h2 id=\"title-浅谈JVM之垃圾回收\"><a href=\"#title-浅谈JVM之垃圾回收\" class=\"headerlink\" title=\"title: 浅谈JVM之垃圾回收\"></a>title: 浅谈JVM之垃圾回收</h2><h1 id><a href=\"#\" class=\"headerlink\" title></a></h1><h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><ul>\n<li><a href=\"#partI\">关于JVM内存</a></li>\n<li><a href=\"#partII\">java对象生命周期</a></li>\n<li><a href=\"#partIII\">垃圾回收</a></li>\n<li><a href=\"#partIV\">内存调优</a></li>\n</ul>\n<hr>\n<h2 id=\"关于JVM内存\"><a href=\"#关于JVM内存\" class=\"headerlink\" title=\"关于JVM内存\"></a>关于JVM内存</h2><p>内存分布</p>\n<hr>\n<h2 id=\"java对象生命周期\"><a href=\"#java对象生命周期\" class=\"headerlink\" title=\"java对象生命周期\"></a>java对象生命周期</h2><p>诞生与销毁</p>\n<hr>\n<h2 id=\"垃圾回收\"><a href=\"#垃圾回收\" class=\"headerlink\" title=\"垃圾回收\"></a>垃圾回收</h2><p>回收策略<br>hotspot垃圾回执器</p>\n<hr>\n<h2 id=\"内存调优\"><a href=\"#内存调优\" class=\"headerlink\" title=\"内存调优\"></a>内存调优</h2><p>高性能的垃圾回收</p>\n"},{"title":"浏览器-资源加载","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"浏览器在同一个域名下并发加载资源（js，图片，css等）数是有限的，ie8（6个），谷歌（4-6个），\n解决：将资源尽可能分布在不同的域名下。","source":"_posts/浏览器-资源加载.md","raw":"title: 浏览器-资源加载\nauthor: Xiang Chuang\ntags:\n  - 浏览器\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\n浏览器在同一个域名下并发加载资源（js，图片，css等）数是有限的，ie8（6个），谷歌（4-6个），\n解决：将资源尽可能分布在不同的域名下。","slug":"浏览器-资源加载","published":1,"updated":"2019-04-10T08:18:56.420Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbuv0024ysuvtrq5mcyk","content":"<p>浏览器在同一个域名下并发加载资源（js，图片，css等）数是有限的，ie8（6个），谷歌（4-6个），<br>解决：将资源尽可能分布在不同的域名下。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>浏览器在同一个域名下并发加载资源（js，图片，css等）数是有限的，ie8（6个），谷歌（4-6个），<br>解决：将资源尽可能分布在不同的域名下。</p>\n"},{"title":"淘宝架构-进化","author":"Xiang Chuang","date":"2017-07-20T04:30:00.000Z","_content":"V1.0：LAMP（Linux，Apache，MySQL，PHP） 2003年5月—2004年1月\n           注：一个主库（读写），两个从库（读） ，数据同步死锁 \n![upload successful](\\images\\pasted-57.png)\n\nV1.1：LAOP（Linux，Apache，Oracle，PHP）2004年1月—2004年5月\n            注：php访问数据库的方式很直接，短连接。 Oracle需要用到连接池、长连接才体现出其优势，但php没有很好的连接池           \n![upload successful](\\images\\pasted-58.png)\n\nV2.0：php切换为java IOE。2004年2月—2005年3月\n![upload successful](\\images\\pasted-59.png)\n\nV2.1:加入缓存，缓存只读信息，CDN  2004年10月—2007年1月\n![upload successful](\\images\\pasted-60.png)\n\nV2.2：kv缓存，tfs   模式类似于hadoop\n![upload successful](\\images\\pasted-61.png)\n","source":"_posts/淘宝架构-进化.md","raw":"title: 淘宝架构-进化\nauthor: Xiang Chuang\ntags:\n  - 架构\ncategories:\n  - 爱学爱问\ndate: 2017-07-20 12:30:00\n---\nV1.0：LAMP（Linux，Apache，MySQL，PHP） 2003年5月—2004年1月\n           注：一个主库（读写），两个从库（读） ，数据同步死锁 \n![upload successful](\\images\\pasted-57.png)\n\nV1.1：LAOP（Linux，Apache，Oracle，PHP）2004年1月—2004年5月\n            注：php访问数据库的方式很直接，短连接。 Oracle需要用到连接池、长连接才体现出其优势，但php没有很好的连接池           \n![upload successful](\\images\\pasted-58.png)\n\nV2.0：php切换为java IOE。2004年2月—2005年3月\n![upload successful](\\images\\pasted-59.png)\n\nV2.1:加入缓存，缓存只读信息，CDN  2004年10月—2007年1月\n![upload successful](\\images\\pasted-60.png)\n\nV2.2：kv缓存，tfs   模式类似于hadoop\n![upload successful](\\images\\pasted-61.png)\n","slug":"淘宝架构-进化","published":1,"updated":"2019-04-10T08:18:56.439Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbv50028ysuv68bl1cx3","content":"<p>V1.0：LAMP（Linux，Apache，MySQL，PHP） 2003年5月—2004年1月<br>           注：一个主库（读写），两个从库（读） ，数据同步死锁<br><img src=\"\\images\\pasted-57.png\" alt=\"upload successful\"></p>\n<p>V1.1：LAOP（Linux，Apache，Oracle，PHP）2004年1月—2004年5月<br>            注：php访问数据库的方式很直接，短连接。 Oracle需要用到连接池、长连接才体现出其优势，但php没有很好的连接池<br><img src=\"\\images\\pasted-58.png\" alt=\"upload successful\"></p>\n<p>V2.0：php切换为java IOE。2004年2月—2005年3月<br><img src=\"\\images\\pasted-59.png\" alt=\"upload successful\"></p>\n<p>V2.1:加入缓存，缓存只读信息，CDN  2004年10月—2007年1月<br><img src=\"\\images\\pasted-60.png\" alt=\"upload successful\"></p>\n<p>V2.2：kv缓存，tfs   模式类似于hadoop<br><img src=\"\\images\\pasted-61.png\" alt=\"upload successful\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>V1.0：LAMP（Linux，Apache，MySQL，PHP） 2003年5月—2004年1月<br>           注：一个主库（读写），两个从库（读） ，数据同步死锁<br><img src=\"\\images\\pasted-57.png\" alt=\"upload successful\"></p>\n<p>V1.1：LAOP（Linux，Apache，Oracle，PHP）2004年1月—2004年5月<br>            注：php访问数据库的方式很直接，短连接。 Oracle需要用到连接池、长连接才体现出其优势，但php没有很好的连接池<br><img src=\"\\images\\pasted-58.png\" alt=\"upload successful\"></p>\n<p>V2.0：php切换为java IOE。2004年2月—2005年3月<br><img src=\"\\images\\pasted-59.png\" alt=\"upload successful\"></p>\n<p>V2.1:加入缓存，缓存只读信息，CDN  2004年10月—2007年1月<br><img src=\"\\images\\pasted-60.png\" alt=\"upload successful\"></p>\n<p>V2.2：kv缓存，tfs   模式类似于hadoop<br><img src=\"\\images\\pasted-61.png\" alt=\"upload successful\"></p>\n"},{"title":"谈一谈锁","date":"2019-04-08T14:11:18.000Z","_content":"","source":"_posts/谈一谈锁.md","raw":"---\ntitle: 谈一谈锁\ndate: 2019-04-08 22:11:18\ntags:\ncategories:\n---\n","slug":"谈一谈锁","published":1,"updated":"2019-04-08T14:11:18.736Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhbvm002bysuv8l8v379h","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"javaagent-bytebuddy","author":"Xiang Chuang","date":"2018-10-31T09:01:00.000Z","_content":"Java agent是在另外一个Java应用（“目标”应用）启动之前要执行的Java程序，这样agent就有机会修改目标应用或者应用所运行的环境。在本文中，我们将会从基础内容开始，逐渐增强其功能，借助字节码操作工具Byte Buddy，使其成为高级的agent实现。\n\n在最基本的用例中，Java agent会用来设置应用属性或者配置特定的环境状态，agent能够作为可重用和可插入的组件。如下的样例描述了这样的一个agent，它设置了一个系统属性，在实际的程序中就可以使用该属性了：\n\npublic class Agent {  public static void premain(String arg) {    System.setProperty(\"my-property\", “foo”);  }}\n\n如上面的代码所述，Java agent的定义与其他的Java程序类似，只不过它使用premain方法替代main方法作为入口点。顾名思义，这个方法能够在目标应用的main方法之前执行。相对于其他的Java程序，编写agent并没有特定的规则。有一个很小的区别在于，Java agent接受一个可选的参数，而不是包含零个或更多参数的数组。\n\n如果要使用这个agent，必须要将agent类和资源打包到jar中，并且在jar的manifest中要将Agent-Class属性设置为包含premain方法的agent类。（agent必须要打包到jar文件中，它不能通过拆解的格式进行指定。）接下来，我们需要启动应用程序，并且在命令行中通过javaagent参数来引用jar文件的位置：\n\njava -javaagent:myAgent.jar -jar myProgram.jar\n\n我们还可以在位置路径上设置可选的agent参数。在下面的命令中会启动一个Java程序并且添加给定的agent，将值myOptions作为参数提供给premain方法：\n\njava -javaagent:myAgent.jar=myOptions -jar myProgram.jar\n\n通过重复使用javaagent命令，能够添加多个agent。\n\n但是，Java agent的功能并不局限于修改应用程序环境的状态，Java agent能够访问Java instrumentation API，这样的话，agent就能修改目标应用程序的代码。Java虚拟机中这个鲜为人知的特性提供了一个强大的工具，有助于实现面向切面的编程。\n\n如果要对Java程序进行这种修改，我们需要在agent的premain方法上添加类型为Instrumentation的第二个参数。Instrumentation参数可以用来执行一系列的任务，比如确定对象以字节为单位的精确大小以及通过注册ClassFileTransformers实际修改类的实现。ClassFileTransformers注册之后，当类加载器（class loader）加载类的时候都会调用它。当它被调用时，在类文件所代表的类加载之前，类文件transformer有机会改变或完全替换这个类文件。按照这种方式，在类使用之前，我们能够增强或修改类的行为，如下面的样例所示：\n\npublic class Agent { public static void premain(String argument, Instrumentation inst) {   inst.addTransformer(new ClassFileTransformer() {     @Override     public byte[] transform(       ClassLoader loader,       String className,       Class<?> classBeingRedefined, // 如果类之前没有加载的话，值为null       ProtectionDomain protectionDomain,       byte[] classFileBuffer) {       // 返回改变后的类文件。     }   }); }}\n\n通过使用Instrumentation实例注册上述的ClassFileTransformer之后，每个类加载的时候，都会调用这个transformer。为了实现这一点，transformer会接受一个二进制和类加载器的引用，分别代表了类文件以及试图加载类的类加载器。\n\nJava agent也可以在Java应用的运行期注册，如果是在这种场景下，instrumentation API允许重新定义已加载的类，这个特性被称之为“HotSwap”。不过，重新定义类仅限于替换方法体。在重新定义类的时候，不能新增或移除类成员，并且类型和签名也不能进行修改。当类第一次加载的时候，并没有这种限制，如果是在这样的场景下，那classBeingRedefined会被设置为null。\n\nJava字节码与类文件格式\n\n类文件代表了Java类编译之后的状态。类文件中会包含字节码，这些字节码代表了Java源码中最初的程序指令。Java字节码可以视为Java虚拟机的语言。实际上，JVM并不会将Java视为编程语言，它只能处理字节码。因为它采用二进制的表现形式，所以相对于程序的源码，它占用的空间更少。除此之外，将程序以字节码的形式进行表现能够更容易地编译Java以外的其他语言，如Scala或Clojure，从而让它们运行在JVM上。如果没有字节码作为中间语言的话，那么其他的程序在运行之前，可能还需要将其转换为Java源码。\n\n但是，在代码处理的时候，这种抽象却带来了一定的成本。如果要将ClassFileTransformer应用到某个类上，那我们不能将该类按照Java源码的形式进行处理，甚至不能假设被转换的代码最初是由Java编写而成的。更糟糕的是，探查类成员或注解的反射API也是禁止使用的，这是因为类加载之前，我们无法访问这些API，而在转换进程完成之前，是无法进行加载的。\n\n所幸的是，Java字节码相对来讲是一个比较简单的抽象形式，它包含了很少量的操作，稍微花点功夫我们就能大致将其掌握起来。Java虚拟机执行程序的时候，会以基于栈的方式来处理值。字节码指令一般会告知虚拟机，需要从操作数栈（operand stack）上弹出值，执行一些操作，然后再将结果压到栈中。\n\n让我们考虑一个简单的样例：将数字1和2进行相加操作。JVM首先会将这两个数字压到栈中，这是通过 iconst_1和iconst_2这两个字节指令实现的。iconst_1是个单字节的便捷运算符（operator），它会将数字1压到栈中。与之类似，iconst_2会将数字2压到栈中。然后，会执行iadd指令，它会将栈中最新的两个值弹出，将它们求和计算的结果重新压到栈中。在类文件中，每个指令并不是以其易于记忆的名称进行存储的，而是以一个字节的形式进行存储，这个字节能够唯一地标记特定的指令，这也是bytecode这个术语的来历。上文所述的字节码指令及其对操作数栈的影响，通过下面的图片进行了可视化。\n\n![upload successful](\\images\\pasted-54.png)\n\n对于人类用户来讲，会更喜欢源码而不是字节码，不过幸运的是Java社区创建了多个库，能够解析类文件并将紧凑的字节码暴露为具有名称的指令流。例如，流行的ASM库提供了一个简单的visitor API，它能够将类文件剖析为成员和方法指令，其操作方式类似于阅读XML文件时的SAX解析器。如果使用ASM的话，那上述样例中的字节码可以按照如下的代码来进行实现（在这里，ASM方式的指令是visitIns，能够提供修正的方法实现）：\n\nMethodVisitor methodVisitor = ...methodVisitor.visitIns(Opcodes.ICONST_1);methodVisitor.visitIns(Opcodes.ICONST_2);methodVisitor.visitIns(Opcodes.IADD);\n\n需要注意的是，字节码规范只不过是一种比喻的说法（metaphor），因为Java虚拟机允许将程序转换为优化后的机器码（machine code），只要程序的输出能够保证是正确的即可。因为字节码的简洁性，所以在已有的类中取代和修改指令是很简单直接的。因此，使用ASM及其底层的Java字节码基础就足以实现类转换的Java agent，这需要注册一个ClassFileTransformer，它会使用这个库来处理其参数。\n\n克服字节码的不足\n\n对于实际的应用来讲，解析原始的类文件依然意味着有很多的手动工作。Java程序员通常感兴趣的是类型层级结构中的类。例如，某个Java agent可能需要修改所有实现给定接口的类。如果要确定某个类的超类，那只靠解析ClassFileTransformer所给定的类文件就不够了，类文件中只包含了直接超类和接口的名字。为了解析可能的超类型关联关系，程序员依然需要定位这些类型的类文件。\n\n在项目中直接使用ASM的另外一个困难在于，团队中需要有开发人员学习Java字节码的基础知识。在实践中，这往往会导致很多的开发人员不敢再去修改字节码操作相关的代码。如果这样的话，实现Java agent很容易为项目的长期维护带来风险。\n\n为了克服这些问题，我们最好使用较高层级的抽象来实现Java agent，而不是直接操作Java字节码。Byte Buddy是开源的、基于Apache 2.0许可证的库，它致力于解决字节码操作和instrumentation API的复杂性。Byte Buddy所声称的目标是将显式的字节码操作隐藏在一个类型安全的领域特定语言背后。通过使用Byte Buddy，任何熟悉Java编程语言的人都有望非常容易地进行字节码操作。\n\nByte Buddy简介\n\nByte Buddy的目的并不仅仅是为了生成Java agent。它提供了一个API用于生成任意的Java类，基于这个生成类的API，Byte Buddy提供了额外的API来生成Java agent。\n\n作为Byte Buddy的简介，如下的样例展现了如何生成一个简单的类，这个类是Object的子类，并且重写了toString方法，用来返回“Hello World!”。与原始的ASM类似，“intercept”会告诉Byte Buddy为拦截到的指令提供方法实现：\n\nClass<?> dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(\"toString\"))  .intercept(FixedValue.value(\"Hello World!\"))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();\n\n从上面的代码中，我们可以看到Byte Buddy要实现一个方法分为两步。首先，编程人员需要指定一个ElementMatcher，它负责识别一个或多个需要实现的方法。Byte Buddy提供了功能丰富的预定义拦截器（interceptor），它们暴露在ElementMatchers类中。在上述的例子中，toString方法完全精确匹配了名称，但是，我们也可以匹配更为复杂的代码结构，如类型或注解。\n\n当Byte Buddy生成类的时候，它会分析所生成类型的类层级结构。在上述的例子中，Byte Buddy能够确定所生成的类要继承其超类Object的名为toString的方法，指定的匹配器会要求Byte Buddy重写该方法，这是通过随后的 Implementation 实例实现的，在我们的样例中，这个实例也就是FixedValue。\n\n当创建子类的时候，Byte Buddy始终会拦截（intercept）一个匹配的方法，在生成的类中重写该方法。但是，我们在本文稍后将会看到Byte Buddy还能够重新定义已有的类，而不必通过子类的方式来实现。在这种情况下，Byte Buddy会将已有的代码替换为生成的代码，而将原有的代码复制到另外一个合成的（synthetic）方法中。\n\n在我们上面的代码样例中，匹配的方法进行了重写，在实现里面，返回了固定的值“Hello World!”。intercept方法接受Implementation类型的参数，Byte Buddy自带了多个预先定义的实现，如上文所使用的FixedValue类。但是，如果需要的话，可以使用前文所述的ASM API将某个方法实现为自定义的字节码，Byte Buddy本身也是基于ASM API实现的。\n\n定义完类的属性之后，就能通过make方法来进行生成。在样例应用中，因为用户没有指定类名，所以生成的类会给定一个任意的名称。最终，生成的类将会使用ClassLoadingStrategy来进行加载。通过使用上述的默认 WRAPPER策略，类将会使用一个新的类加载器进行加载，这个类加载器会使用环境类加载器作为父加载器。\n\n类加载之后，使用Java反射API就可以访问它了。如果没有指定其他构造器的话，Byte Buddy将会生成类似于父类的构造器，因此生成的类可以使用默认的构造器。这样，我们就可以检验生成的类重写了 toString方法，如下面的代码所示：\n\nassertThat(dynamicType.newInstance().toString(),            is(\"Hello World!\"));\n\n当然，这个生成的类并没有太大的用处。对于实际的应用来讲，大多数方法的返回值是在运行时计算的，这个计算过程要依赖于方法的参数和对象的状态。\n\n通过委托实现Instrumentation\n\n要实现某个方法，有一种更为灵活的方式，那就是使用Byte Buddy的MethodDelegation。通过使用方法委托，在生成重写的实现时，我们就有可能调用给定类和实例的其他方法。按照这种方式，我们可以使用如下的委托器（delegator）重新编写上述的样例：\n\nclass ToStringInterceptor {  static String intercept() {    return “Hello World!”;  }}\n\n借助上面的POJO拦截器，我们就可以将之前的FixedValue实现替换为MethodDelegation.to(ToStringInterceptor.class)：\n\nClass<?> dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(\"toString\"))  .intercept(MethodDelegation.to(ToStringInterceptor.class))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();\n\n使用上述的委托器，Byte Buddy会在to方法所给定的拦截目标中，确定最优的调用方法。就ToStringInterceptor.class来讲，选择过程只是非常简单地解析这个类型的唯一静态方法而已。在本例中，只会考虑一个静态方法，因为委托的目标中指定的是一个类。与之不同的是，我们还可以将其委托给某个类的实例，如果是这样的话，Byte Buddy将会考虑所有的虚方法（virtual method）。如果类或实例上有多个这样的方法，那么Byte Buddy首先会排除掉所有与指定instrumentation不兼容的方法。在剩余的方法中，库将会选择最佳的匹配者，通常来讲这会是参数最多的方法。我们还可以显式地指定目标方法，这需要缩小合法方法的范围，将ElementMatcher传递到MethodDelegation中，就会进行方法的过滤。例如，通过添加如下的filter，Byte Buddy只会将名为“intercept”的方法视为委托目标：\n\nMethodDelegation.to(ToStringInterceptor.class)                .filter(ElementMatchers.named(“intercept”))\n\n执行上面的拦截之后，被拦截到的方法依然会打印出“Hello World!”，但是这次的结果是动态计算的，这样的话，我们就可以在拦截器方法上设置断点，所生成的类每次调用toString时，都会触发拦截器的方法。\n\n当我们为拦截器方法设置参数时，就能释放出MethodDelegation的全部威力。这里的参数通常是带有注解的，用来要求Byte Buddy在调用拦截器方法时，注入某个特定的值。例如，通过使用@Origin注解，Byte Buddy提供了添加instrument功能的方法的实例，将其作为Java反射API中类的实例：\n\nclass ContextualToStringInterceptor {  static String intercept(@Origin Method m) {    return “Hello World from ” + m.getName() + “!”;  }}\n\n当拦截toString方法时，对instrument方法的调用将会返回“Hello world from toString!”。\n\n除了@Origin注解以外，Byte Buddy提供了一组功能丰富的注解。例如，通过在类型为Callable的参数上使用@Super注解，Byte Buddy会创建并注入一个代理实例，它能够调用被instrument方法的原始代码。如果对于特定的用户场景，所提供的注解不能满足需求或者不太适合的话，我们甚至能够注册自定义的注解，让这些注解注入用户特定的值。\n\n实现方法级别的安全性\n\n可以看到，我们在运行时可以借助简单的Java代码，使用MethodDelegation来动态重写某个方法。这只是一个简单的样例，但是这项技术可以用到更加实际的应用之中。在本文剩余的内容中，我们将会开发一个样例，它会使用代码生成技术实现一个注解驱动的库，用来限制方法级别的安全性。在我们的第一个迭代中，这个库会通过生成子类的方式来限制安全性。然后，我们将会采取相同的方式来实现Java agent，完成相同的功能。\n\n样例库会使用如下的注解，允许用户指定某个方法需要考虑安全因素：\n\n@interface Secured {  String user();}\n\n例如，假设应用需要使用如下的Service类来执行敏感操作，并且只有用户被认证为管理员才能执行该方法。这是通过为执行这个操作的方法声明Secured注解来指定的：\n\nclass Service {  @Secured(user = “ADMIN”)  void doSensitiveAction() {    // 运行敏感代码...  }}\n\n我们当然可以将安全检查直接编写到方法中。在实际中，硬编码横切关注点往往会导致复制-粘贴的逻辑，使其难以维护。另外，一旦应用需要涉及额外的需求时，如日志、收集调用指标或结果缓存，直接添加这样的代码扩展性不会很好。通过将这样的功能抽取到agent中，方法就能很纯粹地关注其业务逻辑，使得代码库能够更易于阅读、测试和维护。\n\n为了让我们规划的库保持尽可能得简单，按照注解的协议声明，如果当前用户不具备注解的用户属性时，将会抛出IllegalStateException异常。通过使用Byte Buddy，这种行为可以用一个简单的拦截器来实现，如下面样例中的SecurityInterceptor所示，它会通过其静态的user域，跟踪当前用户已经进行了登录：\n\nclass SecurityInterceptor {  static String user = “ANONYMOUS”  static void intercept(@Origin Method method) {    if (!method.getAnnotation(Secured.class).user().equals(user)) {      throw new IllegalStateException(“Wrong user”);    }  }}\n\n通过上面的代码，我们可以看到，即便给定用户授予了访问权限，拦截器也没有调用原始的方法。为了解决这个问题，Byte Buddy有很多预定义的方法可以实现功能的链接。借助MethodDelegation类的andThen方法，上述的安全检查可以放到原始方法的调用之前，如下面的代码所示。如果用户没有进行认证的话，安全检查将会抛出异常并阻止后续的执行，因此原始方法将不会执行。\n\n将这些功能集合在一起，我们就能生成Service的一个子类，所有带有注解方法的都能恰当地进行安全保护。因为所生成的类是Service的子类，所以它能够替代所有类型为Service的变量，并不需要任何的类型转换，如果没有恰当认证的话，调用doSensitiveAction方法就会抛出异常：\n\nnew ByteBuddy()  .subclass(Service.class)  .method(ElementMatchers.isAnnotatedBy(Secured.class))  .intercept(MethodDelegation.to(SecurityInterceptor.class)                             .andThen(SuperMethodCall.INSTANCE)))  .make()  .load(getClass().getClassLoader(),           ClassLoadingStrategy.Default.WRAPPER)  .getLoaded()  .newInstance()  .doSensitiveAction();\n\n不过坏消息是，因为实现instrumentation功能的子类是在运行时创建的，所以除了使用Java反射以外，没有其他办法创建这样的实例。因此，所有instrumentation类的实例都应该通过一个工厂来创建，这个工厂会封装创建instrumentation子类的复杂性。这样造成的结果就是，子类instrumentation通常会用于框架之中，这些框架本身就需要通过工厂来创建实例，例如，像依赖管理的框架Spring或对象-关系映射的框架Hibernate，而对于其他类型的应用来讲，子类instrumentation实现起来通常过于复杂。\n\n实现安全功能的Java agent\n\n通过使用Java agent，上述安全框架的一个替代实现将会修改Service类的原始字节码，而不是重写它。这样做的话，我们就没有必要创建托管的实例了，只需简单地调用\n\nnew Service().doSensitiveAction()\n\n即可，如果对应的用户没有进行认证的话，就会抛出异常。为了支持这种方式，Byte Buddy提供一种称之为rebase某个类的理念。当rebase某个类的时候，不会创建子类，所采用的策略是实现instrumentation功能的代码将会合并到被instrument的类中，从而改变其行为。在添加instrumentation功能之后，在被instrument的类中，其所有方法的原始代码均可进行访问，因此像SuperMethodCall这样的instrumentation，工作方式与创建子类是完全一样的。\n\n创建子类与rebase的行为是非常类似的，所以两种操作的API执行方式是一致的，都会使用相同的DynamicType.Builder接口来描述某个类型。两种形式的instrumentation都可以通过ByteBuddy类来进行访问。为了使Java agent的定义更加便利，Byte Buddy还提供了 AgentBuilder类，它希望能够以一种简洁的方式应对一些通用的用户场景。为了定义Java agent实现方法级别的安全性，将如下的类定义为agent的入口点就足以完成该功能了：\n\nclass SecurityAgent {  public static void premain(String arg, Instrumentation inst) {    new AgentBuilder.Default()    .type(ElementMatchers.any())    .transform((builder, type) -> builder    .method(ElementMatchers.isAnnotatedBy(Secured.class)    .intercept(MethodDelegation.to(SecurityInterceptor.class)               .andThen(SuperMethodCall.INSTANCE))))    .installOn(inst);  }}\n\n如果将这个agent打包为jar文件并在命令行中进行指定，那么所有带有Secured注解的方法将会进行“转换”或重定义，从而实现安全保护。如果不激活这个Java agent的话，应用在运行时就不包含额外的安全检查。当然，这意味着如果对带有注解的代码进行单元测试的话，这些方法的调用并不需要特殊的搭建过程来模拟安全上下文。Java运行时会忽略掉无法在classpath中找到的注解类型，因此在运行带有注解的方法时，我们甚至完全可以在应用中移除掉安全库。\n\n另外一项优势在于，Java agent能够很容易地进行叠加。如果在命令行中指定多个Java agent的话，每个agent都有机会对类进行修改，其顺序就是在命令行中所指定的顺序。例如，我们可以采取这种方式将安全、日志以及监控框架联合在一起，而不需要在这些应用间增添任何形式的集成层。因此，使用Java agent实现横切的关注点提供了一种更为模块化的代码编写方式，而不必针对某个管理实例的中心框架来集成所有的代码。\n\n查看英文原文：Easily Create Java Agents with Byte Buddy\n","source":"_posts/javaagent-bytebuddy.md","raw":"title: javaagent-bytebuddy\nauthor: Xiang Chuang\ntags:\n  - javaagent\n  - bytebuddy\ncategories:\n  - 外部引用\ndate: 2018-10-31 17:01:00\n---\nJava agent是在另外一个Java应用（“目标”应用）启动之前要执行的Java程序，这样agent就有机会修改目标应用或者应用所运行的环境。在本文中，我们将会从基础内容开始，逐渐增强其功能，借助字节码操作工具Byte Buddy，使其成为高级的agent实现。\n\n在最基本的用例中，Java agent会用来设置应用属性或者配置特定的环境状态，agent能够作为可重用和可插入的组件。如下的样例描述了这样的一个agent，它设置了一个系统属性，在实际的程序中就可以使用该属性了：\n\npublic class Agent {  public static void premain(String arg) {    System.setProperty(\"my-property\", “foo”);  }}\n\n如上面的代码所述，Java agent的定义与其他的Java程序类似，只不过它使用premain方法替代main方法作为入口点。顾名思义，这个方法能够在目标应用的main方法之前执行。相对于其他的Java程序，编写agent并没有特定的规则。有一个很小的区别在于，Java agent接受一个可选的参数，而不是包含零个或更多参数的数组。\n\n如果要使用这个agent，必须要将agent类和资源打包到jar中，并且在jar的manifest中要将Agent-Class属性设置为包含premain方法的agent类。（agent必须要打包到jar文件中，它不能通过拆解的格式进行指定。）接下来，我们需要启动应用程序，并且在命令行中通过javaagent参数来引用jar文件的位置：\n\njava -javaagent:myAgent.jar -jar myProgram.jar\n\n我们还可以在位置路径上设置可选的agent参数。在下面的命令中会启动一个Java程序并且添加给定的agent，将值myOptions作为参数提供给premain方法：\n\njava -javaagent:myAgent.jar=myOptions -jar myProgram.jar\n\n通过重复使用javaagent命令，能够添加多个agent。\n\n但是，Java agent的功能并不局限于修改应用程序环境的状态，Java agent能够访问Java instrumentation API，这样的话，agent就能修改目标应用程序的代码。Java虚拟机中这个鲜为人知的特性提供了一个强大的工具，有助于实现面向切面的编程。\n\n如果要对Java程序进行这种修改，我们需要在agent的premain方法上添加类型为Instrumentation的第二个参数。Instrumentation参数可以用来执行一系列的任务，比如确定对象以字节为单位的精确大小以及通过注册ClassFileTransformers实际修改类的实现。ClassFileTransformers注册之后，当类加载器（class loader）加载类的时候都会调用它。当它被调用时，在类文件所代表的类加载之前，类文件transformer有机会改变或完全替换这个类文件。按照这种方式，在类使用之前，我们能够增强或修改类的行为，如下面的样例所示：\n\npublic class Agent { public static void premain(String argument, Instrumentation inst) {   inst.addTransformer(new ClassFileTransformer() {     @Override     public byte[] transform(       ClassLoader loader,       String className,       Class<?> classBeingRedefined, // 如果类之前没有加载的话，值为null       ProtectionDomain protectionDomain,       byte[] classFileBuffer) {       // 返回改变后的类文件。     }   }); }}\n\n通过使用Instrumentation实例注册上述的ClassFileTransformer之后，每个类加载的时候，都会调用这个transformer。为了实现这一点，transformer会接受一个二进制和类加载器的引用，分别代表了类文件以及试图加载类的类加载器。\n\nJava agent也可以在Java应用的运行期注册，如果是在这种场景下，instrumentation API允许重新定义已加载的类，这个特性被称之为“HotSwap”。不过，重新定义类仅限于替换方法体。在重新定义类的时候，不能新增或移除类成员，并且类型和签名也不能进行修改。当类第一次加载的时候，并没有这种限制，如果是在这样的场景下，那classBeingRedefined会被设置为null。\n\nJava字节码与类文件格式\n\n类文件代表了Java类编译之后的状态。类文件中会包含字节码，这些字节码代表了Java源码中最初的程序指令。Java字节码可以视为Java虚拟机的语言。实际上，JVM并不会将Java视为编程语言，它只能处理字节码。因为它采用二进制的表现形式，所以相对于程序的源码，它占用的空间更少。除此之外，将程序以字节码的形式进行表现能够更容易地编译Java以外的其他语言，如Scala或Clojure，从而让它们运行在JVM上。如果没有字节码作为中间语言的话，那么其他的程序在运行之前，可能还需要将其转换为Java源码。\n\n但是，在代码处理的时候，这种抽象却带来了一定的成本。如果要将ClassFileTransformer应用到某个类上，那我们不能将该类按照Java源码的形式进行处理，甚至不能假设被转换的代码最初是由Java编写而成的。更糟糕的是，探查类成员或注解的反射API也是禁止使用的，这是因为类加载之前，我们无法访问这些API，而在转换进程完成之前，是无法进行加载的。\n\n所幸的是，Java字节码相对来讲是一个比较简单的抽象形式，它包含了很少量的操作，稍微花点功夫我们就能大致将其掌握起来。Java虚拟机执行程序的时候，会以基于栈的方式来处理值。字节码指令一般会告知虚拟机，需要从操作数栈（operand stack）上弹出值，执行一些操作，然后再将结果压到栈中。\n\n让我们考虑一个简单的样例：将数字1和2进行相加操作。JVM首先会将这两个数字压到栈中，这是通过 iconst_1和iconst_2这两个字节指令实现的。iconst_1是个单字节的便捷运算符（operator），它会将数字1压到栈中。与之类似，iconst_2会将数字2压到栈中。然后，会执行iadd指令，它会将栈中最新的两个值弹出，将它们求和计算的结果重新压到栈中。在类文件中，每个指令并不是以其易于记忆的名称进行存储的，而是以一个字节的形式进行存储，这个字节能够唯一地标记特定的指令，这也是bytecode这个术语的来历。上文所述的字节码指令及其对操作数栈的影响，通过下面的图片进行了可视化。\n\n![upload successful](\\images\\pasted-54.png)\n\n对于人类用户来讲，会更喜欢源码而不是字节码，不过幸运的是Java社区创建了多个库，能够解析类文件并将紧凑的字节码暴露为具有名称的指令流。例如，流行的ASM库提供了一个简单的visitor API，它能够将类文件剖析为成员和方法指令，其操作方式类似于阅读XML文件时的SAX解析器。如果使用ASM的话，那上述样例中的字节码可以按照如下的代码来进行实现（在这里，ASM方式的指令是visitIns，能够提供修正的方法实现）：\n\nMethodVisitor methodVisitor = ...methodVisitor.visitIns(Opcodes.ICONST_1);methodVisitor.visitIns(Opcodes.ICONST_2);methodVisitor.visitIns(Opcodes.IADD);\n\n需要注意的是，字节码规范只不过是一种比喻的说法（metaphor），因为Java虚拟机允许将程序转换为优化后的机器码（machine code），只要程序的输出能够保证是正确的即可。因为字节码的简洁性，所以在已有的类中取代和修改指令是很简单直接的。因此，使用ASM及其底层的Java字节码基础就足以实现类转换的Java agent，这需要注册一个ClassFileTransformer，它会使用这个库来处理其参数。\n\n克服字节码的不足\n\n对于实际的应用来讲，解析原始的类文件依然意味着有很多的手动工作。Java程序员通常感兴趣的是类型层级结构中的类。例如，某个Java agent可能需要修改所有实现给定接口的类。如果要确定某个类的超类，那只靠解析ClassFileTransformer所给定的类文件就不够了，类文件中只包含了直接超类和接口的名字。为了解析可能的超类型关联关系，程序员依然需要定位这些类型的类文件。\n\n在项目中直接使用ASM的另外一个困难在于，团队中需要有开发人员学习Java字节码的基础知识。在实践中，这往往会导致很多的开发人员不敢再去修改字节码操作相关的代码。如果这样的话，实现Java agent很容易为项目的长期维护带来风险。\n\n为了克服这些问题，我们最好使用较高层级的抽象来实现Java agent，而不是直接操作Java字节码。Byte Buddy是开源的、基于Apache 2.0许可证的库，它致力于解决字节码操作和instrumentation API的复杂性。Byte Buddy所声称的目标是将显式的字节码操作隐藏在一个类型安全的领域特定语言背后。通过使用Byte Buddy，任何熟悉Java编程语言的人都有望非常容易地进行字节码操作。\n\nByte Buddy简介\n\nByte Buddy的目的并不仅仅是为了生成Java agent。它提供了一个API用于生成任意的Java类，基于这个生成类的API，Byte Buddy提供了额外的API来生成Java agent。\n\n作为Byte Buddy的简介，如下的样例展现了如何生成一个简单的类，这个类是Object的子类，并且重写了toString方法，用来返回“Hello World!”。与原始的ASM类似，“intercept”会告诉Byte Buddy为拦截到的指令提供方法实现：\n\nClass<?> dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(\"toString\"))  .intercept(FixedValue.value(\"Hello World!\"))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();\n\n从上面的代码中，我们可以看到Byte Buddy要实现一个方法分为两步。首先，编程人员需要指定一个ElementMatcher，它负责识别一个或多个需要实现的方法。Byte Buddy提供了功能丰富的预定义拦截器（interceptor），它们暴露在ElementMatchers类中。在上述的例子中，toString方法完全精确匹配了名称，但是，我们也可以匹配更为复杂的代码结构，如类型或注解。\n\n当Byte Buddy生成类的时候，它会分析所生成类型的类层级结构。在上述的例子中，Byte Buddy能够确定所生成的类要继承其超类Object的名为toString的方法，指定的匹配器会要求Byte Buddy重写该方法，这是通过随后的 Implementation 实例实现的，在我们的样例中，这个实例也就是FixedValue。\n\n当创建子类的时候，Byte Buddy始终会拦截（intercept）一个匹配的方法，在生成的类中重写该方法。但是，我们在本文稍后将会看到Byte Buddy还能够重新定义已有的类，而不必通过子类的方式来实现。在这种情况下，Byte Buddy会将已有的代码替换为生成的代码，而将原有的代码复制到另外一个合成的（synthetic）方法中。\n\n在我们上面的代码样例中，匹配的方法进行了重写，在实现里面，返回了固定的值“Hello World!”。intercept方法接受Implementation类型的参数，Byte Buddy自带了多个预先定义的实现，如上文所使用的FixedValue类。但是，如果需要的话，可以使用前文所述的ASM API将某个方法实现为自定义的字节码，Byte Buddy本身也是基于ASM API实现的。\n\n定义完类的属性之后，就能通过make方法来进行生成。在样例应用中，因为用户没有指定类名，所以生成的类会给定一个任意的名称。最终，生成的类将会使用ClassLoadingStrategy来进行加载。通过使用上述的默认 WRAPPER策略，类将会使用一个新的类加载器进行加载，这个类加载器会使用环境类加载器作为父加载器。\n\n类加载之后，使用Java反射API就可以访问它了。如果没有指定其他构造器的话，Byte Buddy将会生成类似于父类的构造器，因此生成的类可以使用默认的构造器。这样，我们就可以检验生成的类重写了 toString方法，如下面的代码所示：\n\nassertThat(dynamicType.newInstance().toString(),            is(\"Hello World!\"));\n\n当然，这个生成的类并没有太大的用处。对于实际的应用来讲，大多数方法的返回值是在运行时计算的，这个计算过程要依赖于方法的参数和对象的状态。\n\n通过委托实现Instrumentation\n\n要实现某个方法，有一种更为灵活的方式，那就是使用Byte Buddy的MethodDelegation。通过使用方法委托，在生成重写的实现时，我们就有可能调用给定类和实例的其他方法。按照这种方式，我们可以使用如下的委托器（delegator）重新编写上述的样例：\n\nclass ToStringInterceptor {  static String intercept() {    return “Hello World!”;  }}\n\n借助上面的POJO拦截器，我们就可以将之前的FixedValue实现替换为MethodDelegation.to(ToStringInterceptor.class)：\n\nClass<?> dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(\"toString\"))  .intercept(MethodDelegation.to(ToStringInterceptor.class))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();\n\n使用上述的委托器，Byte Buddy会在to方法所给定的拦截目标中，确定最优的调用方法。就ToStringInterceptor.class来讲，选择过程只是非常简单地解析这个类型的唯一静态方法而已。在本例中，只会考虑一个静态方法，因为委托的目标中指定的是一个类。与之不同的是，我们还可以将其委托给某个类的实例，如果是这样的话，Byte Buddy将会考虑所有的虚方法（virtual method）。如果类或实例上有多个这样的方法，那么Byte Buddy首先会排除掉所有与指定instrumentation不兼容的方法。在剩余的方法中，库将会选择最佳的匹配者，通常来讲这会是参数最多的方法。我们还可以显式地指定目标方法，这需要缩小合法方法的范围，将ElementMatcher传递到MethodDelegation中，就会进行方法的过滤。例如，通过添加如下的filter，Byte Buddy只会将名为“intercept”的方法视为委托目标：\n\nMethodDelegation.to(ToStringInterceptor.class)                .filter(ElementMatchers.named(“intercept”))\n\n执行上面的拦截之后，被拦截到的方法依然会打印出“Hello World!”，但是这次的结果是动态计算的，这样的话，我们就可以在拦截器方法上设置断点，所生成的类每次调用toString时，都会触发拦截器的方法。\n\n当我们为拦截器方法设置参数时，就能释放出MethodDelegation的全部威力。这里的参数通常是带有注解的，用来要求Byte Buddy在调用拦截器方法时，注入某个特定的值。例如，通过使用@Origin注解，Byte Buddy提供了添加instrument功能的方法的实例，将其作为Java反射API中类的实例：\n\nclass ContextualToStringInterceptor {  static String intercept(@Origin Method m) {    return “Hello World from ” + m.getName() + “!”;  }}\n\n当拦截toString方法时，对instrument方法的调用将会返回“Hello world from toString!”。\n\n除了@Origin注解以外，Byte Buddy提供了一组功能丰富的注解。例如，通过在类型为Callable的参数上使用@Super注解，Byte Buddy会创建并注入一个代理实例，它能够调用被instrument方法的原始代码。如果对于特定的用户场景，所提供的注解不能满足需求或者不太适合的话，我们甚至能够注册自定义的注解，让这些注解注入用户特定的值。\n\n实现方法级别的安全性\n\n可以看到，我们在运行时可以借助简单的Java代码，使用MethodDelegation来动态重写某个方法。这只是一个简单的样例，但是这项技术可以用到更加实际的应用之中。在本文剩余的内容中，我们将会开发一个样例，它会使用代码生成技术实现一个注解驱动的库，用来限制方法级别的安全性。在我们的第一个迭代中，这个库会通过生成子类的方式来限制安全性。然后，我们将会采取相同的方式来实现Java agent，完成相同的功能。\n\n样例库会使用如下的注解，允许用户指定某个方法需要考虑安全因素：\n\n@interface Secured {  String user();}\n\n例如，假设应用需要使用如下的Service类来执行敏感操作，并且只有用户被认证为管理员才能执行该方法。这是通过为执行这个操作的方法声明Secured注解来指定的：\n\nclass Service {  @Secured(user = “ADMIN”)  void doSensitiveAction() {    // 运行敏感代码...  }}\n\n我们当然可以将安全检查直接编写到方法中。在实际中，硬编码横切关注点往往会导致复制-粘贴的逻辑，使其难以维护。另外，一旦应用需要涉及额外的需求时，如日志、收集调用指标或结果缓存，直接添加这样的代码扩展性不会很好。通过将这样的功能抽取到agent中，方法就能很纯粹地关注其业务逻辑，使得代码库能够更易于阅读、测试和维护。\n\n为了让我们规划的库保持尽可能得简单，按照注解的协议声明，如果当前用户不具备注解的用户属性时，将会抛出IllegalStateException异常。通过使用Byte Buddy，这种行为可以用一个简单的拦截器来实现，如下面样例中的SecurityInterceptor所示，它会通过其静态的user域，跟踪当前用户已经进行了登录：\n\nclass SecurityInterceptor {  static String user = “ANONYMOUS”  static void intercept(@Origin Method method) {    if (!method.getAnnotation(Secured.class).user().equals(user)) {      throw new IllegalStateException(“Wrong user”);    }  }}\n\n通过上面的代码，我们可以看到，即便给定用户授予了访问权限，拦截器也没有调用原始的方法。为了解决这个问题，Byte Buddy有很多预定义的方法可以实现功能的链接。借助MethodDelegation类的andThen方法，上述的安全检查可以放到原始方法的调用之前，如下面的代码所示。如果用户没有进行认证的话，安全检查将会抛出异常并阻止后续的执行，因此原始方法将不会执行。\n\n将这些功能集合在一起，我们就能生成Service的一个子类，所有带有注解方法的都能恰当地进行安全保护。因为所生成的类是Service的子类，所以它能够替代所有类型为Service的变量，并不需要任何的类型转换，如果没有恰当认证的话，调用doSensitiveAction方法就会抛出异常：\n\nnew ByteBuddy()  .subclass(Service.class)  .method(ElementMatchers.isAnnotatedBy(Secured.class))  .intercept(MethodDelegation.to(SecurityInterceptor.class)                             .andThen(SuperMethodCall.INSTANCE)))  .make()  .load(getClass().getClassLoader(),           ClassLoadingStrategy.Default.WRAPPER)  .getLoaded()  .newInstance()  .doSensitiveAction();\n\n不过坏消息是，因为实现instrumentation功能的子类是在运行时创建的，所以除了使用Java反射以外，没有其他办法创建这样的实例。因此，所有instrumentation类的实例都应该通过一个工厂来创建，这个工厂会封装创建instrumentation子类的复杂性。这样造成的结果就是，子类instrumentation通常会用于框架之中，这些框架本身就需要通过工厂来创建实例，例如，像依赖管理的框架Spring或对象-关系映射的框架Hibernate，而对于其他类型的应用来讲，子类instrumentation实现起来通常过于复杂。\n\n实现安全功能的Java agent\n\n通过使用Java agent，上述安全框架的一个替代实现将会修改Service类的原始字节码，而不是重写它。这样做的话，我们就没有必要创建托管的实例了，只需简单地调用\n\nnew Service().doSensitiveAction()\n\n即可，如果对应的用户没有进行认证的话，就会抛出异常。为了支持这种方式，Byte Buddy提供一种称之为rebase某个类的理念。当rebase某个类的时候，不会创建子类，所采用的策略是实现instrumentation功能的代码将会合并到被instrument的类中，从而改变其行为。在添加instrumentation功能之后，在被instrument的类中，其所有方法的原始代码均可进行访问，因此像SuperMethodCall这样的instrumentation，工作方式与创建子类是完全一样的。\n\n创建子类与rebase的行为是非常类似的，所以两种操作的API执行方式是一致的，都会使用相同的DynamicType.Builder接口来描述某个类型。两种形式的instrumentation都可以通过ByteBuddy类来进行访问。为了使Java agent的定义更加便利，Byte Buddy还提供了 AgentBuilder类，它希望能够以一种简洁的方式应对一些通用的用户场景。为了定义Java agent实现方法级别的安全性，将如下的类定义为agent的入口点就足以完成该功能了：\n\nclass SecurityAgent {  public static void premain(String arg, Instrumentation inst) {    new AgentBuilder.Default()    .type(ElementMatchers.any())    .transform((builder, type) -> builder    .method(ElementMatchers.isAnnotatedBy(Secured.class)    .intercept(MethodDelegation.to(SecurityInterceptor.class)               .andThen(SuperMethodCall.INSTANCE))))    .installOn(inst);  }}\n\n如果将这个agent打包为jar文件并在命令行中进行指定，那么所有带有Secured注解的方法将会进行“转换”或重定义，从而实现安全保护。如果不激活这个Java agent的话，应用在运行时就不包含额外的安全检查。当然，这意味着如果对带有注解的代码进行单元测试的话，这些方法的调用并不需要特殊的搭建过程来模拟安全上下文。Java运行时会忽略掉无法在classpath中找到的注解类型，因此在运行带有注解的方法时，我们甚至完全可以在应用中移除掉安全库。\n\n另外一项优势在于，Java agent能够很容易地进行叠加。如果在命令行中指定多个Java agent的话，每个agent都有机会对类进行修改，其顺序就是在命令行中所指定的顺序。例如，我们可以采取这种方式将安全、日志以及监控框架联合在一起，而不需要在这些应用间增添任何形式的集成层。因此，使用Java agent实现横切的关注点提供了一种更为模块化的代码编写方式，而不必针对某个管理实例的中心框架来集成所有的代码。\n\n查看英文原文：Easily Create Java Agents with Byte Buddy\n","slug":"javaagent-bytebuddy","published":1,"updated":"2019-04-10T08:01:34.007Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhcl0004sysuvz7jl8ce6","content":"<p>Java agent是在另外一个Java应用（“目标”应用）启动之前要执行的Java程序，这样agent就有机会修改目标应用或者应用所运行的环境。在本文中，我们将会从基础内容开始，逐渐增强其功能，借助字节码操作工具Byte Buddy，使其成为高级的agent实现。</p>\n<p>在最基本的用例中，Java agent会用来设置应用属性或者配置特定的环境状态，agent能够作为可重用和可插入的组件。如下的样例描述了这样的一个agent，它设置了一个系统属性，在实际的程序中就可以使用该属性了：</p>\n<p>public class Agent {  public static void premain(String arg) {    System.setProperty(“my-property”, “foo”);  }}</p>\n<p>如上面的代码所述，Java agent的定义与其他的Java程序类似，只不过它使用premain方法替代main方法作为入口点。顾名思义，这个方法能够在目标应用的main方法之前执行。相对于其他的Java程序，编写agent并没有特定的规则。有一个很小的区别在于，Java agent接受一个可选的参数，而不是包含零个或更多参数的数组。</p>\n<p>如果要使用这个agent，必须要将agent类和资源打包到jar中，并且在jar的manifest中要将Agent-Class属性设置为包含premain方法的agent类。（agent必须要打包到jar文件中，它不能通过拆解的格式进行指定。）接下来，我们需要启动应用程序，并且在命令行中通过javaagent参数来引用jar文件的位置：</p>\n<p>java -javaagent:myAgent.jar -jar myProgram.jar</p>\n<p>我们还可以在位置路径上设置可选的agent参数。在下面的命令中会启动一个Java程序并且添加给定的agent，将值myOptions作为参数提供给premain方法：</p>\n<p>java -javaagent:myAgent.jar=myOptions -jar myProgram.jar</p>\n<p>通过重复使用javaagent命令，能够添加多个agent。</p>\n<p>但是，Java agent的功能并不局限于修改应用程序环境的状态，Java agent能够访问Java instrumentation API，这样的话，agent就能修改目标应用程序的代码。Java虚拟机中这个鲜为人知的特性提供了一个强大的工具，有助于实现面向切面的编程。</p>\n<p>如果要对Java程序进行这种修改，我们需要在agent的premain方法上添加类型为Instrumentation的第二个参数。Instrumentation参数可以用来执行一系列的任务，比如确定对象以字节为单位的精确大小以及通过注册ClassFileTransformers实际修改类的实现。ClassFileTransformers注册之后，当类加载器（class loader）加载类的时候都会调用它。当它被调用时，在类文件所代表的类加载之前，类文件transformer有机会改变或完全替换这个类文件。按照这种方式，在类使用之前，我们能够增强或修改类的行为，如下面的样例所示：</p>\n<p>public class Agent { public static void premain(String argument, Instrumentation inst) {   inst.addTransformer(new ClassFileTransformer() {     @Override     public byte[] transform(       ClassLoader loader,       String className,       Class&lt;?&gt; classBeingRedefined, // 如果类之前没有加载的话，值为null       ProtectionDomain protectionDomain,       byte[] classFileBuffer) {       // 返回改变后的类文件。     }   }); }}</p>\n<p>通过使用Instrumentation实例注册上述的ClassFileTransformer之后，每个类加载的时候，都会调用这个transformer。为了实现这一点，transformer会接受一个二进制和类加载器的引用，分别代表了类文件以及试图加载类的类加载器。</p>\n<p>Java agent也可以在Java应用的运行期注册，如果是在这种场景下，instrumentation API允许重新定义已加载的类，这个特性被称之为“HotSwap”。不过，重新定义类仅限于替换方法体。在重新定义类的时候，不能新增或移除类成员，并且类型和签名也不能进行修改。当类第一次加载的时候，并没有这种限制，如果是在这样的场景下，那classBeingRedefined会被设置为null。</p>\n<p>Java字节码与类文件格式</p>\n<p>类文件代表了Java类编译之后的状态。类文件中会包含字节码，这些字节码代表了Java源码中最初的程序指令。Java字节码可以视为Java虚拟机的语言。实际上，JVM并不会将Java视为编程语言，它只能处理字节码。因为它采用二进制的表现形式，所以相对于程序的源码，它占用的空间更少。除此之外，将程序以字节码的形式进行表现能够更容易地编译Java以外的其他语言，如Scala或Clojure，从而让它们运行在JVM上。如果没有字节码作为中间语言的话，那么其他的程序在运行之前，可能还需要将其转换为Java源码。</p>\n<p>但是，在代码处理的时候，这种抽象却带来了一定的成本。如果要将ClassFileTransformer应用到某个类上，那我们不能将该类按照Java源码的形式进行处理，甚至不能假设被转换的代码最初是由Java编写而成的。更糟糕的是，探查类成员或注解的反射API也是禁止使用的，这是因为类加载之前，我们无法访问这些API，而在转换进程完成之前，是无法进行加载的。</p>\n<p>所幸的是，Java字节码相对来讲是一个比较简单的抽象形式，它包含了很少量的操作，稍微花点功夫我们就能大致将其掌握起来。Java虚拟机执行程序的时候，会以基于栈的方式来处理值。字节码指令一般会告知虚拟机，需要从操作数栈（operand stack）上弹出值，执行一些操作，然后再将结果压到栈中。</p>\n<p>让我们考虑一个简单的样例：将数字1和2进行相加操作。JVM首先会将这两个数字压到栈中，这是通过 iconst_1和iconst_2这两个字节指令实现的。iconst_1是个单字节的便捷运算符（operator），它会将数字1压到栈中。与之类似，iconst_2会将数字2压到栈中。然后，会执行iadd指令，它会将栈中最新的两个值弹出，将它们求和计算的结果重新压到栈中。在类文件中，每个指令并不是以其易于记忆的名称进行存储的，而是以一个字节的形式进行存储，这个字节能够唯一地标记特定的指令，这也是bytecode这个术语的来历。上文所述的字节码指令及其对操作数栈的影响，通过下面的图片进行了可视化。</p>\n<p><img src=\"\\images\\pasted-54.png\" alt=\"upload successful\"></p>\n<p>对于人类用户来讲，会更喜欢源码而不是字节码，不过幸运的是Java社区创建了多个库，能够解析类文件并将紧凑的字节码暴露为具有名称的指令流。例如，流行的ASM库提供了一个简单的visitor API，它能够将类文件剖析为成员和方法指令，其操作方式类似于阅读XML文件时的SAX解析器。如果使用ASM的话，那上述样例中的字节码可以按照如下的代码来进行实现（在这里，ASM方式的指令是visitIns，能够提供修正的方法实现）：</p>\n<p>MethodVisitor methodVisitor = …methodVisitor.visitIns(Opcodes.ICONST_1);methodVisitor.visitIns(Opcodes.ICONST_2);methodVisitor.visitIns(Opcodes.IADD);</p>\n<p>需要注意的是，字节码规范只不过是一种比喻的说法（metaphor），因为Java虚拟机允许将程序转换为优化后的机器码（machine code），只要程序的输出能够保证是正确的即可。因为字节码的简洁性，所以在已有的类中取代和修改指令是很简单直接的。因此，使用ASM及其底层的Java字节码基础就足以实现类转换的Java agent，这需要注册一个ClassFileTransformer，它会使用这个库来处理其参数。</p>\n<p>克服字节码的不足</p>\n<p>对于实际的应用来讲，解析原始的类文件依然意味着有很多的手动工作。Java程序员通常感兴趣的是类型层级结构中的类。例如，某个Java agent可能需要修改所有实现给定接口的类。如果要确定某个类的超类，那只靠解析ClassFileTransformer所给定的类文件就不够了，类文件中只包含了直接超类和接口的名字。为了解析可能的超类型关联关系，程序员依然需要定位这些类型的类文件。</p>\n<p>在项目中直接使用ASM的另外一个困难在于，团队中需要有开发人员学习Java字节码的基础知识。在实践中，这往往会导致很多的开发人员不敢再去修改字节码操作相关的代码。如果这样的话，实现Java agent很容易为项目的长期维护带来风险。</p>\n<p>为了克服这些问题，我们最好使用较高层级的抽象来实现Java agent，而不是直接操作Java字节码。Byte Buddy是开源的、基于Apache 2.0许可证的库，它致力于解决字节码操作和instrumentation API的复杂性。Byte Buddy所声称的目标是将显式的字节码操作隐藏在一个类型安全的领域特定语言背后。通过使用Byte Buddy，任何熟悉Java编程语言的人都有望非常容易地进行字节码操作。</p>\n<p>Byte Buddy简介</p>\n<p>Byte Buddy的目的并不仅仅是为了生成Java agent。它提供了一个API用于生成任意的Java类，基于这个生成类的API，Byte Buddy提供了额外的API来生成Java agent。</p>\n<p>作为Byte Buddy的简介，如下的样例展现了如何生成一个简单的类，这个类是Object的子类，并且重写了toString方法，用来返回“Hello World!”。与原始的ASM类似，“intercept”会告诉Byte Buddy为拦截到的指令提供方法实现：</p>\n<p>Class&lt;?&gt; dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(“toString”))  .intercept(FixedValue.value(“Hello World!”))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();</p>\n<p>从上面的代码中，我们可以看到Byte Buddy要实现一个方法分为两步。首先，编程人员需要指定一个ElementMatcher，它负责识别一个或多个需要实现的方法。Byte Buddy提供了功能丰富的预定义拦截器（interceptor），它们暴露在ElementMatchers类中。在上述的例子中，toString方法完全精确匹配了名称，但是，我们也可以匹配更为复杂的代码结构，如类型或注解。</p>\n<p>当Byte Buddy生成类的时候，它会分析所生成类型的类层级结构。在上述的例子中，Byte Buddy能够确定所生成的类要继承其超类Object的名为toString的方法，指定的匹配器会要求Byte Buddy重写该方法，这是通过随后的 Implementation 实例实现的，在我们的样例中，这个实例也就是FixedValue。</p>\n<p>当创建子类的时候，Byte Buddy始终会拦截（intercept）一个匹配的方法，在生成的类中重写该方法。但是，我们在本文稍后将会看到Byte Buddy还能够重新定义已有的类，而不必通过子类的方式来实现。在这种情况下，Byte Buddy会将已有的代码替换为生成的代码，而将原有的代码复制到另外一个合成的（synthetic）方法中。</p>\n<p>在我们上面的代码样例中，匹配的方法进行了重写，在实现里面，返回了固定的值“Hello World!”。intercept方法接受Implementation类型的参数，Byte Buddy自带了多个预先定义的实现，如上文所使用的FixedValue类。但是，如果需要的话，可以使用前文所述的ASM API将某个方法实现为自定义的字节码，Byte Buddy本身也是基于ASM API实现的。</p>\n<p>定义完类的属性之后，就能通过make方法来进行生成。在样例应用中，因为用户没有指定类名，所以生成的类会给定一个任意的名称。最终，生成的类将会使用ClassLoadingStrategy来进行加载。通过使用上述的默认 WRAPPER策略，类将会使用一个新的类加载器进行加载，这个类加载器会使用环境类加载器作为父加载器。</p>\n<p>类加载之后，使用Java反射API就可以访问它了。如果没有指定其他构造器的话，Byte Buddy将会生成类似于父类的构造器，因此生成的类可以使用默认的构造器。这样，我们就可以检验生成的类重写了 toString方法，如下面的代码所示：</p>\n<p>assertThat(dynamicType.newInstance().toString(),            is(“Hello World!”));</p>\n<p>当然，这个生成的类并没有太大的用处。对于实际的应用来讲，大多数方法的返回值是在运行时计算的，这个计算过程要依赖于方法的参数和对象的状态。</p>\n<p>通过委托实现Instrumentation</p>\n<p>要实现某个方法，有一种更为灵活的方式，那就是使用Byte Buddy的MethodDelegation。通过使用方法委托，在生成重写的实现时，我们就有可能调用给定类和实例的其他方法。按照这种方式，我们可以使用如下的委托器（delegator）重新编写上述的样例：</p>\n<p>class ToStringInterceptor {  static String intercept() {    return “Hello World!”;  }}</p>\n<p>借助上面的POJO拦截器，我们就可以将之前的FixedValue实现替换为MethodDelegation.to(ToStringInterceptor.class)：</p>\n<p>Class&lt;?&gt; dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(“toString”))  .intercept(MethodDelegation.to(ToStringInterceptor.class))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();</p>\n<p>使用上述的委托器，Byte Buddy会在to方法所给定的拦截目标中，确定最优的调用方法。就ToStringInterceptor.class来讲，选择过程只是非常简单地解析这个类型的唯一静态方法而已。在本例中，只会考虑一个静态方法，因为委托的目标中指定的是一个类。与之不同的是，我们还可以将其委托给某个类的实例，如果是这样的话，Byte Buddy将会考虑所有的虚方法（virtual method）。如果类或实例上有多个这样的方法，那么Byte Buddy首先会排除掉所有与指定instrumentation不兼容的方法。在剩余的方法中，库将会选择最佳的匹配者，通常来讲这会是参数最多的方法。我们还可以显式地指定目标方法，这需要缩小合法方法的范围，将ElementMatcher传递到MethodDelegation中，就会进行方法的过滤。例如，通过添加如下的filter，Byte Buddy只会将名为“intercept”的方法视为委托目标：</p>\n<p>MethodDelegation.to(ToStringInterceptor.class)                .filter(ElementMatchers.named(“intercept”))</p>\n<p>执行上面的拦截之后，被拦截到的方法依然会打印出“Hello World!”，但是这次的结果是动态计算的，这样的话，我们就可以在拦截器方法上设置断点，所生成的类每次调用toString时，都会触发拦截器的方法。</p>\n<p>当我们为拦截器方法设置参数时，就能释放出MethodDelegation的全部威力。这里的参数通常是带有注解的，用来要求Byte Buddy在调用拦截器方法时，注入某个特定的值。例如，通过使用@Origin注解，Byte Buddy提供了添加instrument功能的方法的实例，将其作为Java反射API中类的实例：</p>\n<p>class ContextualToStringInterceptor {  static String intercept(@Origin Method m) {    return “Hello World from ” + m.getName() + “!”;  }}</p>\n<p>当拦截toString方法时，对instrument方法的调用将会返回“Hello world from toString!”。</p>\n<p>除了@Origin注解以外，Byte Buddy提供了一组功能丰富的注解。例如，通过在类型为Callable的参数上使用@Super注解，Byte Buddy会创建并注入一个代理实例，它能够调用被instrument方法的原始代码。如果对于特定的用户场景，所提供的注解不能满足需求或者不太适合的话，我们甚至能够注册自定义的注解，让这些注解注入用户特定的值。</p>\n<p>实现方法级别的安全性</p>\n<p>可以看到，我们在运行时可以借助简单的Java代码，使用MethodDelegation来动态重写某个方法。这只是一个简单的样例，但是这项技术可以用到更加实际的应用之中。在本文剩余的内容中，我们将会开发一个样例，它会使用代码生成技术实现一个注解驱动的库，用来限制方法级别的安全性。在我们的第一个迭代中，这个库会通过生成子类的方式来限制安全性。然后，我们将会采取相同的方式来实现Java agent，完成相同的功能。</p>\n<p>样例库会使用如下的注解，允许用户指定某个方法需要考虑安全因素：</p>\n<p>@interface Secured {  String user();}</p>\n<p>例如，假设应用需要使用如下的Service类来执行敏感操作，并且只有用户被认证为管理员才能执行该方法。这是通过为执行这个操作的方法声明Secured注解来指定的：</p>\n<p>class Service {  @Secured(user = “ADMIN”)  void doSensitiveAction() {    // 运行敏感代码…  }}</p>\n<p>我们当然可以将安全检查直接编写到方法中。在实际中，硬编码横切关注点往往会导致复制-粘贴的逻辑，使其难以维护。另外，一旦应用需要涉及额外的需求时，如日志、收集调用指标或结果缓存，直接添加这样的代码扩展性不会很好。通过将这样的功能抽取到agent中，方法就能很纯粹地关注其业务逻辑，使得代码库能够更易于阅读、测试和维护。</p>\n<p>为了让我们规划的库保持尽可能得简单，按照注解的协议声明，如果当前用户不具备注解的用户属性时，将会抛出IllegalStateException异常。通过使用Byte Buddy，这种行为可以用一个简单的拦截器来实现，如下面样例中的SecurityInterceptor所示，它会通过其静态的user域，跟踪当前用户已经进行了登录：</p>\n<p>class SecurityInterceptor {  static String user = “ANONYMOUS”  static void intercept(@Origin Method method) {    if (!method.getAnnotation(Secured.class).user().equals(user)) {      throw new IllegalStateException(“Wrong user”);    }  }}</p>\n<p>通过上面的代码，我们可以看到，即便给定用户授予了访问权限，拦截器也没有调用原始的方法。为了解决这个问题，Byte Buddy有很多预定义的方法可以实现功能的链接。借助MethodDelegation类的andThen方法，上述的安全检查可以放到原始方法的调用之前，如下面的代码所示。如果用户没有进行认证的话，安全检查将会抛出异常并阻止后续的执行，因此原始方法将不会执行。</p>\n<p>将这些功能集合在一起，我们就能生成Service的一个子类，所有带有注解方法的都能恰当地进行安全保护。因为所生成的类是Service的子类，所以它能够替代所有类型为Service的变量，并不需要任何的类型转换，如果没有恰当认证的话，调用doSensitiveAction方法就会抛出异常：</p>\n<p>new ByteBuddy()  .subclass(Service.class)  .method(ElementMatchers.isAnnotatedBy(Secured.class))  .intercept(MethodDelegation.to(SecurityInterceptor.class)                             .andThen(SuperMethodCall.INSTANCE)))  .make()  .load(getClass().getClassLoader(),           ClassLoadingStrategy.Default.WRAPPER)  .getLoaded()  .newInstance()  .doSensitiveAction();</p>\n<p>不过坏消息是，因为实现instrumentation功能的子类是在运行时创建的，所以除了使用Java反射以外，没有其他办法创建这样的实例。因此，所有instrumentation类的实例都应该通过一个工厂来创建，这个工厂会封装创建instrumentation子类的复杂性。这样造成的结果就是，子类instrumentation通常会用于框架之中，这些框架本身就需要通过工厂来创建实例，例如，像依赖管理的框架Spring或对象-关系映射的框架Hibernate，而对于其他类型的应用来讲，子类instrumentation实现起来通常过于复杂。</p>\n<p>实现安全功能的Java agent</p>\n<p>通过使用Java agent，上述安全框架的一个替代实现将会修改Service类的原始字节码，而不是重写它。这样做的话，我们就没有必要创建托管的实例了，只需简单地调用</p>\n<p>new Service().doSensitiveAction()</p>\n<p>即可，如果对应的用户没有进行认证的话，就会抛出异常。为了支持这种方式，Byte Buddy提供一种称之为rebase某个类的理念。当rebase某个类的时候，不会创建子类，所采用的策略是实现instrumentation功能的代码将会合并到被instrument的类中，从而改变其行为。在添加instrumentation功能之后，在被instrument的类中，其所有方法的原始代码均可进行访问，因此像SuperMethodCall这样的instrumentation，工作方式与创建子类是完全一样的。</p>\n<p>创建子类与rebase的行为是非常类似的，所以两种操作的API执行方式是一致的，都会使用相同的DynamicType.Builder接口来描述某个类型。两种形式的instrumentation都可以通过ByteBuddy类来进行访问。为了使Java agent的定义更加便利，Byte Buddy还提供了 AgentBuilder类，它希望能够以一种简洁的方式应对一些通用的用户场景。为了定义Java agent实现方法级别的安全性，将如下的类定义为agent的入口点就足以完成该功能了：</p>\n<p>class SecurityAgent {  public static void premain(String arg, Instrumentation inst) {    new AgentBuilder.Default()    .type(ElementMatchers.any())    .transform((builder, type) -&gt; builder    .method(ElementMatchers.isAnnotatedBy(Secured.class)    .intercept(MethodDelegation.to(SecurityInterceptor.class)               .andThen(SuperMethodCall.INSTANCE))))    .installOn(inst);  }}</p>\n<p>如果将这个agent打包为jar文件并在命令行中进行指定，那么所有带有Secured注解的方法将会进行“转换”或重定义，从而实现安全保护。如果不激活这个Java agent的话，应用在运行时就不包含额外的安全检查。当然，这意味着如果对带有注解的代码进行单元测试的话，这些方法的调用并不需要特殊的搭建过程来模拟安全上下文。Java运行时会忽略掉无法在classpath中找到的注解类型，因此在运行带有注解的方法时，我们甚至完全可以在应用中移除掉安全库。</p>\n<p>另外一项优势在于，Java agent能够很容易地进行叠加。如果在命令行中指定多个Java agent的话，每个agent都有机会对类进行修改，其顺序就是在命令行中所指定的顺序。例如，我们可以采取这种方式将安全、日志以及监控框架联合在一起，而不需要在这些应用间增添任何形式的集成层。因此，使用Java agent实现横切的关注点提供了一种更为模块化的代码编写方式，而不必针对某个管理实例的中心框架来集成所有的代码。</p>\n<p>查看英文原文：Easily Create Java Agents with Byte Buddy</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Java agent是在另外一个Java应用（“目标”应用）启动之前要执行的Java程序，这样agent就有机会修改目标应用或者应用所运行的环境。在本文中，我们将会从基础内容开始，逐渐增强其功能，借助字节码操作工具Byte Buddy，使其成为高级的agent实现。</p>\n<p>在最基本的用例中，Java agent会用来设置应用属性或者配置特定的环境状态，agent能够作为可重用和可插入的组件。如下的样例描述了这样的一个agent，它设置了一个系统属性，在实际的程序中就可以使用该属性了：</p>\n<p>public class Agent {  public static void premain(String arg) {    System.setProperty(“my-property”, “foo”);  }}</p>\n<p>如上面的代码所述，Java agent的定义与其他的Java程序类似，只不过它使用premain方法替代main方法作为入口点。顾名思义，这个方法能够在目标应用的main方法之前执行。相对于其他的Java程序，编写agent并没有特定的规则。有一个很小的区别在于，Java agent接受一个可选的参数，而不是包含零个或更多参数的数组。</p>\n<p>如果要使用这个agent，必须要将agent类和资源打包到jar中，并且在jar的manifest中要将Agent-Class属性设置为包含premain方法的agent类。（agent必须要打包到jar文件中，它不能通过拆解的格式进行指定。）接下来，我们需要启动应用程序，并且在命令行中通过javaagent参数来引用jar文件的位置：</p>\n<p>java -javaagent:myAgent.jar -jar myProgram.jar</p>\n<p>我们还可以在位置路径上设置可选的agent参数。在下面的命令中会启动一个Java程序并且添加给定的agent，将值myOptions作为参数提供给premain方法：</p>\n<p>java -javaagent:myAgent.jar=myOptions -jar myProgram.jar</p>\n<p>通过重复使用javaagent命令，能够添加多个agent。</p>\n<p>但是，Java agent的功能并不局限于修改应用程序环境的状态，Java agent能够访问Java instrumentation API，这样的话，agent就能修改目标应用程序的代码。Java虚拟机中这个鲜为人知的特性提供了一个强大的工具，有助于实现面向切面的编程。</p>\n<p>如果要对Java程序进行这种修改，我们需要在agent的premain方法上添加类型为Instrumentation的第二个参数。Instrumentation参数可以用来执行一系列的任务，比如确定对象以字节为单位的精确大小以及通过注册ClassFileTransformers实际修改类的实现。ClassFileTransformers注册之后，当类加载器（class loader）加载类的时候都会调用它。当它被调用时，在类文件所代表的类加载之前，类文件transformer有机会改变或完全替换这个类文件。按照这种方式，在类使用之前，我们能够增强或修改类的行为，如下面的样例所示：</p>\n<p>public class Agent { public static void premain(String argument, Instrumentation inst) {   inst.addTransformer(new ClassFileTransformer() {     @Override     public byte[] transform(       ClassLoader loader,       String className,       Class&lt;?&gt; classBeingRedefined, // 如果类之前没有加载的话，值为null       ProtectionDomain protectionDomain,       byte[] classFileBuffer) {       // 返回改变后的类文件。     }   }); }}</p>\n<p>通过使用Instrumentation实例注册上述的ClassFileTransformer之后，每个类加载的时候，都会调用这个transformer。为了实现这一点，transformer会接受一个二进制和类加载器的引用，分别代表了类文件以及试图加载类的类加载器。</p>\n<p>Java agent也可以在Java应用的运行期注册，如果是在这种场景下，instrumentation API允许重新定义已加载的类，这个特性被称之为“HotSwap”。不过，重新定义类仅限于替换方法体。在重新定义类的时候，不能新增或移除类成员，并且类型和签名也不能进行修改。当类第一次加载的时候，并没有这种限制，如果是在这样的场景下，那classBeingRedefined会被设置为null。</p>\n<p>Java字节码与类文件格式</p>\n<p>类文件代表了Java类编译之后的状态。类文件中会包含字节码，这些字节码代表了Java源码中最初的程序指令。Java字节码可以视为Java虚拟机的语言。实际上，JVM并不会将Java视为编程语言，它只能处理字节码。因为它采用二进制的表现形式，所以相对于程序的源码，它占用的空间更少。除此之外，将程序以字节码的形式进行表现能够更容易地编译Java以外的其他语言，如Scala或Clojure，从而让它们运行在JVM上。如果没有字节码作为中间语言的话，那么其他的程序在运行之前，可能还需要将其转换为Java源码。</p>\n<p>但是，在代码处理的时候，这种抽象却带来了一定的成本。如果要将ClassFileTransformer应用到某个类上，那我们不能将该类按照Java源码的形式进行处理，甚至不能假设被转换的代码最初是由Java编写而成的。更糟糕的是，探查类成员或注解的反射API也是禁止使用的，这是因为类加载之前，我们无法访问这些API，而在转换进程完成之前，是无法进行加载的。</p>\n<p>所幸的是，Java字节码相对来讲是一个比较简单的抽象形式，它包含了很少量的操作，稍微花点功夫我们就能大致将其掌握起来。Java虚拟机执行程序的时候，会以基于栈的方式来处理值。字节码指令一般会告知虚拟机，需要从操作数栈（operand stack）上弹出值，执行一些操作，然后再将结果压到栈中。</p>\n<p>让我们考虑一个简单的样例：将数字1和2进行相加操作。JVM首先会将这两个数字压到栈中，这是通过 iconst_1和iconst_2这两个字节指令实现的。iconst_1是个单字节的便捷运算符（operator），它会将数字1压到栈中。与之类似，iconst_2会将数字2压到栈中。然后，会执行iadd指令，它会将栈中最新的两个值弹出，将它们求和计算的结果重新压到栈中。在类文件中，每个指令并不是以其易于记忆的名称进行存储的，而是以一个字节的形式进行存储，这个字节能够唯一地标记特定的指令，这也是bytecode这个术语的来历。上文所述的字节码指令及其对操作数栈的影响，通过下面的图片进行了可视化。</p>\n<p><img src=\"\\images\\pasted-54.png\" alt=\"upload successful\"></p>\n<p>对于人类用户来讲，会更喜欢源码而不是字节码，不过幸运的是Java社区创建了多个库，能够解析类文件并将紧凑的字节码暴露为具有名称的指令流。例如，流行的ASM库提供了一个简单的visitor API，它能够将类文件剖析为成员和方法指令，其操作方式类似于阅读XML文件时的SAX解析器。如果使用ASM的话，那上述样例中的字节码可以按照如下的代码来进行实现（在这里，ASM方式的指令是visitIns，能够提供修正的方法实现）：</p>\n<p>MethodVisitor methodVisitor = …methodVisitor.visitIns(Opcodes.ICONST_1);methodVisitor.visitIns(Opcodes.ICONST_2);methodVisitor.visitIns(Opcodes.IADD);</p>\n<p>需要注意的是，字节码规范只不过是一种比喻的说法（metaphor），因为Java虚拟机允许将程序转换为优化后的机器码（machine code），只要程序的输出能够保证是正确的即可。因为字节码的简洁性，所以在已有的类中取代和修改指令是很简单直接的。因此，使用ASM及其底层的Java字节码基础就足以实现类转换的Java agent，这需要注册一个ClassFileTransformer，它会使用这个库来处理其参数。</p>\n<p>克服字节码的不足</p>\n<p>对于实际的应用来讲，解析原始的类文件依然意味着有很多的手动工作。Java程序员通常感兴趣的是类型层级结构中的类。例如，某个Java agent可能需要修改所有实现给定接口的类。如果要确定某个类的超类，那只靠解析ClassFileTransformer所给定的类文件就不够了，类文件中只包含了直接超类和接口的名字。为了解析可能的超类型关联关系，程序员依然需要定位这些类型的类文件。</p>\n<p>在项目中直接使用ASM的另外一个困难在于，团队中需要有开发人员学习Java字节码的基础知识。在实践中，这往往会导致很多的开发人员不敢再去修改字节码操作相关的代码。如果这样的话，实现Java agent很容易为项目的长期维护带来风险。</p>\n<p>为了克服这些问题，我们最好使用较高层级的抽象来实现Java agent，而不是直接操作Java字节码。Byte Buddy是开源的、基于Apache 2.0许可证的库，它致力于解决字节码操作和instrumentation API的复杂性。Byte Buddy所声称的目标是将显式的字节码操作隐藏在一个类型安全的领域特定语言背后。通过使用Byte Buddy，任何熟悉Java编程语言的人都有望非常容易地进行字节码操作。</p>\n<p>Byte Buddy简介</p>\n<p>Byte Buddy的目的并不仅仅是为了生成Java agent。它提供了一个API用于生成任意的Java类，基于这个生成类的API，Byte Buddy提供了额外的API来生成Java agent。</p>\n<p>作为Byte Buddy的简介，如下的样例展现了如何生成一个简单的类，这个类是Object的子类，并且重写了toString方法，用来返回“Hello World!”。与原始的ASM类似，“intercept”会告诉Byte Buddy为拦截到的指令提供方法实现：</p>\n<p>Class&lt;?&gt; dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(“toString”))  .intercept(FixedValue.value(“Hello World!”))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();</p>\n<p>从上面的代码中，我们可以看到Byte Buddy要实现一个方法分为两步。首先，编程人员需要指定一个ElementMatcher，它负责识别一个或多个需要实现的方法。Byte Buddy提供了功能丰富的预定义拦截器（interceptor），它们暴露在ElementMatchers类中。在上述的例子中，toString方法完全精确匹配了名称，但是，我们也可以匹配更为复杂的代码结构，如类型或注解。</p>\n<p>当Byte Buddy生成类的时候，它会分析所生成类型的类层级结构。在上述的例子中，Byte Buddy能够确定所生成的类要继承其超类Object的名为toString的方法，指定的匹配器会要求Byte Buddy重写该方法，这是通过随后的 Implementation 实例实现的，在我们的样例中，这个实例也就是FixedValue。</p>\n<p>当创建子类的时候，Byte Buddy始终会拦截（intercept）一个匹配的方法，在生成的类中重写该方法。但是，我们在本文稍后将会看到Byte Buddy还能够重新定义已有的类，而不必通过子类的方式来实现。在这种情况下，Byte Buddy会将已有的代码替换为生成的代码，而将原有的代码复制到另外一个合成的（synthetic）方法中。</p>\n<p>在我们上面的代码样例中，匹配的方法进行了重写，在实现里面，返回了固定的值“Hello World!”。intercept方法接受Implementation类型的参数，Byte Buddy自带了多个预先定义的实现，如上文所使用的FixedValue类。但是，如果需要的话，可以使用前文所述的ASM API将某个方法实现为自定义的字节码，Byte Buddy本身也是基于ASM API实现的。</p>\n<p>定义完类的属性之后，就能通过make方法来进行生成。在样例应用中，因为用户没有指定类名，所以生成的类会给定一个任意的名称。最终，生成的类将会使用ClassLoadingStrategy来进行加载。通过使用上述的默认 WRAPPER策略，类将会使用一个新的类加载器进行加载，这个类加载器会使用环境类加载器作为父加载器。</p>\n<p>类加载之后，使用Java反射API就可以访问它了。如果没有指定其他构造器的话，Byte Buddy将会生成类似于父类的构造器，因此生成的类可以使用默认的构造器。这样，我们就可以检验生成的类重写了 toString方法，如下面的代码所示：</p>\n<p>assertThat(dynamicType.newInstance().toString(),            is(“Hello World!”));</p>\n<p>当然，这个生成的类并没有太大的用处。对于实际的应用来讲，大多数方法的返回值是在运行时计算的，这个计算过程要依赖于方法的参数和对象的状态。</p>\n<p>通过委托实现Instrumentation</p>\n<p>要实现某个方法，有一种更为灵活的方式，那就是使用Byte Buddy的MethodDelegation。通过使用方法委托，在生成重写的实现时，我们就有可能调用给定类和实例的其他方法。按照这种方式，我们可以使用如下的委托器（delegator）重新编写上述的样例：</p>\n<p>class ToStringInterceptor {  static String intercept() {    return “Hello World!”;  }}</p>\n<p>借助上面的POJO拦截器，我们就可以将之前的FixedValue实现替换为MethodDelegation.to(ToStringInterceptor.class)：</p>\n<p>Class&lt;?&gt; dynamicType = new ByteBuddy()  .subclass(Object.class)  .method(ElementMatchers.named(“toString”))  .intercept(MethodDelegation.to(ToStringInterceptor.class))  .make()  .load(getClass().getClassLoader(),                  ClassLoadingStrategy.Default.WRAPPER)  .getLoaded();</p>\n<p>使用上述的委托器，Byte Buddy会在to方法所给定的拦截目标中，确定最优的调用方法。就ToStringInterceptor.class来讲，选择过程只是非常简单地解析这个类型的唯一静态方法而已。在本例中，只会考虑一个静态方法，因为委托的目标中指定的是一个类。与之不同的是，我们还可以将其委托给某个类的实例，如果是这样的话，Byte Buddy将会考虑所有的虚方法（virtual method）。如果类或实例上有多个这样的方法，那么Byte Buddy首先会排除掉所有与指定instrumentation不兼容的方法。在剩余的方法中，库将会选择最佳的匹配者，通常来讲这会是参数最多的方法。我们还可以显式地指定目标方法，这需要缩小合法方法的范围，将ElementMatcher传递到MethodDelegation中，就会进行方法的过滤。例如，通过添加如下的filter，Byte Buddy只会将名为“intercept”的方法视为委托目标：</p>\n<p>MethodDelegation.to(ToStringInterceptor.class)                .filter(ElementMatchers.named(“intercept”))</p>\n<p>执行上面的拦截之后，被拦截到的方法依然会打印出“Hello World!”，但是这次的结果是动态计算的，这样的话，我们就可以在拦截器方法上设置断点，所生成的类每次调用toString时，都会触发拦截器的方法。</p>\n<p>当我们为拦截器方法设置参数时，就能释放出MethodDelegation的全部威力。这里的参数通常是带有注解的，用来要求Byte Buddy在调用拦截器方法时，注入某个特定的值。例如，通过使用@Origin注解，Byte Buddy提供了添加instrument功能的方法的实例，将其作为Java反射API中类的实例：</p>\n<p>class ContextualToStringInterceptor {  static String intercept(@Origin Method m) {    return “Hello World from ” + m.getName() + “!”;  }}</p>\n<p>当拦截toString方法时，对instrument方法的调用将会返回“Hello world from toString!”。</p>\n<p>除了@Origin注解以外，Byte Buddy提供了一组功能丰富的注解。例如，通过在类型为Callable的参数上使用@Super注解，Byte Buddy会创建并注入一个代理实例，它能够调用被instrument方法的原始代码。如果对于特定的用户场景，所提供的注解不能满足需求或者不太适合的话，我们甚至能够注册自定义的注解，让这些注解注入用户特定的值。</p>\n<p>实现方法级别的安全性</p>\n<p>可以看到，我们在运行时可以借助简单的Java代码，使用MethodDelegation来动态重写某个方法。这只是一个简单的样例，但是这项技术可以用到更加实际的应用之中。在本文剩余的内容中，我们将会开发一个样例，它会使用代码生成技术实现一个注解驱动的库，用来限制方法级别的安全性。在我们的第一个迭代中，这个库会通过生成子类的方式来限制安全性。然后，我们将会采取相同的方式来实现Java agent，完成相同的功能。</p>\n<p>样例库会使用如下的注解，允许用户指定某个方法需要考虑安全因素：</p>\n<p>@interface Secured {  String user();}</p>\n<p>例如，假设应用需要使用如下的Service类来执行敏感操作，并且只有用户被认证为管理员才能执行该方法。这是通过为执行这个操作的方法声明Secured注解来指定的：</p>\n<p>class Service {  @Secured(user = “ADMIN”)  void doSensitiveAction() {    // 运行敏感代码…  }}</p>\n<p>我们当然可以将安全检查直接编写到方法中。在实际中，硬编码横切关注点往往会导致复制-粘贴的逻辑，使其难以维护。另外，一旦应用需要涉及额外的需求时，如日志、收集调用指标或结果缓存，直接添加这样的代码扩展性不会很好。通过将这样的功能抽取到agent中，方法就能很纯粹地关注其业务逻辑，使得代码库能够更易于阅读、测试和维护。</p>\n<p>为了让我们规划的库保持尽可能得简单，按照注解的协议声明，如果当前用户不具备注解的用户属性时，将会抛出IllegalStateException异常。通过使用Byte Buddy，这种行为可以用一个简单的拦截器来实现，如下面样例中的SecurityInterceptor所示，它会通过其静态的user域，跟踪当前用户已经进行了登录：</p>\n<p>class SecurityInterceptor {  static String user = “ANONYMOUS”  static void intercept(@Origin Method method) {    if (!method.getAnnotation(Secured.class).user().equals(user)) {      throw new IllegalStateException(“Wrong user”);    }  }}</p>\n<p>通过上面的代码，我们可以看到，即便给定用户授予了访问权限，拦截器也没有调用原始的方法。为了解决这个问题，Byte Buddy有很多预定义的方法可以实现功能的链接。借助MethodDelegation类的andThen方法，上述的安全检查可以放到原始方法的调用之前，如下面的代码所示。如果用户没有进行认证的话，安全检查将会抛出异常并阻止后续的执行，因此原始方法将不会执行。</p>\n<p>将这些功能集合在一起，我们就能生成Service的一个子类，所有带有注解方法的都能恰当地进行安全保护。因为所生成的类是Service的子类，所以它能够替代所有类型为Service的变量，并不需要任何的类型转换，如果没有恰当认证的话，调用doSensitiveAction方法就会抛出异常：</p>\n<p>new ByteBuddy()  .subclass(Service.class)  .method(ElementMatchers.isAnnotatedBy(Secured.class))  .intercept(MethodDelegation.to(SecurityInterceptor.class)                             .andThen(SuperMethodCall.INSTANCE)))  .make()  .load(getClass().getClassLoader(),           ClassLoadingStrategy.Default.WRAPPER)  .getLoaded()  .newInstance()  .doSensitiveAction();</p>\n<p>不过坏消息是，因为实现instrumentation功能的子类是在运行时创建的，所以除了使用Java反射以外，没有其他办法创建这样的实例。因此，所有instrumentation类的实例都应该通过一个工厂来创建，这个工厂会封装创建instrumentation子类的复杂性。这样造成的结果就是，子类instrumentation通常会用于框架之中，这些框架本身就需要通过工厂来创建实例，例如，像依赖管理的框架Spring或对象-关系映射的框架Hibernate，而对于其他类型的应用来讲，子类instrumentation实现起来通常过于复杂。</p>\n<p>实现安全功能的Java agent</p>\n<p>通过使用Java agent，上述安全框架的一个替代实现将会修改Service类的原始字节码，而不是重写它。这样做的话，我们就没有必要创建托管的实例了，只需简单地调用</p>\n<p>new Service().doSensitiveAction()</p>\n<p>即可，如果对应的用户没有进行认证的话，就会抛出异常。为了支持这种方式，Byte Buddy提供一种称之为rebase某个类的理念。当rebase某个类的时候，不会创建子类，所采用的策略是实现instrumentation功能的代码将会合并到被instrument的类中，从而改变其行为。在添加instrumentation功能之后，在被instrument的类中，其所有方法的原始代码均可进行访问，因此像SuperMethodCall这样的instrumentation，工作方式与创建子类是完全一样的。</p>\n<p>创建子类与rebase的行为是非常类似的，所以两种操作的API执行方式是一致的，都会使用相同的DynamicType.Builder接口来描述某个类型。两种形式的instrumentation都可以通过ByteBuddy类来进行访问。为了使Java agent的定义更加便利，Byte Buddy还提供了 AgentBuilder类，它希望能够以一种简洁的方式应对一些通用的用户场景。为了定义Java agent实现方法级别的安全性，将如下的类定义为agent的入口点就足以完成该功能了：</p>\n<p>class SecurityAgent {  public static void premain(String arg, Instrumentation inst) {    new AgentBuilder.Default()    .type(ElementMatchers.any())    .transform((builder, type) -&gt; builder    .method(ElementMatchers.isAnnotatedBy(Secured.class)    .intercept(MethodDelegation.to(SecurityInterceptor.class)               .andThen(SuperMethodCall.INSTANCE))))    .installOn(inst);  }}</p>\n<p>如果将这个agent打包为jar文件并在命令行中进行指定，那么所有带有Secured注解的方法将会进行“转换”或重定义，从而实现安全保护。如果不激活这个Java agent的话，应用在运行时就不包含额外的安全检查。当然，这意味着如果对带有注解的代码进行单元测试的话，这些方法的调用并不需要特殊的搭建过程来模拟安全上下文。Java运行时会忽略掉无法在classpath中找到的注解类型，因此在运行带有注解的方法时，我们甚至完全可以在应用中移除掉安全库。</p>\n<p>另外一项优势在于，Java agent能够很容易地进行叠加。如果在命令行中指定多个Java agent的话，每个agent都有机会对类进行修改，其顺序就是在命令行中所指定的顺序。例如，我们可以采取这种方式将安全、日志以及监控框架联合在一起，而不需要在这些应用间增添任何形式的集成层。因此，使用Java agent实现横切的关注点提供了一种更为模块化的代码编写方式，而不必针对某个管理实例的中心框架来集成所有的代码。</p>\n<p>查看英文原文：Easily Create Java Agents with Byte Buddy</p>\n"},{"title":"数据库-kill服务进程引发的血案","author":"Xiang Chuang","date":"2018-07-30T03:01:00.000Z","_content":"1、问题描述：\n18.07.27， 10：50分dba进行mysql数据库碎片整理，11：04分，发现数据库连接爆满，此时应用已处于down掉的状态，11：22数据库强行kill，11：40分之前发现应用并没有进行新的连接，此时停止应用发现停不下来，不得不kill掉应用进程，重启后恢复。但此时发现，之前入库的记录并没有成功，而mq由于没有收到应用的ack确认消息，消息重新进入队列并重发，加上数据没入库，交易进行了重复的操作！由于是全名抢车业务，导致重复上账，重复充退。\n\n2、问题分析\n由于没有及时的dump保护现场，加上应用down掉后，日志少的可怜，只有一些Broken pipe，以及该getOuptStream()异常，后期只能从代码层面分析。\n\n3、分析\njdbc sockeTimeout时间并没有设置，所以默认使用的mysql的或者操作系统本身的socketTimeout 该问题会引发类似问题\n\n相关文档:\nhttp://www.sohu.com/a/142039227_505885\nhttp://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c \nhttps://blog.csdn.net/lx348321409/article/details/76095751 \nhttps://segmentfault.com/a/1190000012944562\nhttps://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration\n\n=====================================================\njdbc timeout类别\n\n主要有如下几个类别\n\n![upload successful](\\images\\pasted-16.png)\ntransaction timeout\n设置的是一个事务的执行时间，里头可能包含多个statement\nstatement timeout(也相当于result set fetch timeout)\n设置的是一个statement的执行超时时间，即driver等待statement执行完成，接收到数据的超时时间(注意statement的timeout不是整个查询的timeout，只是statement执行完成并拉取fetchSize数据返回的超时，之后resultSet的next在必要的时候还会触发fetch数据，每次fetch的超时时间是单独算的，默认也是以statement设置的timeout为准)\njdbc socket timeout\n设置的是jdbc I/O socket read and write operations的超时时间，防止因网络问题或数据库问题，导致driver一直阻塞等待。(建议比statement timeout的时间长)\nos socket timeout\n这个是操作系统级别的socket设置(如果jdbc socket timeout没有设置，而os级别的socket timeout有设置，则使用系统的socket timeout值)。\n上面的不同级别的timeout越往下优先级越高，也就是说如果下面的配置比上面的配置值小的话，则会优先触发timeout，那么相当于上面的配置值就\"失效\"了。\njdbc socket timeout\n\n这个不同数据的jdbc driver实现不一样\nmysql\n\njdbc:mysql://localhost:3306/ag_admin?useUnicode=true&amp;characterEncoding=UTF8&connectTimeout=60000&socketTimeout=60000\n通过url参数传递即可\npg\n\njdbc:postgresql://localhost/test?user=fred&password=secret&&connectTimeout=60&socketTimeout=60\npg也是通过url传递，不过它的单位与mysql不同，mysql是毫秒，而pg是秒\noracle\n\noracle需要通过oracle.jdbc.ReadTimeout参数来设置，连接超时参数是oracle.net.CONNECT_TIMEOUT\n通过properties设置\n            Class.forName(\"oracle.jdbc.driver.OracleDriver\");\n            Properties props = new Properties() ;\n            props.put( \"user\" , \"test_schema\") ;\n            props.put( \"password\" , \"pwd\") ;\n            props.put( \"oracle.net.CONNECT_TIMEOUT\" , \"10000000\") ;\n            props.put( \"oracle.jdbc.ReadTimeout\" , \"2000\" ) ;\n            Connection conn = DriverManager.getConnection( \"jdbc:oracle:thin:@10.0.1.9:1521:orcl\" , props ) ;\n通过环境变量设置\nString readTimeout = \"10000\"; // ms\nSystem.setProperty(\"oracle.jdbc.ReadTimeout\", readTimeout);\nClass.forName(\"oracle.jdbc.OracleDriver\");\nConnection conn = DriverManager.getConnection(jdbcUrl, user, pwd);\n注意需要在connection连接之前设置环境变量\ntomcat jdbc pool\n一般我们不直接使用jdbc connection，而是使用连接池。由于tomcat jdbc pool是springboot默认使用的数据库连接池，这里就讲述一下如何在tomcat jdbc pool下设置。\nspring.datasource.tomcat.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000\n注意，这里是分号分隔，单位是毫秒，这里可以根据各自的情况配置前缀(tomcat jdbc连接池的话，默认是spring.datasource.tomcat)，可以自定义，比如\n@Bean@Qualifier(\"writeDataSource\")\n    @ConfigurationProperties(prefix = \"spring.datasource.write\")\n    public DataSource writeDataSource() {\n        returnDataSourceBuilder.create().build();\n    }\n假设你这里是自定义了prefix为spring.datasource.write，那么上述配置就变为\nspring.datasource.write.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000\noracle.jdbc.ReadTimeout如果没有设置的话，driver里头默认是0\noracle.jdbc.ReadTimeout\n\ndriver内部将该值设置到oracle.net.READ_TIMEOUT变量上\noracle.net.nt.TcpNTAdapter\n    @Override\n    publicvoid setReadTimeoutIfRequired(final Properties properties) throws IOException, NetException {\n        String s = ((Hashtable<K, String>)properties).get(\"oracle.net.READ_TIMEOUT\");\n        if (s == null) {\n            s = \"0\";\n        }\n        this.setOption(3, s);\n    }\n    \n    publicvoid setOption(int var1, Object var2) throws IOException, NetException {\n        String var3;\n        switch(var1) {\n        case0:\n            var3 = (String)var2;\n            this.socket.setTcpNoDelay(var3.equals(\"YES\"));\n            break;\n        case1:\n            var3 = (String)var2;\n            if(var3.equals(\"YES\")) {\n                this.socket.setKeepAlive(true);\n            }\n        case2:\n        default:\n            break;\n        case3:\n            this.sockTimeout = Integer.parseInt((String)var2);\n            this.socket.setSoTimeout(this.sockTimeout);\n        }\n\n    }\n可用看到最后设置的是socket的soTimeout\n实例\n\n    @Test\n    publicvoid testReadTimeout() throws SQLException {\n        Connection connection = dataSource.getConnection();\n        String sql = \"select * from demo_table\";\n        PreparedStatement pstmt;\n        try {\n            pstmt = (PreparedStatement)connection.prepareStatement(sql);\n            ResultSet rs = pstmt.executeQuery();\n            int col = rs.getMetaData().getColumnCount();\n            System.out.println(\"============================\");\n            while (rs.next()) {\n                for (int i = 1; i <= col; i++) {\n                    System.out.print(rs.getObject(i));\n                }\n                System.out.println(\"\");\n            }\n            System.out.println(\"============================\");\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } finally {\n            //close resources\n        }\n    }\n超时错误输出\n//部分数据输出......\njava.sql.SQLRecoverableException: IO 错误: Socket read timed out\n    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1128)\n    at oracle.jdbc.driver.OracleResultSetImpl.close_or_fetch_from_next(OracleResultSetImpl.java:373)\n    at oracle.jdbc.driver.OracleResultSetImpl.next(OracleResultSetImpl.java:277)\n    at com.example.demo.DemoApplicationTests.testReadTimeout(DemoApplicationTests.java:68)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:94)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)\n    at org.junit.runner.JUnitCore.run(JUnitCore.java:137)\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)\nCaused by: oracle.net.ns.NetException: Socket read timed out\n    at oracle.net.ns.Packet.receive(Packet.java:339)\n    at oracle.net.ns.DataPacket.receive(DataPacket.java:106)\n    at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:315)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:260)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:185)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:102)\n    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:124)\n    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:80)\n    at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1137)\n    at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:290)\n    at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:192)\n    at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)\n    at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:207)\n    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1119)\n    ... 35 more\n刚开始会有数据输出，但是到了某个resultSet的next的时候，报了超时(close_or_fetch_from_next)，这个超时指定的是当result.next方法触发新的一批数据的拉取(当一个fetchSize的数据消费完之后，接下来的next会触发新一批数据的fetch)之后在timeout时间返回内没有收到数据库返回的数据。\noracle的jdbc默认的fetchSize为10，也就是每个fetch，如果超过指定时间没接收到数据，则抛出timeout异常。\n小结\n\njdbc的socketTimeout值的设置要非常小心，不同数据库的jdbc driver设置不一样，特别是使用不同连接池的话，设置也可能不尽相同。对于严重依赖数据库操作的服务来说，非常有必要设置这个值，否则万一网络或数据库异常，会导致服务线程一直阻塞在java.net.SocketInputStream.socketRead0。\n如果查询数据多，则会导致该线程持有的data list不能释放，相当于内存泄露，最后导致OOM\n如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout\n=====================================================\n\n附：错误日志\norg.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe\n        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:393)\n        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:426)\n        at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:342)\n        at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:317)\n        at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:110)\n        at org.springframework.session.web.http.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:437)\n        at com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter.write(FastJsonHttpMessageConverter.java:216)\n        at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:183)\n        at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)\n        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:126)\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:832)\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:743)\n        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:961)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:120)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yiji.boot.web.common.ResponseHeaderFilter.doFilterInternal(ResponseHeaderFilter.java:62)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yiji.boot.actuator.acl.ActuatorACLFilter.doFilter(ActuatorACLFilter.java:36)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:121)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n        at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:676)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1095)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:672)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1502)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1458)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.IOException: Broken pipe\n        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)\n        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)\n        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)\n        at sun.nio.ch.IOUtil.write(IOUtil.java:65)\n        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)\n        at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:124)\n        at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)\n        at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:172)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.writeToSocket(InternalNioOutputBuffer.java:139)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.addToBB(InternalNioOutputBuffer.java:197)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.access$000(InternalNioOutputBuffer.java:41)\n        at org.apache.coyote.http11.InternalNioOutputBuffer$SocketOutputBuffer.doWrite(InternalNioOutputBuffer.java:320)\n        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:116)\n        at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:256)\n        at org.apache.coyote.Response.doWrite(Response.java:501)\n        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:388)\n        ... 63 common frames omitted\n\n\n\n2018-07-27 11:04:24.377 ERROR [http-nio-8313-exec-12] [dispatcherServlet]-- Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response] with root cause\njava.lang.IllegalStateException: getOutputStream() has already been called for this response\n        at org.apache.catalina.connector.Response.getWriter(Response.java:564)\n        at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:212)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at org.springframework.session.web.http.OnCommittedResponseWrapper.getWriter(OnCommittedResponseWrapper.java:133)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:195)\n        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1246)\n        at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1029)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:973)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:92)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)","source":"_posts/数据库-kill服务进程引发的血案.md","raw":"title: 数据库-kill服务进程引发的血案\nauthor: Xiang Chuang\ntags:\n  - db\ncategories:\n  - 爱学爱问\ndate: 2018-07-30 11:01:00\n---\n1、问题描述：\n18.07.27， 10：50分dba进行mysql数据库碎片整理，11：04分，发现数据库连接爆满，此时应用已处于down掉的状态，11：22数据库强行kill，11：40分之前发现应用并没有进行新的连接，此时停止应用发现停不下来，不得不kill掉应用进程，重启后恢复。但此时发现，之前入库的记录并没有成功，而mq由于没有收到应用的ack确认消息，消息重新进入队列并重发，加上数据没入库，交易进行了重复的操作！由于是全名抢车业务，导致重复上账，重复充退。\n\n2、问题分析\n由于没有及时的dump保护现场，加上应用down掉后，日志少的可怜，只有一些Broken pipe，以及该getOuptStream()异常，后期只能从代码层面分析。\n\n3、分析\njdbc sockeTimeout时间并没有设置，所以默认使用的mysql的或者操作系统本身的socketTimeout 该问题会引发类似问题\n\n相关文档:\nhttp://www.sohu.com/a/142039227_505885\nhttp://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c \nhttps://blog.csdn.net/lx348321409/article/details/76095751 \nhttps://segmentfault.com/a/1190000012944562\nhttps://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration\n\n=====================================================\njdbc timeout类别\n\n主要有如下几个类别\n\n![upload successful](\\images\\pasted-16.png)\ntransaction timeout\n设置的是一个事务的执行时间，里头可能包含多个statement\nstatement timeout(也相当于result set fetch timeout)\n设置的是一个statement的执行超时时间，即driver等待statement执行完成，接收到数据的超时时间(注意statement的timeout不是整个查询的timeout，只是statement执行完成并拉取fetchSize数据返回的超时，之后resultSet的next在必要的时候还会触发fetch数据，每次fetch的超时时间是单独算的，默认也是以statement设置的timeout为准)\njdbc socket timeout\n设置的是jdbc I/O socket read and write operations的超时时间，防止因网络问题或数据库问题，导致driver一直阻塞等待。(建议比statement timeout的时间长)\nos socket timeout\n这个是操作系统级别的socket设置(如果jdbc socket timeout没有设置，而os级别的socket timeout有设置，则使用系统的socket timeout值)。\n上面的不同级别的timeout越往下优先级越高，也就是说如果下面的配置比上面的配置值小的话，则会优先触发timeout，那么相当于上面的配置值就\"失效\"了。\njdbc socket timeout\n\n这个不同数据的jdbc driver实现不一样\nmysql\n\njdbc:mysql://localhost:3306/ag_admin?useUnicode=true&amp;characterEncoding=UTF8&connectTimeout=60000&socketTimeout=60000\n通过url参数传递即可\npg\n\njdbc:postgresql://localhost/test?user=fred&password=secret&&connectTimeout=60&socketTimeout=60\npg也是通过url传递，不过它的单位与mysql不同，mysql是毫秒，而pg是秒\noracle\n\noracle需要通过oracle.jdbc.ReadTimeout参数来设置，连接超时参数是oracle.net.CONNECT_TIMEOUT\n通过properties设置\n            Class.forName(\"oracle.jdbc.driver.OracleDriver\");\n            Properties props = new Properties() ;\n            props.put( \"user\" , \"test_schema\") ;\n            props.put( \"password\" , \"pwd\") ;\n            props.put( \"oracle.net.CONNECT_TIMEOUT\" , \"10000000\") ;\n            props.put( \"oracle.jdbc.ReadTimeout\" , \"2000\" ) ;\n            Connection conn = DriverManager.getConnection( \"jdbc:oracle:thin:@10.0.1.9:1521:orcl\" , props ) ;\n通过环境变量设置\nString readTimeout = \"10000\"; // ms\nSystem.setProperty(\"oracle.jdbc.ReadTimeout\", readTimeout);\nClass.forName(\"oracle.jdbc.OracleDriver\");\nConnection conn = DriverManager.getConnection(jdbcUrl, user, pwd);\n注意需要在connection连接之前设置环境变量\ntomcat jdbc pool\n一般我们不直接使用jdbc connection，而是使用连接池。由于tomcat jdbc pool是springboot默认使用的数据库连接池，这里就讲述一下如何在tomcat jdbc pool下设置。\nspring.datasource.tomcat.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000\n注意，这里是分号分隔，单位是毫秒，这里可以根据各自的情况配置前缀(tomcat jdbc连接池的话，默认是spring.datasource.tomcat)，可以自定义，比如\n@Bean@Qualifier(\"writeDataSource\")\n    @ConfigurationProperties(prefix = \"spring.datasource.write\")\n    public DataSource writeDataSource() {\n        returnDataSourceBuilder.create().build();\n    }\n假设你这里是自定义了prefix为spring.datasource.write，那么上述配置就变为\nspring.datasource.write.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000\noracle.jdbc.ReadTimeout如果没有设置的话，driver里头默认是0\noracle.jdbc.ReadTimeout\n\ndriver内部将该值设置到oracle.net.READ_TIMEOUT变量上\noracle.net.nt.TcpNTAdapter\n    @Override\n    publicvoid setReadTimeoutIfRequired(final Properties properties) throws IOException, NetException {\n        String s = ((Hashtable<K, String>)properties).get(\"oracle.net.READ_TIMEOUT\");\n        if (s == null) {\n            s = \"0\";\n        }\n        this.setOption(3, s);\n    }\n    \n    publicvoid setOption(int var1, Object var2) throws IOException, NetException {\n        String var3;\n        switch(var1) {\n        case0:\n            var3 = (String)var2;\n            this.socket.setTcpNoDelay(var3.equals(\"YES\"));\n            break;\n        case1:\n            var3 = (String)var2;\n            if(var3.equals(\"YES\")) {\n                this.socket.setKeepAlive(true);\n            }\n        case2:\n        default:\n            break;\n        case3:\n            this.sockTimeout = Integer.parseInt((String)var2);\n            this.socket.setSoTimeout(this.sockTimeout);\n        }\n\n    }\n可用看到最后设置的是socket的soTimeout\n实例\n\n    @Test\n    publicvoid testReadTimeout() throws SQLException {\n        Connection connection = dataSource.getConnection();\n        String sql = \"select * from demo_table\";\n        PreparedStatement pstmt;\n        try {\n            pstmt = (PreparedStatement)connection.prepareStatement(sql);\n            ResultSet rs = pstmt.executeQuery();\n            int col = rs.getMetaData().getColumnCount();\n            System.out.println(\"============================\");\n            while (rs.next()) {\n                for (int i = 1; i <= col; i++) {\n                    System.out.print(rs.getObject(i));\n                }\n                System.out.println(\"\");\n            }\n            System.out.println(\"============================\");\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } finally {\n            //close resources\n        }\n    }\n超时错误输出\n//部分数据输出......\njava.sql.SQLRecoverableException: IO 错误: Socket read timed out\n    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1128)\n    at oracle.jdbc.driver.OracleResultSetImpl.close_or_fetch_from_next(OracleResultSetImpl.java:373)\n    at oracle.jdbc.driver.OracleResultSetImpl.next(OracleResultSetImpl.java:277)\n    at com.example.demo.DemoApplicationTests.testReadTimeout(DemoApplicationTests.java:68)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:94)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)\n    at org.junit.runner.JUnitCore.run(JUnitCore.java:137)\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)\nCaused by: oracle.net.ns.NetException: Socket read timed out\n    at oracle.net.ns.Packet.receive(Packet.java:339)\n    at oracle.net.ns.DataPacket.receive(DataPacket.java:106)\n    at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:315)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:260)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:185)\n    at oracle.net.ns.NetInputStream.read(NetInputStream.java:102)\n    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:124)\n    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:80)\n    at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1137)\n    at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:290)\n    at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:192)\n    at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)\n    at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:207)\n    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1119)\n    ... 35 more\n刚开始会有数据输出，但是到了某个resultSet的next的时候，报了超时(close_or_fetch_from_next)，这个超时指定的是当result.next方法触发新的一批数据的拉取(当一个fetchSize的数据消费完之后，接下来的next会触发新一批数据的fetch)之后在timeout时间返回内没有收到数据库返回的数据。\noracle的jdbc默认的fetchSize为10，也就是每个fetch，如果超过指定时间没接收到数据，则抛出timeout异常。\n小结\n\njdbc的socketTimeout值的设置要非常小心，不同数据库的jdbc driver设置不一样，特别是使用不同连接池的话，设置也可能不尽相同。对于严重依赖数据库操作的服务来说，非常有必要设置这个值，否则万一网络或数据库异常，会导致服务线程一直阻塞在java.net.SocketInputStream.socketRead0。\n如果查询数据多，则会导致该线程持有的data list不能释放，相当于内存泄露，最后导致OOM\n如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout\n=====================================================\n\n附：错误日志\norg.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe\n        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:393)\n        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:426)\n        at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:342)\n        at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:317)\n        at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:110)\n        at org.springframework.session.web.http.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:437)\n        at com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter.write(FastJsonHttpMessageConverter.java:216)\n        at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:183)\n        at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)\n        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:126)\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:832)\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:743)\n        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:961)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:120)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yiji.boot.web.common.ResponseHeaderFilter.doFilterInternal(ResponseHeaderFilter.java:62)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yiji.boot.actuator.acl.ActuatorACLFilter.doFilter(ActuatorACLFilter.java:36)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:121)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n        at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:676)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1095)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:672)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1502)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1458)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.IOException: Broken pipe\n        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)\n        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)\n        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)\n        at sun.nio.ch.IOUtil.write(IOUtil.java:65)\n        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)\n        at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:124)\n        at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)\n        at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:172)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.writeToSocket(InternalNioOutputBuffer.java:139)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.addToBB(InternalNioOutputBuffer.java:197)\n        at org.apache.coyote.http11.InternalNioOutputBuffer.access$000(InternalNioOutputBuffer.java:41)\n        at org.apache.coyote.http11.InternalNioOutputBuffer$SocketOutputBuffer.doWrite(InternalNioOutputBuffer.java:320)\n        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:116)\n        at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:256)\n        at org.apache.coyote.Response.doWrite(Response.java:501)\n        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:388)\n        ... 63 common frames omitted\n\n\n\n2018-07-27 11:04:24.377 ERROR [http-nio-8313-exec-12] [dispatcherServlet]-- Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response] with root cause\njava.lang.IllegalStateException: getOutputStream() has already been called for this response\n        at org.apache.catalina.connector.Response.getWriter(Response.java:564)\n        at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:212)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at org.springframework.session.web.http.OnCommittedResponseWrapper.getWriter(OnCommittedResponseWrapper.java:133)\n        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)\n        at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:195)\n        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1246)\n        at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1029)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:973)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)\n        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:92)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)","slug":"数据库-kill服务进程引发的血案","published":1,"updated":"2019-04-10T07:03:47.166Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjuazhcla004tysuvzt4v467i","content":"<p>1、问题描述：<br>18.07.27， 10：50分dba进行mysql数据库碎片整理，11：04分，发现数据库连接爆满，此时应用已处于down掉的状态，11：22数据库强行kill，11：40分之前发现应用并没有进行新的连接，此时停止应用发现停不下来，不得不kill掉应用进程，重启后恢复。但此时发现，之前入库的记录并没有成功，而mq由于没有收到应用的ack确认消息，消息重新进入队列并重发，加上数据没入库，交易进行了重复的操作！由于是全名抢车业务，导致重复上账，重复充退。</p>\n<p>2、问题分析<br>由于没有及时的dump保护现场，加上应用down掉后，日志少的可怜，只有一些Broken pipe，以及该getOuptStream()异常，后期只能从代码层面分析。</p>\n<p>3、分析<br>jdbc sockeTimeout时间并没有设置，所以默认使用的mysql的或者操作系统本身的socketTimeout 该问题会引发类似问题</p>\n<p>相关文档:<br><a href=\"http://www.sohu.com/a/142039227_505885\" target=\"_blank\" rel=\"noopener\">http://www.sohu.com/a/142039227_505885</a><br><a href=\"http://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c\" target=\"_blank\" rel=\"noopener\">http://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c</a><br><a href=\"https://blog.csdn.net/lx348321409/article/details/76095751\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/lx348321409/article/details/76095751</a><br><a href=\"https://segmentfault.com/a/1190000012944562\" target=\"_blank\" rel=\"noopener\">https://segmentfault.com/a/1190000012944562</a><br><a href=\"https://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration\" target=\"_blank\" rel=\"noopener\">https://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration</a></p>\n<p>=====================================================<br>jdbc timeout类别</p>\n<p>主要有如下几个类别</p>\n<p><img src=\"\\images\\pasted-16.png\" alt=\"upload successful\"><br>transaction timeout<br>设置的是一个事务的执行时间，里头可能包含多个statement<br>statement timeout(也相当于result set fetch timeout)<br>设置的是一个statement的执行超时时间，即driver等待statement执行完成，接收到数据的超时时间(注意statement的timeout不是整个查询的timeout，只是statement执行完成并拉取fetchSize数据返回的超时，之后resultSet的next在必要的时候还会触发fetch数据，每次fetch的超时时间是单独算的，默认也是以statement设置的timeout为准)<br>jdbc socket timeout<br>设置的是jdbc I/O socket read and write operations的超时时间，防止因网络问题或数据库问题，导致driver一直阻塞等待。(建议比statement timeout的时间长)<br>os socket timeout<br>这个是操作系统级别的socket设置(如果jdbc socket timeout没有设置，而os级别的socket timeout有设置，则使用系统的socket timeout值)。<br>上面的不同级别的timeout越往下优先级越高，也就是说如果下面的配置比上面的配置值小的话，则会优先触发timeout，那么相当于上面的配置值就”失效”了。<br>jdbc socket timeout</p>\n<p>这个不同数据的jdbc driver实现不一样<br>mysql</p>\n<p>jdbc:mysql://localhost:3306/ag_admin?useUnicode=true&amp;characterEncoding=UTF8&amp;connectTimeout=60000&amp;socketTimeout=60000<br>通过url参数传递即可<br>pg</p>\n<p>jdbc:postgresql://localhost/test?user=fred&amp;password=secret&amp;&amp;connectTimeout=60&amp;socketTimeout=60<br>pg也是通过url传递，不过它的单位与mysql不同，mysql是毫秒，而pg是秒<br>oracle</p>\n<p>oracle需要通过oracle.jdbc.ReadTimeout参数来设置，连接超时参数是oracle.net.CONNECT_TIMEOUT<br>通过properties设置<br>            Class.forName(“oracle.jdbc.driver.OracleDriver”);<br>            Properties props = new Properties() ;<br>            props.put( “user” , “test_schema”) ;<br>            props.put( “password” , “pwd”) ;<br>            props.put( “oracle.net.CONNECT_TIMEOUT” , “10000000”) ;<br>            props.put( “oracle.jdbc.ReadTimeout” , “2000” ) ;<br>            Connection conn = DriverManager.getConnection( “jdbc:oracle:thin:@10.0.1.9:1521:orcl” , props ) ;<br>通过环境变量设置<br>String readTimeout = “10000”; // ms<br>System.setProperty(“oracle.jdbc.ReadTimeout”, readTimeout);<br>Class.forName(“oracle.jdbc.OracleDriver”);<br>Connection conn = DriverManager.getConnection(jdbcUrl, user, pwd);<br>注意需要在connection连接之前设置环境变量<br>tomcat jdbc pool<br>一般我们不直接使用jdbc connection，而是使用连接池。由于tomcat jdbc pool是springboot默认使用的数据库连接池，这里就讲述一下如何在tomcat jdbc pool下设置。<br>spring.datasource.tomcat.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000<br>注意，这里是分号分隔，单位是毫秒，这里可以根据各自的情况配置前缀(tomcat jdbc连接池的话，默认是spring.datasource.tomcat)，可以自定义，比如<br>@Bean@Qualifier(“writeDataSource”)<br>    @ConfigurationProperties(prefix = “spring.datasource.write”)<br>    public DataSource writeDataSource() {<br>        returnDataSourceBuilder.create().build();<br>    }<br>假设你这里是自定义了prefix为spring.datasource.write，那么上述配置就变为<br>spring.datasource.write.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000<br>oracle.jdbc.ReadTimeout如果没有设置的话，driver里头默认是0<br>oracle.jdbc.ReadTimeout</p>\n<p>driver内部将该值设置到oracle.net.READ_TIMEOUT变量上<br>oracle.net.nt.TcpNTAdapter<br>    @Override<br>    publicvoid setReadTimeoutIfRequired(final Properties properties) throws IOException, NetException {<br>        String s = ((Hashtable&lt;K, String&gt;)properties).get(“oracle.net.READ_TIMEOUT”);<br>        if (s == null) {<br>            s = “0”;<br>        }<br>        this.setOption(3, s);<br>    }</p>\n<pre><code>publicvoid setOption(int var1, Object var2) throws IOException, NetException {\n    String var3;\n    switch(var1) {\n    case0:\n        var3 = (String)var2;\n        this.socket.setTcpNoDelay(var3.equals(&quot;YES&quot;));\n        break;\n    case1:\n        var3 = (String)var2;\n        if(var3.equals(&quot;YES&quot;)) {\n            this.socket.setKeepAlive(true);\n        }\n    case2:\n    default:\n        break;\n    case3:\n        this.sockTimeout = Integer.parseInt((String)var2);\n        this.socket.setSoTimeout(this.sockTimeout);\n    }\n\n}\n</code></pre><p>可用看到最后设置的是socket的soTimeout<br>实例</p>\n<pre><code>@Test\npublicvoid testReadTimeout() throws SQLException {\n    Connection connection = dataSource.getConnection();\n    String sql = &quot;select * from demo_table&quot;;\n    PreparedStatement pstmt;\n    try {\n        pstmt = (PreparedStatement)connection.prepareStatement(sql);\n        ResultSet rs = pstmt.executeQuery();\n        int col = rs.getMetaData().getColumnCount();\n        System.out.println(&quot;============================&quot;);\n        while (rs.next()) {\n            for (int i = 1; i &lt;= col; i++) {\n                System.out.print(rs.getObject(i));\n            }\n            System.out.println(&quot;&quot;);\n        }\n        System.out.println(&quot;============================&quot;);\n    } catch (SQLException e) {\n        e.printStackTrace();\n    } finally {\n        //close resources\n    }\n}\n</code></pre><p>超时错误输出<br>//部分数据输出……<br>java.sql.SQLRecoverableException: IO 错误: Socket read timed out<br>    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1128)<br>    at oracle.jdbc.driver.OracleResultSetImpl.close_or_fetch_from_next(OracleResultSetImpl.java:373)<br>    at oracle.jdbc.driver.OracleResultSetImpl.next(OracleResultSetImpl.java:277)<br>    at com.example.demo.DemoApplicationTests.testReadTimeout(DemoApplicationTests.java:68)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:497)<br>    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)<br>    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)<br>    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)<br>    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)<br>    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)<br>    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)<br>    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)<br>    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:94)<br>    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)<br>    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)<br>    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)<br>    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)<br>    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)<br>    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)<br>    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)<br>    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)<br>    at org.junit.runner.JUnitCore.run(JUnitCore.java:137)<br>    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)<br>    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)<br>    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:497)<br>    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)<br>Caused by: oracle.net.ns.NetException: Socket read timed out<br>    at oracle.net.ns.Packet.receive(Packet.java:339)<br>    at oracle.net.ns.DataPacket.receive(DataPacket.java:106)<br>    at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:315)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:260)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:185)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:102)<br>    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:124)<br>    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:80)<br>    at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1137)<br>    at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:290)<br>    at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:192)<br>    at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)<br>    at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:207)<br>    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1119)<br>    … 35 more<br>刚开始会有数据输出，但是到了某个resultSet的next的时候，报了超时(close_or_fetch_from_next)，这个超时指定的是当result.next方法触发新的一批数据的拉取(当一个fetchSize的数据消费完之后，接下来的next会触发新一批数据的fetch)之后在timeout时间返回内没有收到数据库返回的数据。<br>oracle的jdbc默认的fetchSize为10，也就是每个fetch，如果超过指定时间没接收到数据，则抛出timeout异常。<br>小结</p>\n<p>jdbc的socketTimeout值的设置要非常小心，不同数据库的jdbc driver设置不一样，特别是使用不同连接池的话，设置也可能不尽相同。对于严重依赖数据库操作的服务来说，非常有必要设置这个值，否则万一网络或数据库异常，会导致服务线程一直阻塞在java.net.SocketInputStream.socketRead0。<br>如果查询数据多，则会导致该线程持有的data list不能释放，相当于内存泄露，最后导致OOM</p>\n<h1 id=\"如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504-Gateway-Timeout\"><a href=\"#如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504-Gateway-Timeout\" class=\"headerlink\" title=\"如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout\"></a>如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout</h1><p>附：错误日志<br>org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe<br>        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:393)<br>        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:426)<br>        at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:342)<br>        at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:317)<br>        at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:110)<br>        at org.springframework.session.web.http.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:437)<br>        at com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter.write(FastJsonHttpMessageConverter.java:216)<br>        at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:183)<br>        at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)<br>        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:126)<br>        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:832)<br>        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:743)<br>        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)<br>        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:961)<br>        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)<br>        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)<br>        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)<br>        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:120)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yiji.boot.web.common.ResponseHeaderFilter.doFilterInternal(ResponseHeaderFilter.java:62)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yiji.boot.actuator.acl.ActuatorACLFilter.doFilter(ActuatorACLFilter.java:36)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:121)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)<br>        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)<br>        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)<br>        at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:676)<br>        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)<br>        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)<br>        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)<br>        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)<br>        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1095)<br>        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:672)<br>        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1502)<br>        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1458)<br>        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)<br>        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)<br>        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br>        at java.lang.Thread.run(Thread.java:745)<br>Caused by: java.io.IOException: Broken pipe<br>        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)<br>        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)<br>        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)<br>        at sun.nio.ch.IOUtil.write(IOUtil.java:65)<br>        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)<br>        at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:124)<br>        at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)<br>        at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:172)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.writeToSocket(InternalNioOutputBuffer.java:139)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.addToBB(InternalNioOutputBuffer.java:197)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.access$000(InternalNioOutputBuffer.java:41)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer$SocketOutputBuffer.doWrite(InternalNioOutputBuffer.java:320)<br>        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:116)<br>        at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:256)<br>        at org.apache.coyote.Response.doWrite(Response.java:501)<br>        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:388)<br>        … 63 common frames omitted</p>\n<p>2018-07-27 11:04:24.377 ERROR [http-nio-8313-exec-12] [dispatcherServlet]– Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response] with root cause<br>java.lang.IllegalStateException: getOutputStream() has already been called for this response<br>        at org.apache.catalina.connector.Response.getWriter(Response.java:564)<br>        at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:212)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at org.springframework.session.web.http.OnCommittedResponseWrapper.getWriter(OnCommittedResponseWrapper.java:133)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:195)<br>        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1246)<br>        at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1029)<br>        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:973)<br>        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)<br>        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)<br>        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)<br>        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:92)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)</p>\n","site":{"data":{}},"excerpt":"","more":"<p>1、问题描述：<br>18.07.27， 10：50分dba进行mysql数据库碎片整理，11：04分，发现数据库连接爆满，此时应用已处于down掉的状态，11：22数据库强行kill，11：40分之前发现应用并没有进行新的连接，此时停止应用发现停不下来，不得不kill掉应用进程，重启后恢复。但此时发现，之前入库的记录并没有成功，而mq由于没有收到应用的ack确认消息，消息重新进入队列并重发，加上数据没入库，交易进行了重复的操作！由于是全名抢车业务，导致重复上账，重复充退。</p>\n<p>2、问题分析<br>由于没有及时的dump保护现场，加上应用down掉后，日志少的可怜，只有一些Broken pipe，以及该getOuptStream()异常，后期只能从代码层面分析。</p>\n<p>3、分析<br>jdbc sockeTimeout时间并没有设置，所以默认使用的mysql的或者操作系统本身的socketTimeout 该问题会引发类似问题</p>\n<p>相关文档:<br><a href=\"http://www.sohu.com/a/142039227_505885\" target=\"_blank\" rel=\"noopener\">http://www.sohu.com/a/142039227_505885</a><br><a href=\"http://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c\" target=\"_blank\" rel=\"noopener\">http://www.sohu.com/a/141155649_539864?qq-pf-to=pcqq.c2c</a><br><a href=\"https://blog.csdn.net/lx348321409/article/details/76095751\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/lx348321409/article/details/76095751</a><br><a href=\"https://segmentfault.com/a/1190000012944562\" target=\"_blank\" rel=\"noopener\">https://segmentfault.com/a/1190000012944562</a><br><a href=\"https://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration\" target=\"_blank\" rel=\"noopener\">https://www.cubrid.org/blog/understanding-jdbc-internals-and-timeout-configuration</a></p>\n<p>=====================================================<br>jdbc timeout类别</p>\n<p>主要有如下几个类别</p>\n<p><img src=\"\\images\\pasted-16.png\" alt=\"upload successful\"><br>transaction timeout<br>设置的是一个事务的执行时间，里头可能包含多个statement<br>statement timeout(也相当于result set fetch timeout)<br>设置的是一个statement的执行超时时间，即driver等待statement执行完成，接收到数据的超时时间(注意statement的timeout不是整个查询的timeout，只是statement执行完成并拉取fetchSize数据返回的超时，之后resultSet的next在必要的时候还会触发fetch数据，每次fetch的超时时间是单独算的，默认也是以statement设置的timeout为准)<br>jdbc socket timeout<br>设置的是jdbc I/O socket read and write operations的超时时间，防止因网络问题或数据库问题，导致driver一直阻塞等待。(建议比statement timeout的时间长)<br>os socket timeout<br>这个是操作系统级别的socket设置(如果jdbc socket timeout没有设置，而os级别的socket timeout有设置，则使用系统的socket timeout值)。<br>上面的不同级别的timeout越往下优先级越高，也就是说如果下面的配置比上面的配置值小的话，则会优先触发timeout，那么相当于上面的配置值就”失效”了。<br>jdbc socket timeout</p>\n<p>这个不同数据的jdbc driver实现不一样<br>mysql</p>\n<p>jdbc:mysql://localhost:3306/ag_admin?useUnicode=true&amp;characterEncoding=UTF8&amp;connectTimeout=60000&amp;socketTimeout=60000<br>通过url参数传递即可<br>pg</p>\n<p>jdbc:postgresql://localhost/test?user=fred&amp;password=secret&amp;&amp;connectTimeout=60&amp;socketTimeout=60<br>pg也是通过url传递，不过它的单位与mysql不同，mysql是毫秒，而pg是秒<br>oracle</p>\n<p>oracle需要通过oracle.jdbc.ReadTimeout参数来设置，连接超时参数是oracle.net.CONNECT_TIMEOUT<br>通过properties设置<br>            Class.forName(“oracle.jdbc.driver.OracleDriver”);<br>            Properties props = new Properties() ;<br>            props.put( “user” , “test_schema”) ;<br>            props.put( “password” , “pwd”) ;<br>            props.put( “oracle.net.CONNECT_TIMEOUT” , “10000000”) ;<br>            props.put( “oracle.jdbc.ReadTimeout” , “2000” ) ;<br>            Connection conn = DriverManager.getConnection( “jdbc:oracle:thin:@10.0.1.9:1521:orcl” , props ) ;<br>通过环境变量设置<br>String readTimeout = “10000”; // ms<br>System.setProperty(“oracle.jdbc.ReadTimeout”, readTimeout);<br>Class.forName(“oracle.jdbc.OracleDriver”);<br>Connection conn = DriverManager.getConnection(jdbcUrl, user, pwd);<br>注意需要在connection连接之前设置环境变量<br>tomcat jdbc pool<br>一般我们不直接使用jdbc connection，而是使用连接池。由于tomcat jdbc pool是springboot默认使用的数据库连接池，这里就讲述一下如何在tomcat jdbc pool下设置。<br>spring.datasource.tomcat.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000<br>注意，这里是分号分隔，单位是毫秒，这里可以根据各自的情况配置前缀(tomcat jdbc连接池的话，默认是spring.datasource.tomcat)，可以自定义，比如<br>@Bean@Qualifier(“writeDataSource”)<br>    @ConfigurationProperties(prefix = “spring.datasource.write”)<br>    public DataSource writeDataSource() {<br>        returnDataSourceBuilder.create().build();<br>    }<br>假设你这里是自定义了prefix为spring.datasource.write，那么上述配置就变为<br>spring.datasource.write.connectionProperties=oracle.net.CONNECT_TIMEOUT=10000;oracle.jdbc.ReadTimeout=60000<br>oracle.jdbc.ReadTimeout如果没有设置的话，driver里头默认是0<br>oracle.jdbc.ReadTimeout</p>\n<p>driver内部将该值设置到oracle.net.READ_TIMEOUT变量上<br>oracle.net.nt.TcpNTAdapter<br>    @Override<br>    publicvoid setReadTimeoutIfRequired(final Properties properties) throws IOException, NetException {<br>        String s = ((Hashtable&lt;K, String&gt;)properties).get(“oracle.net.READ_TIMEOUT”);<br>        if (s == null) {<br>            s = “0”;<br>        }<br>        this.setOption(3, s);<br>    }</p>\n<pre><code>publicvoid setOption(int var1, Object var2) throws IOException, NetException {\n    String var3;\n    switch(var1) {\n    case0:\n        var3 = (String)var2;\n        this.socket.setTcpNoDelay(var3.equals(&quot;YES&quot;));\n        break;\n    case1:\n        var3 = (String)var2;\n        if(var3.equals(&quot;YES&quot;)) {\n            this.socket.setKeepAlive(true);\n        }\n    case2:\n    default:\n        break;\n    case3:\n        this.sockTimeout = Integer.parseInt((String)var2);\n        this.socket.setSoTimeout(this.sockTimeout);\n    }\n\n}\n</code></pre><p>可用看到最后设置的是socket的soTimeout<br>实例</p>\n<pre><code>@Test\npublicvoid testReadTimeout() throws SQLException {\n    Connection connection = dataSource.getConnection();\n    String sql = &quot;select * from demo_table&quot;;\n    PreparedStatement pstmt;\n    try {\n        pstmt = (PreparedStatement)connection.prepareStatement(sql);\n        ResultSet rs = pstmt.executeQuery();\n        int col = rs.getMetaData().getColumnCount();\n        System.out.println(&quot;============================&quot;);\n        while (rs.next()) {\n            for (int i = 1; i &lt;= col; i++) {\n                System.out.print(rs.getObject(i));\n            }\n            System.out.println(&quot;&quot;);\n        }\n        System.out.println(&quot;============================&quot;);\n    } catch (SQLException e) {\n        e.printStackTrace();\n    } finally {\n        //close resources\n    }\n}\n</code></pre><p>超时错误输出<br>//部分数据输出……<br>java.sql.SQLRecoverableException: IO 错误: Socket read timed out<br>    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1128)<br>    at oracle.jdbc.driver.OracleResultSetImpl.close_or_fetch_from_next(OracleResultSetImpl.java:373)<br>    at oracle.jdbc.driver.OracleResultSetImpl.next(OracleResultSetImpl.java:277)<br>    at com.example.demo.DemoApplicationTests.testReadTimeout(DemoApplicationTests.java:68)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:497)<br>    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)<br>    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)<br>    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)<br>    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)<br>    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)<br>    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)<br>    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)<br>    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:252)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:94)<br>    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)<br>    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)<br>    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)<br>    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)<br>    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)<br>    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)<br>    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)<br>    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)<br>    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:191)<br>    at org.junit.runner.JUnitCore.run(JUnitCore.java:137)<br>    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)<br>    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)<br>    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:497)<br>    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)<br>Caused by: oracle.net.ns.NetException: Socket read timed out<br>    at oracle.net.ns.Packet.receive(Packet.java:339)<br>    at oracle.net.ns.DataPacket.receive(DataPacket.java:106)<br>    at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:315)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:260)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:185)<br>    at oracle.net.ns.NetInputStream.read(NetInputStream.java:102)<br>    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:124)<br>    at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:80)<br>    at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1137)<br>    at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:290)<br>    at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:192)<br>    at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)<br>    at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:207)<br>    at oracle.jdbc.driver.T4CPreparedStatement.fetch(T4CPreparedStatement.java:1119)<br>    … 35 more<br>刚开始会有数据输出，但是到了某个resultSet的next的时候，报了超时(close_or_fetch_from_next)，这个超时指定的是当result.next方法触发新的一批数据的拉取(当一个fetchSize的数据消费完之后，接下来的next会触发新一批数据的fetch)之后在timeout时间返回内没有收到数据库返回的数据。<br>oracle的jdbc默认的fetchSize为10，也就是每个fetch，如果超过指定时间没接收到数据，则抛出timeout异常。<br>小结</p>\n<p>jdbc的socketTimeout值的设置要非常小心，不同数据库的jdbc driver设置不一样，特别是使用不同连接池的话，设置也可能不尽相同。对于严重依赖数据库操作的服务来说，非常有必要设置这个值，否则万一网络或数据库异常，会导致服务线程一直阻塞在java.net.SocketInputStream.socketRead0。<br>如果查询数据多，则会导致该线程持有的data list不能释放，相当于内存泄露，最后导致OOM</p>\n<h1 id=\"如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504-Gateway-Timeout\"><a href=\"#如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504-Gateway-Timeout\" class=\"headerlink\" title=\"如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout\"></a>如果请求数据库操作很多且阻塞住了，会导致服务器可用的woker线程变少，严重则会导致服务不可用，nginx报504 Gateway Timeout</h1><p>附：错误日志<br>org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe<br>        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:393)<br>        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:426)<br>        at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:342)<br>        at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:317)<br>        at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:110)<br>        at org.springframework.session.web.http.OnCommittedResponseWrapper$SaveContextServletOutputStream.flush(OnCommittedResponseWrapper.java:437)<br>        at com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter.write(FastJsonHttpMessageConverter.java:216)<br>        at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:183)<br>        at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)<br>        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:126)<br>        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:832)<br>        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:743)<br>        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)<br>        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:961)<br>        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)<br>        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)<br>        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)<br>        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:120)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yiji.boot.web.common.ResponseHeaderFilter.doFilterInternal(ResponseHeaderFilter.java:62)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yiji.boot.actuator.acl.ActuatorACLFilter.doFilter(ActuatorACLFilter.java:36)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:121)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)<br>        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)<br>        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)<br>        at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:676)<br>        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)<br>        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)<br>        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)<br>        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)<br>        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1095)<br>        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:672)<br>        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1502)<br>        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1458)<br>        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)<br>        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)<br>        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)<br>        at java.lang.Thread.run(Thread.java:745)<br>Caused by: java.io.IOException: Broken pipe<br>        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)<br>        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)<br>        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)<br>        at sun.nio.ch.IOUtil.write(IOUtil.java:65)<br>        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)<br>        at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:124)<br>        at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)<br>        at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:172)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.writeToSocket(InternalNioOutputBuffer.java:139)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.addToBB(InternalNioOutputBuffer.java:197)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer.access$000(InternalNioOutputBuffer.java:41)<br>        at org.apache.coyote.http11.InternalNioOutputBuffer$SocketOutputBuffer.doWrite(InternalNioOutputBuffer.java:320)<br>        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:116)<br>        at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:256)<br>        at org.apache.coyote.Response.doWrite(Response.java:501)<br>        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:388)<br>        … 63 common frames omitted</p>\n<p>2018-07-27 11:04:24.377 ERROR [http-nio-8313-exec-12] [dispatcherServlet]– Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response] with root cause<br>java.lang.IllegalStateException: getOutputStream() has already been called for this response<br>        at org.apache.catalina.connector.Response.getWriter(Response.java:564)<br>        at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:212)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at org.springframework.session.web.http.OnCommittedResponseWrapper.getWriter(OnCommittedResponseWrapper.java:133)<br>        at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:152)<br>        at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:195)<br>        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1246)<br>        at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1029)<br>        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:973)<br>        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:895)<br>        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:967)<br>        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:858)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)<br>        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:843)<br>        at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at com.yjf.common.web.CrossScriptingFilter.doFilter(CrossScriptingFilter.java:92)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)<br>        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)<br>        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)<br>        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjuazhbn20009ysuvot334u5l","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbnw000gysuven1i1stb"},{"post_id":"cjuazhbkp0001ysuvuge6pv37","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbo8000kysuv6luj3oos"},{"post_id":"cjuazhbna000bysuvykwx6h4x","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhboe000mysuvgjh66afm"},{"post_id":"cjuazhbnr000eysuvr0xuu048","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbor000pysuva90py8bh"},{"post_id":"cjuazhbls0003ysuv743w6f6q","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbp6000sysuv4ha79ej6"},{"post_id":"cjuazhbnv000fysuvpbosc71l","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbpl000wysuvgjzxe345"},{"post_id":"cjuazhbo3000jysuvye5g00ng","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbps000zysuvsdsttkk2"},{"post_id":"cjuazhbmk0007ysuvfw2q13ao","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbq40012ysuvd4o1od90"},{"post_id":"cjuazhboc000lysuvjwu6mdza","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbqd0014ysuv5yrvozrf"},{"post_id":"cjuazhbok000oysuvcmuw1ojx","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbqj0017ysuv2dffr0zl"},{"post_id":"cjuazhboy000rysuvbwh68oy6","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbqp001aysuvuvxs93rz"},{"post_id":"cjuazhbpi000vysuvntvtp9vh","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbrc001eysuvkioere2z"},{"post_id":"cjuazhbpn000yysuvjvh9we88","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbrp001hysuvqwqjl7gy"},{"post_id":"cjuazhbpy0011ysuvxndbtmm7","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbrw001kysuvhrh5wy76"},{"post_id":"cjuazhbq90013ysuv1oirpalb","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbs3001mysuvc74j2101"},{"post_id":"cjuazhbqh0016ysuvb9q2kapg","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbsm001pysuvojvtz0c9"},{"post_id":"cjuazhbql0019ysuvglwfd6mo","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbst001sysuvmdgvwysw"},{"post_id":"cjuazhbr5001dysuvb8zdh9jm","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbtl001wysuv84xmqwhx"},{"post_id":"cjuazhbrf001gysuvib29m9em","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbtw001zysuvsygdbzip"},{"post_id":"cjuazhbru001jysuv3zr4zlp1","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbuq0022ysuvmr7it0za"},{"post_id":"cjuazhbry001lysuvss2f4a05","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbux0025ysuvrxwaz3oh"},{"post_id":"cjuazhbs8001oysuvr2e8zqt5","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbvd0029ysuvrj7qry81"},{"post_id":"cjuazhbsq001rysuvl6j022b6","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbvx002cysuvrlhr5ez9"},{"post_id":"cjuazhbtg001vysuv0vaobaws","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbw4002dysuvxsl9t56x"},{"post_id":"cjuazhbtt001yysuvjvbc7zdg","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbwc002fysuv0nanzwyu"},{"post_id":"cjuazhbuv0024ysuvtrq5mcyk","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbwu002gysuvze4kw9ai"},{"post_id":"cjuazhbv50028ysuv68bl1cx3","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhbx9002iysuvdvavjx58"},{"post_id":"cjuazhbu40021ysuvpo5js34q","category_id":"cjuazhbv20027ysuv54und1i9","_id":"cjuazhbxl002kysuv519nmjvf"},{"post_id":"cjuazhcla004tysuvzt4v467i","category_id":"cjuazhbm30005ysuv8t9smu3u","_id":"cjuazhcm0004xysuvf28t9o2m"},{"post_id":"cjuazhcl0004sysuvz7jl8ce6","category_id":"cjuazhclo004uysuvghmq6wqo","_id":"cjuazhcm5004zysuv0yqbn0jm"}],"PostTag":[{"post_id":"cjuazhbkp0001ysuvuge6pv37","tag_id":"cjuazhbmi0006ysuv1f1hutn7","_id":"cjuazhbov000qysuvzmjncst0"},{"post_id":"cjuazhbkp0001ysuvuge6pv37","tag_id":"cjuazhbnn000dysuvi7gg83k4","_id":"cjuazhbpa000tysuv48blpl91"},{"post_id":"cjuazhbkp0001ysuvuge6pv37","tag_id":"cjuazhbnz000iysuvajc43zqv","_id":"cjuazhbpm000xysuvfc37rfb3"},{"post_id":"cjuazhbls0003ysuv743w6f6q","tag_id":"cjuazhbmi0006ysuv1f1hutn7","_id":"cjuazhbqk0018ysuvb92rbqcj"},{"post_id":"cjuazhbls0003ysuv743w6f6q","tag_id":"cjuazhbnn000dysuvi7gg83k4","_id":"cjuazhbqs001bysuve6yssopd"},{"post_id":"cjuazhbls0003ysuv743w6f6q","tag_id":"cjuazhbnz000iysuvajc43zqv","_id":"cjuazhbrd001fysuvz19ednkn"},{"post_id":"cjuazhbmk0007ysuvfw2q13ao","tag_id":"cjuazhbmi0006ysuv1f1hutn7","_id":"cjuazhbso001qysuv1xc0xo9y"},{"post_id":"cjuazhbmk0007ysuvfw2q13ao","tag_id":"cjuazhbnn000dysuvi7gg83k4","_id":"cjuazhbsu001tysuv89zckr6c"},{"post_id":"cjuazhbmk0007ysuvfw2q13ao","tag_id":"cjuazhbnz000iysuvajc43zqv","_id":"cjuazhbtp001xysuvaci2rn5j"},{"post_id":"cjuazhbn20009ysuvot334u5l","tag_id":"cjuazhbnn000dysuvi7gg83k4","_id":"cjuazhbut0023ysuv3w0eom3a"},{"post_id":"cjuazhbn20009ysuvot334u5l","tag_id":"cjuazhbsz001uysuvv8re96r9","_id":"cjuazhbuy0026ysuv2fs4mhf6"},{"post_id":"cjuazhbna000bysuvykwx6h4x","tag_id":"cjuazhbtz0020ysuvu69m1ciz","_id":"cjuazhbxj002jysuveivjlzj3"},{"post_id":"cjuazhbna000bysuvykwx6h4x","tag_id":"cjuazhbvi002aysuv6fjah5bs","_id":"cjuazhbxm002lysuvm4crsigg"},{"post_id":"cjuazhbna000bysuvykwx6h4x","tag_id":"cjuazhbw7002eysuv11cb9eee","_id":"cjuazhbxs002nysuvsrlv3iqq"},{"post_id":"cjuazhbnr000eysuvr0xuu048","tag_id":"cjuazhbx3002hysuvr9t9x6n9","_id":"cjuazhbya002qysuvp8a77qbv"},{"post_id":"cjuazhbnr000eysuvr0xuu048","tag_id":"cjuazhbxp002mysuvbk5tidws","_id":"cjuazhbyh002rysuvbaaf6u6w"},{"post_id":"cjuazhbnr000eysuvr0xuu048","tag_id":"cjuazhbxy002oysuv2fy4oynu","_id":"cjuazhbym002tysuv1e0vgmnl"},{"post_id":"cjuazhbnv000fysuvpbosc71l","tag_id":"cjuazhbx3002hysuvr9t9x6n9","_id":"cjuazhbz4002vysuvlw4irqd3"},{"post_id":"cjuazhbnv000fysuvpbosc71l","tag_id":"cjuazhbyi002sysuvycrnklxf","_id":"cjuazhbz6002wysuv7flrhf0b"},{"post_id":"cjuazhbo3000jysuvye5g00ng","tag_id":"cjuazhbx3002hysuvr9t9x6n9","_id":"cjuazhbzb002zysuveckpfsbb"},{"post_id":"cjuazhbo3000jysuvye5g00ng","tag_id":"cjuazhbxp002mysuvbk5tidws","_id":"cjuazhbzi0030ysuv0g3ns7yl"},{"post_id":"cjuazhboc000lysuvjwu6mdza","tag_id":"cjuazhbza002yysuvqxufx2q3","_id":"cjuazhc000033ysuv4e0jiehf"},{"post_id":"cjuazhboc000lysuvjwu6mdza","tag_id":"cjuazhbzm0031ysuvwzmefbr8","_id":"cjuazhc010034ysuvp0g3df22"},{"post_id":"cjuazhbok000oysuvcmuw1ojx","tag_id":"cjuazhbzz0032ysuv8gzzl8w1","_id":"cjuazhc0d0037ysuvfawmmnii"},{"post_id":"cjuazhbok000oysuvcmuw1ojx","tag_id":"cjuazhc020035ysuve9856lyu","_id":"cjuazhc0e0038ysuvsj6jv1ac"},{"post_id":"cjuazhboy000rysuvbwh68oy6","tag_id":"cjuazhc090036ysuvvt3fqopd","_id":"cjuazhc18003cysuv9yrsf69v"},{"post_id":"cjuazhboy000rysuvbwh68oy6","tag_id":"cjuazhc0q0039ysuv8v500a6s","_id":"cjuazhc18003dysuvljpt33np"},{"post_id":"cjuazhboy000rysuvbwh68oy6","tag_id":"cjuazhbzz0032ysuv8gzzl8w1","_id":"cjuazhc1a003fysuvqxrx18j9"},{"post_id":"cjuazhbpi000vysuvntvtp9vh","tag_id":"cjuazhc13003bysuvtttt807i","_id":"cjuazhc1f003hysuvlxe7xeq9"},{"post_id":"cjuazhbpi000vysuvntvtp9vh","tag_id":"cjuazhc19003eysuvctaxpjbb","_id":"cjuazhc1h003iysuvohpxsz6v"},{"post_id":"cjuazhbpn000yysuvjvh9we88","tag_id":"cjuazhc1c003gysuv1d26i0w8","_id":"cjuazhc1k003kysuvv8to2whs"},{"post_id":"cjuazhbpy0011ysuvxndbtmm7","tag_id":"cjuazhc1c003gysuv1d26i0w8","_id":"cjuazhc1p003mysuv8oywcdsi"},{"post_id":"cjuazhbq90013ysuv1oirpalb","tag_id":"cjuazhc1c003gysuv1d26i0w8","_id":"cjuazhc1r003oysuvrrsxkdnp"},{"post_id":"cjuazhbqh0016ysuvb9q2kapg","tag_id":"cjuazhc1c003gysuv1d26i0w8","_id":"cjuazhc20003rysuv2ccuaom6"},{"post_id":"cjuazhbqh0016ysuvb9q2kapg","tag_id":"cjuazhc1w003pysuv86xshrbw","_id":"cjuazhc23003sysuv93e97qg1"},{"post_id":"cjuazhbql0019ysuvglwfd6mo","tag_id":"cjuazhc1y003qysuvsxedupqb","_id":"cjuazhc2c003vysuv5xrcfu0k"},{"post_id":"cjuazhbql0019ysuvglwfd6mo","tag_id":"cjuazhbvi002aysuv6fjah5bs","_id":"cjuazhc2e003wysuvd4k83rjq"},{"post_id":"cjuazhbr5001dysuvb8zdh9jm","tag_id":"cjuazhc2b003uysuvttzkd2le","_id":"cjuazhc2p003zysuv6ec3fcm8"},{"post_id":"cjuazhbr5001dysuvb8zdh9jm","tag_id":"cjuazhbvi002aysuv6fjah5bs","_id":"cjuazhc2q0040ysuvpgu7z8ez"},{"post_id":"cjuazhbrf001gysuvib29m9em","tag_id":"cjuazhc2o003yysuvvejgflwy","_id":"cjuazhc2t0043ysuv6ff3wez5"},{"post_id":"cjuazhbrf001gysuvib29m9em","tag_id":"cjuazhc2r0041ysuvq4uo4w4p","_id":"cjuazhc2u0044ysuv9ydh5yta"},{"post_id":"cjuazhbru001jysuv3zr4zlp1","tag_id":"cjuazhc2s0042ysuvl7bccdu1","_id":"cjuazhc310046ysuvefseqaia"},{"post_id":"cjuazhbry001lysuvss2f4a05","tag_id":"cjuazhc2x0045ysuv6tdumx0p","_id":"cjuazhc3j004aysuviqrk0005"},{"post_id":"cjuazhbry001lysuvss2f4a05","tag_id":"cjuazhc330047ysuvlp5n6gwb","_id":"cjuazhc3k004bysuv4rkl4a1j"},{"post_id":"cjuazhbry001lysuvss2f4a05","tag_id":"cjuazhc350048ysuvo0cueypv","_id":"cjuazhc3s004dysuv9sjradyj"},{"post_id":"cjuazhbs8001oysuvr2e8zqt5","tag_id":"cjuazhbyi002sysuvycrnklxf","_id":"cjuazhc3u004eysuve45oejhp"},{"post_id":"cjuazhbsq001rysuvl6j022b6","tag_id":"cjuazhc3l004cysuvmda2vkpz","_id":"cjuazhc4d004iysuvp9uxz9jw"},{"post_id":"cjuazhbsq001rysuvl6j022b6","tag_id":"cjuazhbzz0032ysuv8gzzl8w1","_id":"cjuazhc4g004jysuvkpl0f0t5"},{"post_id":"cjuazhbsq001rysuvl6j022b6","tag_id":"cjuazhc49004gysuvvovoe4y7","_id":"cjuazhc4j004lysuv1a9361sh"},{"post_id":"cjuazhbtg001vysuv0vaobaws","tag_id":"cjuazhc4a004hysuvfow4z75z","_id":"cjuazhc4k004mysuvqu386ppu"},{"post_id":"cjuazhbtt001yysuvjvbc7zdg","tag_id":"cjuazhbvi002aysuv6fjah5bs","_id":"cjuazhc4s004oysuv3m4qgtpe"},{"post_id":"cjuazhbuv0024ysuvtrq5mcyk","tag_id":"cjuazhc4p004nysuvo77oj681","_id":"cjuazhc4u004qysuvoo2bsuk4"},{"post_id":"cjuazhbv50028ysuv68bl1cx3","tag_id":"cjuazhc4s004pysuvi1xph1o3","_id":"cjuazhc4v004rysuvovig8cs2"},{"post_id":"cjuazhcla004tysuvzt4v467i","tag_id":"cjuazhbvi002aysuv6fjah5bs","_id":"cjuazhclu004wysuvko6f5gl5"},{"post_id":"cjuazhcl0004sysuvz7jl8ce6","tag_id":"cjuazhclq004vysuvopsncdlu","_id":"cjuazhcma0050ysuvc7jyjerl"},{"post_id":"cjuazhcl0004sysuvz7jl8ce6","tag_id":"cjuazhcm1004yysuvs8evmjqz","_id":"cjuazhcmc0051ysuvre6p5chz"}],"Tag":[{"name":"GC-G1","_id":"cjuazhbmi0006ysuv1f1hutn7"},{"name":"JVM","_id":"cjuazhbnn000dysuvi7gg83k4"},{"name":"GC","_id":"cjuazhbnz000iysuvajc43zqv"},{"name":"类加载","_id":"cjuazhbsz001uysuvv8re96r9"},{"name":"数据库连接池","_id":"cjuazhbtz0020ysuvu69m1ciz"},{"name":"db","_id":"cjuazhbvi002aysuv6fjah5bs"},{"name":"druid","_id":"cjuazhbw7002eysuv11cb9eee"},{"name":"dubbo","_id":"cjuazhbx3002hysuvr9t9x6n9"},{"name":"序列化","_id":"cjuazhbxp002mysuvbk5tidws"},{"name":"hessian","_id":"cjuazhbxy002oysuv2fy4oynu"},{"name":"zookeeper","_id":"cjuazhbyi002sysuvycrnklxf"},{"name":"elk","_id":"cjuazhbza002yysuvqxufx2q3"},{"name":"集群","_id":"cjuazhbzm0031ysuvwzmefbr8"},{"name":"java","_id":"cjuazhbzz0032ysuv8gzzl8w1"},{"name":"java对象","_id":"cjuazhc020035ysuve9856lyu"},{"name":"jdk8","_id":"cjuazhc090036ysuvvt3fqopd"},{"name":"dump","_id":"cjuazhc0q0039ysuv8v500a6s"},{"name":"linux","_id":"cjuazhc13003bysuvtttt807i"},{"name":"tail","_id":"cjuazhc19003eysuvctaxpjbb"},{"name":"maven","_id":"cjuazhc1c003gysuv1d26i0w8"},{"name":"jdk","_id":"cjuazhc1w003pysuv86xshrbw"},{"name":"mysql","_id":"cjuazhc1y003qysuvsxedupqb"},{"name":"mongo","_id":"cjuazhc2b003uysuvttzkd2le"},{"name":"rabbitmq","_id":"cjuazhc2o003yysuvvejgflwy"},{"name":"消息队列","_id":"cjuazhc2r0041ysuvq4uo4w4p"},{"name":"struts2","_id":"cjuazhc2s0042ysuvl7bccdu1"},{"name":"spring","_id":"cjuazhc2x0045ysuv6tdumx0p"},{"name":"springboot","_id":"cjuazhc330047ysuvlp5n6gwb"},{"name":"应用监控检查","_id":"cjuazhc350048ysuvo0cueypv"},{"name":"内存泄漏","_id":"cjuazhc3l004cysuvmda2vkpz"},{"name":"mat","_id":"cjuazhc49004gysuvvovoe4y7"},{"name":"优雅停机","_id":"cjuazhc4a004hysuvfow4z75z"},{"name":"浏览器","_id":"cjuazhc4p004nysuvo77oj681"},{"name":"架构","_id":"cjuazhc4s004pysuvi1xph1o3"},{"name":"javaagent","_id":"cjuazhclq004vysuvopsncdlu"},{"name":"bytebuddy","_id":"cjuazhcm1004yysuvs8evmjqz"}]}}